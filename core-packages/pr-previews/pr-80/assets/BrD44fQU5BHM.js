import{aA as x,r as o,al as q,aB as E,aC as R,aD as C,aE as k,aF as A}from"./CanQ8QegSz5g.js";var F=x(),I=k(t=>t),g=t=>t?.constructor.name==="Array",O=(t,e)=>{if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!l(t[r],e[r]))return!1;return!0},l=(t,e)=>{if(Object.is(t,e))return!0;if(t==null&&e!=null||t!=null&&e==null)return!1;if(typeof t?.isEqual=="function"&&typeof e?.isEqual=="function")return t.isEqual(e);if(typeof t=="function"&&typeof e=="function")return t.toString()===e.toString();if(g(t)&&g(e))return O(Array.from(t),Array.from(e));if(typeof t!="object"||typeof e!="object")return!1;const r=Object.keys(e??Object.create(null)),s=r.length;for(let n=0;n<s;n++)if(!Reflect.has(t,r[n]))return!1;for(let n=0;n<s;n++){const c=r[n];if(!l(t[c],e[c]))return!1}return!0},M=Function.prototype.toString;M.call(Object);function v(t){if(!j(t)||t===void 0)return t;const e=Reflect.ownKeys(t).filter(s=>typeof s=="string"),r={};for(const s of e){const n=t[s];n!==void 0&&(r[s]=v(n))}return r}var j=t=>t&&typeof t=="object"&&t.constructor===Object;function w(t,e){const r=o.useRef(!1),s=o.useRef(!1);o.useEffect(()=>{if(r.current&&s.current)return t();s.current=!0},e),o.useEffect(()=>(r.current=!0,()=>{r.current=!1}),[])}var _=A("__zag__targetCache",()=>new WeakMap);function S(t,e){const{actions:r,context:s,sync:n}=e??{},c=o.useRef(void 0),u=o.useRef(void 0),p=o.useSyncExternalStore(o.useCallback(a=>q(t.state,a,n),[n]),()=>{const a=E(t.state);try{if(c.current&&u.current&&!R(c.current,a,u.current,new WeakMap))return c.current}catch{}return a},()=>E(t.state));t.setOptions({actions:r});const i=o.useMemo(()=>v(s??{}),[s]);w(()=>{const a=Object.entries(i),d=t.contextSnapshot??{};a.map(([f,h])=>({key:f,curr:h,prev:d[f],equal:l(d[f],h)})).every(({equal:f})=>f)||t.setContext(i)},[i]);const y=new WeakMap;o.useEffect(()=>{c.current=p,u.current=y});const m=o.useMemo(()=>new WeakMap,[]);return C(p,y,m,_)}function B(t){return[S(t),t.send]}function W(t){const e=o.useRef(void 0);return e.current||(e.current={v:t()}),e.current.v}var z=typeof document<"u"?o.useLayoutEffect:o.useEffect;function D(t,e){const{state:r,context:s}=e??{},n=W(()=>{const u=typeof t=="function"?t():t;return s&&u.setContext(s),u._created(),u}),c=o.useRef(void 0);return z(()=>{const u=r??c.current;return n.start(u),()=>{n.stop()}},[]),n}function N(t,e){const r=D(t,e);return[S(r,e),r.send,r]}export{B as a,I as n,F as r,N as u};
