var Ie=u=>{throw TypeError(u)};var be=(u,e,g)=>e.has(u)||Ie("Cannot "+g);var E=(u,e,g)=>(be(u,e,"read from private field"),g?g.call(u):e.get(u)),B=(u,e,g)=>e.has(u)?Ie("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(u):e.set(u,g),J=(u,e,g,w)=>(be(u,e,"write to private field"),w?w.call(u,g):e.set(u,g),g),ee=(u,e,g)=>(be(u,e,"access private method"),g);import{A as Ke,a5 as Be,a6 as ze,a7 as De,a8 as qe,a9 as Ve,aa as Je,c as Ye,a as $e,j as F,H as Ue,V as Ee,b as Ge}from"./dwMeHYNn9Hg1.js";import{r as We,A as Xe,u as Qe,a as Ze,F as et}from"./D9OJs1zdce74.js";import{N as tt,a as rt}from"./BC3foXCjV_k3.js";import{_ as Te}from"./CmsKOCeNyeyo.js";import{u as nt}from"./DiL4ZuJLV21m.js";import{B as Oe}from"./Ch-V-7isKLK0.js";import{C as ot,T as ie}from"./CdSMUyi_kqQk.js";import{B as Re}from"./C6hr4OMbnXxZ.js";import{L as it,a as ye}from"./CBMtReCMntmv.js";import"./DfN-iOyUlFSd.js";import"./OtvMwlfTdn0M.js";import"./Bf0SoCkPJ6sg.js";import"./Bix96aM-Vff_.js";import"./CqrxYxSjEfsI.js";const{withContext:at,PropsProvider:Xt}=Ke({key:"code"}),ae=at("code");class st{authService;constructor(e){this.authService=e.references.authService}beforeRequest({target:e,options:g}){const w=this.authService.getAuthState(),C=((w.kind=="authenticated"?w.sessionInfo:void 0)?.attributes?.keycloak).token;e.protocol==="https:"&&e.hostname==="ogc-api.nrw.de"&&C&&g.headers.set("Authorization",C)}}var he,we,Pe;class ct{constructor(e){B(this,we);B(this,he);J(this,he,e.references.interceptors.map((g,w)=>[e.referencesMeta.interceptors[w].serviceId,g]))}async fetch(e,g){const w=g?.signal??void 0,T=Object.assign({},g?.context),y=ut(g);Se(w);let C=lt(e);{const p={target:C,signal:w??new AbortController().signal,context:T,options:y};Se(w),await ee(this,we,Pe).call(this,p),C=p.target}const N=new Request(C,{...y,signal:w});return await window.fetch(N)}}he=new WeakMap,we=new WeakSet,Pe=async function(e){const{signal:g}=e;for(const[w,T]of E(this,he))if(Se(g),T.beforeRequest)try{await T.beforeRequest(e)}catch(y){throw Be(y),new Error(`Interceptor '${w}' failed with an error`,{cause:y})}};function lt(u){return typeof u=="string"?new URL(u,window.location.href):u}function ut(u){const e=u?.method??"GET",g=new Headers(u?.headers??{}),w={...u,method:e,headers:g};for(const T in w)ft[T]&&delete w[T];return w}const ft={context:1,signal:1};function Se(u){u?.aborted&&ze()}var Me={exports:{}};const dt={},ht=Object.freeze(Object.defineProperty({__proto__:null,default:dt},Symbol.toStringTag,{value:"Module"})),Ce=De(ht);/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.11.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2024
 * @license MIT
 */(function(u){(function(){var e="input is invalid type",g=typeof window=="object",w=g?window:{};w.JS_SHA256_NO_WINDOW&&(g=!1);var T=!g&&typeof self=="object",y=!w.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;y?w=qe:T&&(w=self);var C=!w.JS_SHA256_NO_COMMON_JS&&!0&&u.exports,N=!w.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",p="0123456789abcdef".split(""),G=[-2147483648,8388608,32768,128],H=[24,16,8,0],ne=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],oe=["hex","array","digest","arrayBuffer"],L=[];(w.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"}),N&&(w.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(n){return typeof n=="object"&&n.buffer&&n.buffer.constructor===ArrayBuffer});var ge=function(n,d){return function(b){return new j(d,!0).update(b)[n]()}},ke=function(n){var d=ge("hex",n);y&&(d=q(d,n)),d.create=function(){return new j(n)},d.update=function(v){return d.create().update(v)};for(var b=0;b<oe.length;++b){var h=oe[b];d[h]=ge(h,n)}return d},q=function(n,d){var b=Ce,h=Ce.Buffer,v=d?"sha224":"sha256",f;h.from&&!w.JS_SHA256_NO_BUFFER_FROM?f=h.from:f=function(s){return new h(s)};var A=function(s){if(typeof s=="string")return b.createHash(v).update(s,"utf8").digest("hex");if(s==null)throw new Error(e);return s.constructor===ArrayBuffer&&(s=new Uint8Array(s)),Array.isArray(s)||ArrayBuffer.isView(s)||s.constructor===h?b.createHash(v).update(f(s)).digest("hex"):n(s)};return A},xe=function(n,d){return function(b,h){return new Z(b,d,!0).update(h)[n]()}},Y=function(n){var d=xe("hex",n);d.create=function(v){return new Z(v,n)},d.update=function(v,f){return d.create(v).update(f)};for(var b=0;b<oe.length;++b){var h=oe[b];d[h]=xe(h,n)}return d};function j(n,d){d?(L[0]=L[16]=L[1]=L[2]=L[3]=L[4]=L[5]=L[6]=L[7]=L[8]=L[9]=L[10]=L[11]=L[12]=L[13]=L[14]=L[15]=0,this.blocks=L):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=n}j.prototype.update=function(n){if(!this.finalized){var d,b=typeof n;if(b!=="string"){if(b==="object"){if(n===null)throw new Error(e);if(N&&n.constructor===ArrayBuffer)n=new Uint8Array(n);else if(!Array.isArray(n)&&(!N||!ArrayBuffer.isView(n)))throw new Error(e)}else throw new Error(e);d=!0}for(var h,v=0,f,A=n.length,s=this.blocks;v<A;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,this.block=s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),d)for(f=this.start;v<A&&f<64;++v)s[f>>>2]|=n[v]<<H[f++&3];else for(f=this.start;v<A&&f<64;++v)h=n.charCodeAt(v),h<128?s[f>>>2]|=h<<H[f++&3]:h<2048?(s[f>>>2]|=(192|h>>>6)<<H[f++&3],s[f>>>2]|=(128|h&63)<<H[f++&3]):h<55296||h>=57344?(s[f>>>2]|=(224|h>>>12)<<H[f++&3],s[f>>>2]|=(128|h>>>6&63)<<H[f++&3],s[f>>>2]|=(128|h&63)<<H[f++&3]):(h=65536+((h&1023)<<10|n.charCodeAt(++v)&1023),s[f>>>2]|=(240|h>>>18)<<H[f++&3],s[f>>>2]|=(128|h>>>12&63)<<H[f++&3],s[f>>>2]|=(128|h>>>6&63)<<H[f++&3],s[f>>>2]|=(128|h&63)<<H[f++&3]);this.lastByteIndex=f,this.bytes+=f-this.start,f>=64?(this.block=s[16],this.start=f-64,this.hash(),this.hashed=!0):this.start=f}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},j.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var n=this.blocks,d=this.lastByteIndex;n[16]=this.block,n[d>>>2]|=G[d&3],this.block=n[16],d>=56&&(this.hashed||this.hash(),n[0]=this.block,n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0),n[14]=this.hBytes<<3|this.bytes>>>29,n[15]=this.bytes<<3,this.hash()}},j.prototype.hash=function(){var n=this.h0,d=this.h1,b=this.h2,h=this.h3,v=this.h4,f=this.h5,A=this.h6,s=this.h7,_=this.blocks,R,O,P,z,I,V,t,r,i,l,o;for(R=16;R<64;++R)I=_[R-15],O=(I>>>7|I<<25)^(I>>>18|I<<14)^I>>>3,I=_[R-2],P=(I>>>17|I<<15)^(I>>>19|I<<13)^I>>>10,_[R]=_[R-16]+O+_[R-7]+P<<0;for(o=d&b,R=0;R<64;R+=4)this.first?(this.is224?(r=300032,I=_[0]-1413257819,s=I-150054599<<0,h=I+24177077<<0):(r=704751109,I=_[0]-210244248,s=I-1521486534<<0,h=I+143694565<<0),this.first=!1):(O=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10),P=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7),r=n&d,z=r^n&b^o,t=v&f^~v&A,I=s+P+t+ne[R]+_[R],V=O+z,s=h+I<<0,h=I+V<<0),O=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),P=(s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7),i=h&n,z=i^h&d^r,t=s&v^~s&f,I=A+P+t+ne[R+1]+_[R+1],V=O+z,A=b+I<<0,b=I+V<<0,O=(b>>>2|b<<30)^(b>>>13|b<<19)^(b>>>22|b<<10),P=(A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7),l=b&h,z=l^b&n^i,t=A&s^~A&v,I=f+P+t+ne[R+2]+_[R+2],V=O+z,f=d+I<<0,d=I+V<<0,O=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),P=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7),o=d&b,z=o^d&h^l,t=f&A^~f&s,I=v+P+t+ne[R+3]+_[R+3],V=O+z,v=n+I<<0,n=I+V<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+n<<0,this.h1=this.h1+d<<0,this.h2=this.h2+b<<0,this.h3=this.h3+h<<0,this.h4=this.h4+v<<0,this.h5=this.h5+f<<0,this.h6=this.h6+A<<0,this.h7=this.h7+s<<0},j.prototype.hex=function(){this.finalize();var n=this.h0,d=this.h1,b=this.h2,h=this.h3,v=this.h4,f=this.h5,A=this.h6,s=this.h7,_=p[n>>>28&15]+p[n>>>24&15]+p[n>>>20&15]+p[n>>>16&15]+p[n>>>12&15]+p[n>>>8&15]+p[n>>>4&15]+p[n&15]+p[d>>>28&15]+p[d>>>24&15]+p[d>>>20&15]+p[d>>>16&15]+p[d>>>12&15]+p[d>>>8&15]+p[d>>>4&15]+p[d&15]+p[b>>>28&15]+p[b>>>24&15]+p[b>>>20&15]+p[b>>>16&15]+p[b>>>12&15]+p[b>>>8&15]+p[b>>>4&15]+p[b&15]+p[h>>>28&15]+p[h>>>24&15]+p[h>>>20&15]+p[h>>>16&15]+p[h>>>12&15]+p[h>>>8&15]+p[h>>>4&15]+p[h&15]+p[v>>>28&15]+p[v>>>24&15]+p[v>>>20&15]+p[v>>>16&15]+p[v>>>12&15]+p[v>>>8&15]+p[v>>>4&15]+p[v&15]+p[f>>>28&15]+p[f>>>24&15]+p[f>>>20&15]+p[f>>>16&15]+p[f>>>12&15]+p[f>>>8&15]+p[f>>>4&15]+p[f&15]+p[A>>>28&15]+p[A>>>24&15]+p[A>>>20&15]+p[A>>>16&15]+p[A>>>12&15]+p[A>>>8&15]+p[A>>>4&15]+p[A&15];return this.is224||(_+=p[s>>>28&15]+p[s>>>24&15]+p[s>>>20&15]+p[s>>>16&15]+p[s>>>12&15]+p[s>>>8&15]+p[s>>>4&15]+p[s&15]),_},j.prototype.toString=j.prototype.hex,j.prototype.digest=function(){this.finalize();var n=this.h0,d=this.h1,b=this.h2,h=this.h3,v=this.h4,f=this.h5,A=this.h6,s=this.h7,_=[n>>>24&255,n>>>16&255,n>>>8&255,n&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,A>>>24&255,A>>>16&255,A>>>8&255,A&255];return this.is224||_.push(s>>>24&255,s>>>16&255,s>>>8&255,s&255),_},j.prototype.array=j.prototype.digest,j.prototype.arrayBuffer=function(){this.finalize();var n=new ArrayBuffer(this.is224?28:32),d=new DataView(n);return d.setUint32(0,this.h0),d.setUint32(4,this.h1),d.setUint32(8,this.h2),d.setUint32(12,this.h3),d.setUint32(16,this.h4),d.setUint32(20,this.h5),d.setUint32(24,this.h6),this.is224||d.setUint32(28,this.h7),n};function Z(n,d,b){var h,v=typeof n;if(v==="string"){var f=[],A=n.length,s=0,_;for(h=0;h<A;++h)_=n.charCodeAt(h),_<128?f[s++]=_:_<2048?(f[s++]=192|_>>>6,f[s++]=128|_&63):_<55296||_>=57344?(f[s++]=224|_>>>12,f[s++]=128|_>>>6&63,f[s++]=128|_&63):(_=65536+((_&1023)<<10|n.charCodeAt(++h)&1023),f[s++]=240|_>>>18,f[s++]=128|_>>>12&63,f[s++]=128|_>>>6&63,f[s++]=128|_&63);n=f}else if(v==="object"){if(n===null)throw new Error(e);if(N&&n.constructor===ArrayBuffer)n=new Uint8Array(n);else if(!Array.isArray(n)&&(!N||!ArrayBuffer.isView(n)))throw new Error(e)}else throw new Error(e);n.length>64&&(n=new j(d,!0).update(n).array());var R=[],O=[];for(h=0;h<64;++h){var P=n[h]||0;R[h]=92^P,O[h]=54^P}j.call(this,d,b),this.update(O),this.oKeyPad=R,this.inner=!0,this.sharedMemory=b}Z.prototype=new j,Z.prototype.finalize=function(){if(j.prototype.finalize.call(this),this.inner){this.inner=!1;var n=this.array();j.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(n),j.prototype.finalize.call(this)}};var K=ke();K.sha256=K,K.sha224=ke(!0),K.sha256.hmac=Y(),K.sha224.hmac=Y(!0),C?u.exports=K:(w.sha256=K.sha256,w.sha224=K.sha224)})()})(Me);var pt=Me.exports;const mt=Ve(pt);class fe extends Error{}fe.prototype.name="InvalidTokenError";function vt(u){return decodeURIComponent(atob(u).replace(/(.)/g,(e,g)=>{let w=g.charCodeAt(0).toString(16).toUpperCase();return w.length<2&&(w="0"+w),"%"+w}))}function gt(u){let e=u.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return vt(e)}catch{return atob(e)}}function _e(u,e){if(typeof u!="string")throw new fe("Invalid token specified: must be a string");e||(e={});const g=e.header===!0?0:1,w=u.split(".")[g];if(typeof w!="string")throw new fe(`Invalid token specified: missing part #${g+1}`);let T;try{T=gt(w)}catch(y){throw new fe(`Invalid token specified: invalid base64 for part #${g+1} (${y.message})`)}try{return JSON.parse(T)}catch(y){throw new fe(`Invalid token specified: invalid json for part #${g+1} (${y.message})`)}}if(typeof Promise>"u")throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");function Ne(u){if(!(this instanceof Ne))throw new Error("The 'Keycloak' constructor must be invoked with 'new'.");for(var e=this,g,w=[],T,y={enable:!0,callbackList:[],interval:5},C=document.getElementsByTagName("script"),N=0;N<C.length;N++)(C[N].src.indexOf("keycloak.js")!==-1||C[N].src.indexOf("keycloak.min.js")!==-1)&&C[N].src.indexOf("version=")!==-1&&(e.iframeVersion=C[N].src.substring(C[N].src.indexOf("version=")+8).split("&")[0]);var p=!0,G=V(console.info),H=V(console.warn);e.init=function(t){if(e.didInitialize)throw new Error("A 'Keycloak' instance can only be initialized once.");e.didInitialize=!0,e.authenticated=!1,T=I();var r=["default","cordova","cordova-native"];if(t&&r.indexOf(t.adapter)>-1?g=O(t.adapter):t&&typeof t.adapter=="object"?g=t.adapter:window.Cordova||window.cordova?g=O("cordova"):g=O(),t){if(typeof t.useNonce<"u"&&(p=t.useNonce),typeof t.checkLoginIframe<"u"&&(y.enable=t.checkLoginIframe),t.checkLoginIframeInterval&&(y.interval=t.checkLoginIframeInterval),t.onLoad==="login-required"&&(e.loginRequired=!0),t.responseMode)if(t.responseMode==="query"||t.responseMode==="fragment")e.responseMode=t.responseMode;else throw"Invalid value for responseMode";if(t.flow){switch(t.flow){case"standard":e.responseType="code";break;case"implicit":e.responseType="id_token token";break;case"hybrid":e.responseType="code id_token token";break;default:throw"Invalid value for flow"}e.flow=t.flow}if(t.timeSkew!=null&&(e.timeSkew=t.timeSkew),t.redirectUri&&(e.redirectUri=t.redirectUri),t.silentCheckSsoRedirectUri&&(e.silentCheckSsoRedirectUri=t.silentCheckSsoRedirectUri),typeof t.silentCheckSsoFallback=="boolean"?e.silentCheckSsoFallback=t.silentCheckSsoFallback:e.silentCheckSsoFallback=!0,typeof t.pkceMethod<"u"){if(t.pkceMethod!=="S256"&&t.pkceMethod!==!1)throw new TypeError(`Invalid value for pkceMethod', expected 'S256' or false but got ${t.pkceMethod}.`);e.pkceMethod=t.pkceMethod}else e.pkceMethod="S256";typeof t.enableLogging=="boolean"?e.enableLogging=t.enableLogging:e.enableLogging=!1,t.logoutMethod==="POST"?e.logoutMethod="POST":e.logoutMethod="GET",typeof t.scope=="string"&&(e.scope=t.scope),typeof t.acrValues=="string"&&(e.acrValues=t.acrValues),typeof t.messageReceiveTimeout=="number"&&t.messageReceiveTimeout>0?e.messageReceiveTimeout=t.messageReceiveTimeout:e.messageReceiveTimeout=1e4}e.responseMode||(e.responseMode="fragment"),e.responseType||(e.responseType="code",e.flow="standard");var i=v(),l=v();l.promise.then(function(){e.onReady&&e.onReady(e.authenticated),i.setSuccess(e.authenticated)}).catch(function(x){i.setError(x)});var o=j();function m(){var x=function(U){U||(S.prompt="none"),t&&t.locale&&(S.locale=t.locale),e.login(S).then(function(){l.setSuccess()}).catch(function($){l.setError($)})},k=function(){var U=document.createElement("iframe"),$=e.createLoginUrl({prompt:"none",redirectUri:e.silentCheckSsoRedirectUri});U.setAttribute("src",$),U.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),U.setAttribute("title","keycloak-silent-check-sso"),U.style.display="none",document.body.appendChild(U);var Q=function(D){if(!(D.origin!==window.location.origin||U.contentWindow!==D.source)){var ue=d(D.data);Y(ue,l),document.body.removeChild(U),window.removeEventListener("message",Q)}};window.addEventListener("message",Q)},S={};switch(t.onLoad){case"check-sso":y.enable?A().then(function(){_().then(function(U){U?l.setSuccess():e.silentCheckSsoRedirectUri?k():x(!1)}).catch(function(U){l.setError(U)})}):e.silentCheckSsoRedirectUri?k():x(!1);break;case"login-required":x(!0);break;default:throw"Invalid value for onLoad"}}function a(){var x=d(window.location.href);if(x&&window.history.replaceState(window.history.state,null,x.newUrl),x&&x.valid)return A().then(function(){Y(x,l)}).catch(function(k){l.setError(k)});t?t.token&&t.refreshToken?(K(t.token,t.refreshToken,t.idToken),y.enable?A().then(function(){_().then(function(k){k?(e.onAuthSuccess&&e.onAuthSuccess(),l.setSuccess(),s()):l.setSuccess()}).catch(function(k){l.setError(k)})}):e.updateToken(-1).then(function(){e.onAuthSuccess&&e.onAuthSuccess(),l.setSuccess()}).catch(function(k){e.onAuthError&&e.onAuthError(),t.onLoad?m():l.setError(k)})):t.onLoad?m():l.setSuccess():l.setSuccess()}function c(){var x=v(),k=function(){(document.readyState==="interactive"||document.readyState==="complete")&&(document.removeEventListener("readystatechange",k),x.setSuccess())};return document.addEventListener("readystatechange",k),k(),x.promise}return o.then(function(){c().then(R).then(a).catch(function(x){i.setError(x)})}),o.catch(function(x){i.setError(x)}),i.promise},e.login=function(t){return g.login(t)};function ne(t){var r=null,i=window.crypto||window.msCrypto;if(i&&i.getRandomValues&&window.Uint8Array)return r=new Uint8Array(t),i.getRandomValues(r),r;r=new Array(t);for(var l=0;l<r.length;l++)r[l]=Math.floor(256*Math.random());return r}function oe(t){return L(t,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}function L(t,r){for(var i=ne(t),l=new Array(t),o=0;o<t;o++)l[o]=r.charCodeAt(i[o]%r.length);return String.fromCharCode.apply(null,l)}function ge(t,r){if(t!=="S256")throw new TypeError(`Invalid value for 'pkceMethod', expected 'S256' but got '${t}'.`);const i=new Uint8Array(mt.arrayBuffer(r));return kt(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}function ke(t){var r={id_token:{acr:t}};return JSON.stringify(r)}e.createLoginUrl=function(t){var r=n(),i=n(),l=g.redirectUri(t),o={state:r,nonce:i,redirectUri:encodeURIComponent(l),loginOptions:t};t&&t.prompt&&(o.prompt=t.prompt);var m;t&&t.action=="register"?m=e.endpoints.register():m=e.endpoints.authorize();var a=t&&t.scope||e.scope;a?a.indexOf("openid")===-1&&(a="openid "+a):a="openid";var c=m+"?client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(l)+"&state="+encodeURIComponent(r)+"&response_mode="+encodeURIComponent(e.responseMode)+"&response_type="+encodeURIComponent(e.responseType)+"&scope="+encodeURIComponent(a);if(p&&(c=c+"&nonce="+encodeURIComponent(i)),t&&t.prompt&&(c+="&prompt="+encodeURIComponent(t.prompt)),t&&t.maxAge&&(c+="&max_age="+encodeURIComponent(t.maxAge)),t&&t.loginHint&&(c+="&login_hint="+encodeURIComponent(t.loginHint)),t&&t.idpHint&&(c+="&kc_idp_hint="+encodeURIComponent(t.idpHint)),t&&t.action&&t.action!="register"&&(c+="&kc_action="+encodeURIComponent(t.action)),t&&t.locale&&(c+="&ui_locales="+encodeURIComponent(t.locale)),t&&t.acr){var x=ke(t.acr);c+="&claims="+encodeURIComponent(x)}if((t&&t.acrValues||e.acrValues)&&(c+="&acr_values="+encodeURIComponent(t.acrValues||e.acrValues)),e.pkceMethod){var k=oe(96);o.pkceCodeVerifier=k;var S=ge(e.pkceMethod,k);c+="&code_challenge="+S,c+="&code_challenge_method="+e.pkceMethod}return T.add(o),c},e.logout=function(t){return g.logout(t)},e.createLogoutUrl=function(t){if((t?.logoutMethod??e.logoutMethod)==="POST")return e.endpoints.logout();var i=e.endpoints.logout()+"?client_id="+encodeURIComponent(e.clientId)+"&post_logout_redirect_uri="+encodeURIComponent(g.redirectUri(t,!1));return e.idToken&&(i+="&id_token_hint="+encodeURIComponent(e.idToken)),i},e.register=function(t){return g.register(t)},e.createRegisterUrl=function(t){return t||(t={}),t.action="register",e.createLoginUrl(t)},e.createAccountUrl=function(t){var r=q(),i=void 0;return typeof r<"u"&&(i=r+"/account?referrer="+encodeURIComponent(e.clientId)+"&referrer_uri="+encodeURIComponent(g.redirectUri(t))),i},e.accountManagement=function(){return g.accountManagement()},e.hasRealmRole=function(t){var r=e.realmAccess;return!!r&&r.roles.indexOf(t)>=0},e.hasResourceRole=function(t,r){if(!e.resourceAccess)return!1;var i=e.resourceAccess[r||e.clientId];return!!i&&i.roles.indexOf(t)>=0},e.loadUserProfile=function(){var t=q()+"/account",r=new XMLHttpRequest;r.open("GET",t,!0),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Authorization","bearer "+e.token);var i=v();return r.onreadystatechange=function(){r.readyState==4&&(r.status==200?(e.profile=JSON.parse(r.responseText),i.setSuccess(e.profile)):i.setError())},r.send(),i.promise},e.loadUserInfo=function(){var t=e.endpoints.userinfo(),r=new XMLHttpRequest;r.open("GET",t,!0),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Authorization","bearer "+e.token);var i=v();return r.onreadystatechange=function(){r.readyState==4&&(r.status==200?(e.userInfo=JSON.parse(r.responseText),i.setSuccess(e.userInfo)):i.setError())},r.send(),i.promise},e.isTokenExpired=function(t){if(!e.tokenParsed||!e.refreshToken&&e.flow!="implicit")throw"Not authenticated";if(e.timeSkew==null)return G("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var r=e.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+e.timeSkew;if(t){if(isNaN(t))throw"Invalid minValidity";r-=t}return r<0},e.updateToken=function(t){var r=v();if(!e.refreshToken)return r.setError(),r.promise;t=t||5;var i=function(){var o=!1;if(t==-1?(o=!0,G("[KEYCLOAK] Refreshing token: forced refresh")):(!e.tokenParsed||e.isTokenExpired(t))&&(o=!0,G("[KEYCLOAK] Refreshing token: token expired")),!o)r.setSuccess(!1);else{var m="grant_type=refresh_token&refresh_token="+e.refreshToken,a=e.endpoints.token();if(w.push(r),w.length==1){var c=new XMLHttpRequest;c.open("POST",a,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.withCredentials=!0,m+="&client_id="+encodeURIComponent(e.clientId);var x=new Date().getTime();c.onreadystatechange=function(){if(c.readyState==4)if(c.status==200){G("[KEYCLOAK] Token refreshed"),x=(x+new Date().getTime())/2;var k=JSON.parse(c.responseText);K(k.access_token,k.refresh_token,k.id_token,x),e.onAuthRefreshSuccess&&e.onAuthRefreshSuccess();for(var S=w.pop();S!=null;S=w.pop())S.setSuccess(!0)}else{H("[KEYCLOAK] Failed to refresh token"),c.status==400&&e.clearToken(),e.onAuthRefreshError&&e.onAuthRefreshError();for(var S=w.pop();S!=null;S=w.pop())S.setError(!0)}},c.send(m)}}};if(y.enable){var l=_();l.then(function(){i()}).catch(function(o){r.setError(o)})}else i();return r.promise},e.clearToken=function(){e.token&&(K(null,null,null),e.onAuthLogout&&e.onAuthLogout(),e.loginRequired&&e.login())};function q(){if(typeof e.authServerUrl<"u")return e.authServerUrl.charAt(e.authServerUrl.length-1)=="/"?e.authServerUrl+"realms/"+encodeURIComponent(e.realm):e.authServerUrl+"/realms/"+encodeURIComponent(e.realm)}function xe(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function Y(t,r){var i=t.code,l=t.error,o=t.prompt,m=new Date().getTime();if(t.kc_action_status&&e.onActionUpdate&&e.onActionUpdate(t.kc_action_status),l){if(o!="none")if(t.error_description&&t.error_description==="authentication_expired")e.login(t.loginOptions);else{var a={error:l,error_description:t.error_description};e.onAuthError&&e.onAuthError(a),r&&r.setError(a)}else r&&r.setSuccess();return}else e.flow!="standard"&&(t.access_token||t.id_token)&&S(t.access_token,null,t.id_token,!0);if(e.flow!="implicit"&&i){var c="code="+i+"&grant_type=authorization_code",x=e.endpoints.token(),k=new XMLHttpRequest;k.open("POST",x,!0),k.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c+="&client_id="+encodeURIComponent(e.clientId),c+="&redirect_uri="+t.redirectUri,t.pkceCodeVerifier&&(c+="&code_verifier="+t.pkceCodeVerifier),k.withCredentials=!0,k.onreadystatechange=function(){if(k.readyState==4)if(k.status==200){var U=JSON.parse(k.responseText);S(U.access_token,U.refresh_token,U.id_token,e.flow==="standard"),s()}else e.onAuthError&&e.onAuthError(),r&&r.setError()},k.send(c)}function S(U,$,Q,D){m=(m+new Date().getTime())/2,K(U,$,Q,m),p&&e.idTokenParsed&&e.idTokenParsed.nonce!=t.storedNonce?(G("[KEYCLOAK] Invalid nonce, clearing token"),e.clearToken(),r&&r.setError()):D&&(e.onAuthSuccess&&e.onAuthSuccess(),r&&r.setSuccess())}}function j(t){var r=v(),i;u?typeof u=="string"&&(i=u):i="keycloak.json";function l(k){k?e.endpoints={authorize:function(){return k.authorization_endpoint},token:function(){return k.token_endpoint},logout:function(){if(!k.end_session_endpoint)throw"Not supported by the OIDC server";return k.end_session_endpoint},checkSessionIframe:function(){if(!k.check_session_iframe)throw"Not supported by the OIDC server";return k.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!k.userinfo_endpoint)throw"Not supported by the OIDC server";return k.userinfo_endpoint}}:e.endpoints={authorize:function(){return q()+"/protocol/openid-connect/auth"},token:function(){return q()+"/protocol/openid-connect/token"},logout:function(){return q()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var S=q()+"/protocol/openid-connect/login-status-iframe.html";return e.iframeVersion&&(S=S+"?version="+e.iframeVersion),S},thirdPartyCookiesIframe:function(){var S=q()+"/protocol/openid-connect/3p-cookies/step1.html";return e.iframeVersion&&(S=S+"?version="+e.iframeVersion),S},register:function(){return q()+"/protocol/openid-connect/registrations"},userinfo:function(){return q()+"/protocol/openid-connect/userinfo"}}}if(i){var o=new XMLHttpRequest;o.open("GET",i,!0),o.setRequestHeader("Accept","application/json"),o.onreadystatechange=function(){if(o.readyState==4)if(o.status==200||Z(o)){var k=JSON.parse(o.responseText);e.authServerUrl=k["auth-server-url"],e.realm=k.realm,e.clientId=k.resource,l(null),r.setSuccess()}else r.setError()},o.send()}else{if(!u.clientId)throw"clientId missing";e.clientId=u.clientId;var m=u.oidcProvider;if(m)if(typeof m=="string"){var x;m.charAt(m.length-1)=="/"?x=m+".well-known/openid-configuration":x=m+"/.well-known/openid-configuration";var o=new XMLHttpRequest;o.open("GET",x,!0),o.setRequestHeader("Accept","application/json"),o.onreadystatechange=function(){if(o.readyState==4)if(o.status==200||Z(o)){var S=JSON.parse(o.responseText);l(S),r.setSuccess()}else r.setError()},o.send()}else l(m),r.setSuccess();else{if(!u.url){for(var a=document.getElementsByTagName("script"),c=0;c<a.length;c++)if(a[c].src.match(/.*keycloak\.js/)){u.url=a[c].src.substr(0,a[c].src.indexOf("/js/keycloak.js"));break}}if(!u.realm)throw"realm missing";e.authServerUrl=u.url,e.realm=u.realm,l(null),r.setSuccess()}}return r.promise}function Z(t){return t.status==0&&t.responseText&&t.responseURL.startsWith("file:")}function K(t,r,i,l){if(e.tokenTimeoutHandle&&(clearTimeout(e.tokenTimeoutHandle),e.tokenTimeoutHandle=null),r?(e.refreshToken=r,e.refreshTokenParsed=_e(r)):(delete e.refreshToken,delete e.refreshTokenParsed),i?(e.idToken=i,e.idTokenParsed=_e(i)):(delete e.idToken,delete e.idTokenParsed),t){if(e.token=t,e.tokenParsed=_e(t),e.sessionId=e.tokenParsed.sid,e.authenticated=!0,e.subject=e.tokenParsed.sub,e.realmAccess=e.tokenParsed.realm_access,e.resourceAccess=e.tokenParsed.resource_access,l&&(e.timeSkew=Math.floor(l/1e3)-e.tokenParsed.iat),e.timeSkew!=null&&(G("[KEYCLOAK] Estimated time difference between browser and server is "+e.timeSkew+" seconds"),e.onTokenExpired)){var o=(e.tokenParsed.exp-new Date().getTime()/1e3+e.timeSkew)*1e3;G("[KEYCLOAK] Token expires in "+Math.round(o/1e3)+" s"),o<=0?e.onTokenExpired():e.tokenTimeoutHandle=setTimeout(e.onTokenExpired,o)}}else delete e.token,delete e.tokenParsed,delete e.subject,delete e.realmAccess,delete e.resourceAccess,e.authenticated=!1}function n(){var t="0123456789abcdef",r=L(36,t).split("");r[14]="4",r[19]=t.substr(r[19]&3|8,1),r[8]=r[13]=r[18]=r[23]="-";var i=r.join("");return i}function d(t){var r=b(t);if(r){var i=T.get(r.state);return i&&(r.valid=!0,r.redirectUri=i.redirectUri,r.storedNonce=i.nonce,r.prompt=i.prompt,r.pkceCodeVerifier=i.pkceCodeVerifier,r.loginOptions=i.loginOptions),r}}function b(t){var r;switch(e.flow){case"standard":r=["code","state","session_state","kc_action_status","iss"];break;case"implicit":r=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status","iss"];break;case"hybrid":r=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status","iss"];break}r.push("error"),r.push("error_description"),r.push("error_uri");var i=t.indexOf("?"),l=t.indexOf("#"),o,m;if(e.responseMode==="query"&&i!==-1?(o=t.substring(0,i),m=h(t.substring(i+1,l!==-1?l:t.length),r),m.paramsString!==""&&(o+="?"+m.paramsString),l!==-1&&(o+=t.substring(l))):e.responseMode==="fragment"&&l!==-1&&(o=t.substring(0,l),m=h(t.substring(l+1),r),m.paramsString!==""&&(o+="#"+m.paramsString)),m&&m.oauthParams){if(e.flow==="standard"||e.flow==="hybrid"){if((m.oauthParams.code||m.oauthParams.error)&&m.oauthParams.state)return m.oauthParams.newUrl=o,m.oauthParams}else if(e.flow==="implicit"&&(m.oauthParams.access_token||m.oauthParams.error)&&m.oauthParams.state)return m.oauthParams.newUrl=o,m.oauthParams}}function h(t,r){for(var i=t.split("&"),l={paramsString:"",oauthParams:{}},o=0;o<i.length;o++){var m=i[o].indexOf("="),a=i[o].slice(0,m);r.indexOf(a)!==-1?l.oauthParams[a]=i[o].slice(m+1):(l.paramsString!==""&&(l.paramsString+="&"),l.paramsString+=i[o])}return l}function v(){var t={setSuccess:function(r){t.resolve(r)},setError:function(r){t.reject(r)}};return t.promise=new Promise(function(r,i){t.resolve=r,t.reject=i}),t}function f(t,r,i){var l=null,o=new Promise(function(m,a){l=setTimeout(function(){a({error:i})},r)});return Promise.race([t,o]).finally(function(){clearTimeout(l)})}function A(){var t=v();if(!y.enable||y.iframe)return t.setSuccess(),t.promise;var r=document.createElement("iframe");y.iframe=r,r.onload=function(){var o=e.endpoints.authorize();o.charAt(0)==="/"?y.iframeOrigin=xe():y.iframeOrigin=o.substring(0,o.indexOf("/",8)),t.setSuccess()};var i=e.endpoints.checkSessionIframe();r.setAttribute("src",i),r.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),r.setAttribute("title","keycloak-session-iframe"),r.style.display="none",document.body.appendChild(r);var l=function(o){if(!(o.origin!==y.iframeOrigin||y.iframe.contentWindow!==o.source)&&(o.data=="unchanged"||o.data=="changed"||o.data=="error")){o.data!="unchanged"&&e.clearToken();for(var m=y.callbackList.splice(0,y.callbackList.length),a=m.length-1;a>=0;--a){var c=m[a];o.data=="error"?c.setError():c.setSuccess(o.data=="unchanged")}}};return window.addEventListener("message",l,!1),t.promise}function s(){y.enable&&e.token&&setTimeout(function(){_().then(function(t){t&&s()})},y.interval*1e3)}function _(){var t=v();if(y.iframe&&y.iframeOrigin){var r=e.clientId+" "+(e.sessionId?e.sessionId:"");y.callbackList.push(t);var i=y.iframeOrigin;y.callbackList.length==1&&y.iframe.contentWindow.postMessage(r,i)}else t.setSuccess();return t.promise}function R(){var t=v();if(y.enable||e.silentCheckSsoRedirectUri){var r=document.createElement("iframe");r.setAttribute("src",e.endpoints.thirdPartyCookiesIframe()),r.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),r.setAttribute("title","keycloak-3p-check-iframe"),r.style.display="none",document.body.appendChild(r);var i=function(l){r.contentWindow===l.source&&(l.data!=="supported"&&l.data!=="unsupported"||(l.data==="unsupported"&&(H(`[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:

 - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).
 - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).

For more information see: https://www.keycloak.org/docs/latest/securing_apps/#_modern_browsers`),y.enable=!1,e.silentCheckSsoFallback&&(e.silentCheckSsoRedirectUri=!1)),document.body.removeChild(r),window.removeEventListener("message",i),t.setSuccess()))};window.addEventListener("message",i,!1)}else t.setSuccess();return f(t.promise,e.messageReceiveTimeout,"Timeout when waiting for 3rd party check iframe message.")}function O(t){if(!t||t=="default")return{login:function(a){return window.location.assign(e.createLoginUrl(a)),v().promise},logout:async function(a){if((a?.logoutMethod??e.logoutMethod)==="GET"){window.location.replace(e.createLogoutUrl(a));return}const x=e.createLogoutUrl(a),k=await fetch(x,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({id_token_hint:e.idToken,client_id:e.clientId,post_logout_redirect_uri:g.redirectUri(a,!1)})});if(k.redirected){window.location.href=k.url;return}if(k.ok){window.location.reload();return}throw new Error("Logout failed, request returned an error code.")},register:function(a){return window.location.assign(e.createRegisterUrl(a)),v().promise},accountManagement:function(){var a=e.createAccountUrl();if(typeof a<"u")window.location.href=a;else throw"Not supported by the OIDC server";return v().promise},redirectUri:function(a,c){return a&&a.redirectUri?a.redirectUri:e.redirectUri?e.redirectUri:location.href}};if(t=="cordova"){y.enable=!1;var r=function(a,c,x){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(a,c,x):window.open(a,c,x)},i=function(a){return a&&a.cordovaOptions?Object.keys(a.cordovaOptions).reduce(function(c,x){return c[x]=a.cordovaOptions[x],c},{}):{}},l=function(a){return Object.keys(a).reduce(function(c,x){return c.push(x+"="+a[x]),c},[]).join(",")},o=function(a){var c=i(a);return c.location="no",a&&a.prompt=="none"&&(c.hidden="yes"),l(c)},m=function(){return e.redirectUri||"http://localhost"};return{login:function(a){var c=v(),x=o(a),k=e.createLoginUrl(a),S=r(k,"_blank",x),U=!1,$=!1,Q=function(){$=!0,S.close()};return S.addEventListener("loadstart",function(D){if(D.url.indexOf(m())==0){var ue=d(D.url);Y(ue,c),Q(),U=!0}}),S.addEventListener("loaderror",function(D){if(!U)if(D.url.indexOf(m())==0){var ue=d(D.url);Y(ue,c),Q(),U=!0}else c.setError(),Q()}),S.addEventListener("exit",function(D){$||c.setError({reason:"closed_by_user"})}),c.promise},logout:function(a){var c=v(),x=e.createLogoutUrl(a),k=r(x,"_blank","location=no,hidden=yes,clearcache=yes"),S;return k.addEventListener("loadstart",function(U){U.url.indexOf(m())==0&&k.close()}),k.addEventListener("loaderror",function(U){U.url.indexOf(m())==0||(S=!0),k.close()}),k.addEventListener("exit",function(U){S?c.setError():(e.clearToken(),c.setSuccess())}),c.promise},register:function(a){var c=v(),x=e.createRegisterUrl(),k=o(a),S=r(x,"_blank",k);return S.addEventListener("loadstart",function(U){if(U.url.indexOf(m())==0){S.close();var $=d(U.url);Y($,c)}}),c.promise},accountManagement:function(){var a=e.createAccountUrl();if(typeof a<"u"){var c=r(a,"_blank","location=no");c.addEventListener("loadstart",function(x){x.url.indexOf(m())==0&&c.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(a){return m()}}}if(t=="cordova-native")return y.enable=!1,{login:function(a){var c=v(),x=e.createLoginUrl(a);return universalLinks.subscribe("keycloak",function(k){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var S=d(k.url);Y(S,c)}),window.cordova.plugins.browsertab.openUrl(x),c.promise},logout:function(a){var c=v(),x=e.createLogoutUrl(a);return universalLinks.subscribe("keycloak",function(k){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),e.clearToken(),c.setSuccess()}),window.cordova.plugins.browsertab.openUrl(x),c.promise},register:function(a){var c=v(),x=e.createRegisterUrl(a);return universalLinks.subscribe("keycloak",function(k){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var S=d(k.url);Y(S,c)}),window.cordova.plugins.browsertab.openUrl(x),c.promise},accountManagement:function(){var a=e.createAccountUrl();if(typeof a<"u")window.cordova.plugins.browsertab.openUrl(a);else throw"Not supported by the OIDC server"},redirectUri:function(a){return a&&a.redirectUri?a.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};throw"invalid adapter type: "+t}var P=function(){if(!(this instanceof P))return new P;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");var t=this;function r(){for(var i=new Date().getTime(),l=0;l<localStorage.length;l++){var o=localStorage.key(l);if(o&&o.indexOf("kc-callback-")==0){var m=localStorage.getItem(o);if(m)try{var a=JSON.parse(m).expires;(!a||a<i)&&localStorage.removeItem(o)}catch{localStorage.removeItem(o)}}}}t.get=function(i){if(i){var l="kc-callback-"+i,o=localStorage.getItem(l);return o&&(localStorage.removeItem(l),o=JSON.parse(o)),r(),o}},t.add=function(i){r();var l="kc-callback-"+i.state;i.expires=new Date().getTime()+60*60*1e3,localStorage.setItem(l,JSON.stringify(i))}},z=function(){if(!(this instanceof z))return new z;var t=this;t.get=function(o){if(o){var m=i("kc-callback-"+o);if(l("kc-callback-"+o,"",r(-100)),m)return JSON.parse(m)}},t.add=function(o){l("kc-callback-"+o.state,JSON.stringify(o),r(60))},t.removeItem=function(o){l(o,"",r(-100))};var r=function(o){var m=new Date;return m.setTime(m.getTime()+o*60*1e3),m},i=function(o){for(var m=o+"=",a=document.cookie.split(";"),c=0;c<a.length;c++){for(var x=a[c];x.charAt(0)==" ";)x=x.substring(1);if(x.indexOf(m)==0)return x.substring(m.length,x.length)}return""},l=function(o,m,a){var c=o+"="+m+"; expires="+a.toUTCString()+"; ";document.cookie=c}};function I(){try{return new P}catch{}return new z}function V(t){return function(){e.enableLogging&&t.apply(console,Array.prototype.slice.call(arguments))}}}function kt(u){const e=String.fromCodePoint(...u);return btoa(e)}const W=Ye("authentication-keycloak:KeycloakAuthPlugin");var pe,se,te,M,ce,le,re,me,ve,X,He,de;class xt{constructor(e){B(this,X);B(this,pe);B(this,se);B(this,te);B(this,M);B(this,ce);B(this,le);B(this,re);B(this,me);B(this,ve,We({kind:"pending"}));J(this,pe,e.references.notifier),J(this,se,e.intl),J(this,ce,{redirectUri:void 0}),J(this,le,{redirectUri:void 0});try{J(this,te,wt(e.properties))}catch(g){throw new Error("Invalid keycloak configuration",{cause:g})}try{J(this,M,new Ne(E(this,te).keycloakConfig))}catch(g){throw new Error("Failed to construct keycloak instance",{cause:g})}ee(this,X,He).call(this).catch(g=>{ee(this,X,de).call(this,{kind:"error",error:g}),E(this,pe).notify({level:"error",title:E(this,se).formatMessage({id:"loginFailed.title"}),message:E(this,se).formatMessage({id:"loginFailed.message"})}),W.error("Failed to check if user is authenticated",g)})}destroy(){clearInterval(E(this,re)),J(this,me,Je(E(this,me))),J(this,re,void 0)}getAuthState(){return E(this,ve).value}getLoginBehavior(){return{kind:"effect",login:()=>{W.debug("Login with options",E(this,le)),E(this,M).login(E(this,le))}}}logout(){W.debug("Logout with options",E(this,ce)),E(this,M).logout(E(this,ce))}__refresh(e,g){clearInterval(E(this,re)),J(this,re,setInterval(()=>{E(this,M).updateToken(g).catch(w=>{W.error("Failed to refresh token",w),ee(this,X,de).call(this,{kind:"not-authenticated"}),this.destroy()})},e))}}pe=new WeakMap,se=new WeakMap,te=new WeakMap,M=new WeakMap,ce=new WeakMap,le=new WeakMap,re=new WeakMap,me=new WeakMap,ve=new WeakMap,X=new WeakSet,He=async function(){const e=E(this,te),g=E(this,te).keycloakInitOptions,w=e.refreshOptions;let T;try{T=await E(this,M).init(g)}catch(y){const C=typeof y=="string"?new Error(y):y;throw new Error("Failed to initialize keycloak session",{cause:C})}T?(ee(this,X,de).call(this,{kind:"authenticated",sessionInfo:{userId:E(this,M).subject?E(this,M).subject:"undefined",userName:E(this,M).idTokenParsed?.preferred_username,attributes:{keycloak:E(this,M),familyName:E(this,M).idTokenParsed?.family_name,givenName:E(this,M).idTokenParsed?.given_name,userName:E(this,M).idTokenParsed?.preferred_username}}}),W.debug(`User ${E(this,M).subject} is authenticated`),w.autoRefresh&&(W.debug("Starting auto-refresh",w),this.__refresh(w.interval,w.timeLeft))):(ee(this,X,de).call(this,{kind:"not-authenticated"}),W.debug("User is not authenticated"))},de=function(e){E(this,ve).value=e};const Le={autoRefresh:!0,interval:6e3,timeLeft:70},je={onLoad:"check-sso",pkceMethod:"S256"};function wt(u){const{keycloakOptions:e}=u,{refreshOptions:g,keycloakInitOptions:w,keycloakConfig:T}=e;return{refreshOptions:{...bt(g)},keycloakInitOptions:{...yt(w)},keycloakConfig:{...St(T)}}}function bt(u){return!u||Fe(u)?(W.warn(`The autorefresh options of the Keycloak configuration should be set to ensure automatic refreshes at specified intervals. Defaulting to '${Le}'.`),Object.assign({},{...Le})):u}function yt(u){return!u||Fe(u)?(W.warn(`The Keycloak init options of the keycloak configuration should be set. Defaulting to '${je}'.`),Object.assign({},{...je})):u}function St(u){if(!u||Fe(u))throw new Error("KeycloakConfig not found: The Keycloak configuration options are required by the plugin to perform login and logout operations");return u}const Fe=u=>u&&Object.keys(u).length===0&&u.constructor===Object,_t={"keycloak-sample":{name:"keycloak-sample",services:{SampleTokenInterceptor:{name:"SampleTokenInterceptor",clazz:st,provides:[{name:"http.Interceptor",qualifier:void 0}],references:{authService:{name:"authentication.AuthService",qualifier:void 0,all:!1}}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1},{name:"http.HttpService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/authentication":{name:"@open-pioneer/authentication",services:{AuthServiceImpl:{name:"AuthServiceImpl",clazz:Xe,provides:[{name:"authentication.AuthService",qualifier:void 0}],references:{plugin:{name:"authentication.AuthPlugin",qualifier:void 0,all:!1}}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/notifier":{name:"@open-pioneer/notifier",services:{NotificationServiceImpl:{name:"NotificationServiceImpl",clazz:tt,provides:[{name:"notifier.NotificationService",qualifier:void 0}],references:{appCtx:{name:"runtime.ApplicationContext",qualifier:void 0,all:!1}}}},ui:{references:[{name:"notifier.NotificationService",qualifier:void 0,all:!1}]},properties:{position:{value:"top-right",required:!1}}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/reactivity":{name:"@open-pioneer/reactivity",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/http":{name:"@open-pioneer/http",services:{HttpServiceImpl:{name:"HttpServiceImpl",clazz:ct,provides:[{name:"http.HttpService",qualifier:void 0}],references:{interceptors:{name:"http.Interceptor",qualifier:void 0,all:!0}}}},ui:{references:[]},properties:{}},"@open-pioneer/authentication-keycloak":{name:"@open-pioneer/authentication-keycloak",services:{KeycloakAuthPlugin:{name:"KeycloakAuthPlugin",clazz:xt,provides:[{name:"authentication.AuthPlugin",qualifier:void 0},{name:"authentication-keycloak.KeycloakAuthPlugin",qualifier:void 0}],references:{notifier:{name:"notifier.NotificationService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{keycloakOptions:{value:{refreshOptions:null,keycloakInitOptions:null,keycloakConfig:null,keycloakLogoutOptions:null,keycloakLoginOptions:null},required:!1}}}},At="",Ft=["de","en"];function It(u){switch(u){case"de":return Te(()=>import("./B1VR2lbE9HZn.js"),[],import.meta.url).then(e=>e.default);case"en":return Te(()=>import("./MiNfHBqPghPY.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${u}'`)}const Ut=$e(At),Et=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:It,locales:Ft,packages:_t,styles:Ut},Symbol.toStringTag,{value:"Module"})),Tt="keycloak-sample",Ae=nt.bind(void 0,Tt);function Rt(){const u=Ae("authentication.AuthService"),e=()=>{u.logout()};return F.jsx(Oe,{colorPalette:"red",onClick:e,children:"Log out"})}function Ct(){const u=Ae("authentication.AuthService"),e=Ae("http.HttpService"),g=Qe(u),T=(g.kind=="authenticated"?g.sessionInfo:void 0)?.userName,y=()=>{e.fetch("https://ogc-api.nrw.de/inspire-us-kindergarten/v1/collections/governmentalservice/items?f=json").catch(C=>console.error("Request failed",C))};return F.jsxs(F.Fragment,{children:[F.jsx(rt,{}),F.jsxs(ot,{maxW:"800px",children:[F.jsxs(Ze,{height:"100%",direction:"column",overflow:"hidden",children:[F.jsx(Ue,{as:"h1",size:"2xl",children:"Keycloak Sample"}),F.jsxs(Ee,{mt:4,gap:2,align:"stretch",children:[F.jsx(Ue,{as:"h2",size:"xl",children:"Additional Setup"}),F.jsx(ie,{children:"This application requires additional setup. Most importantly, a Keycloak installation must be present."}),F.jsxs(ie,{children:["The following environment properties should be set via vite (e.g. in"," ",F.jsx(ae,{children:".env.local"}),"):"]}),F.jsxs(it,{children:[F.jsxs(ye,{children:[F.jsx(ae,{children:"VITE_KEYCLOAK_CONFIG_URL"})," (the URL to the Keycloak instance)"]}),F.jsxs(ye,{children:[F.jsx(ae,{children:"VITE_KEYCLOAK_CONFIG_REALM"})," (the Keycloak realm)"]}),F.jsxs(ye,{children:[F.jsx(ae,{children:"VITE_KEYCLOAK_CONFIG_CLIENT_ID"})," (the client id of this application)"]})]}),F.jsxs(ie,{textAlign:"center",children:[F.jsx(ie,{as:"b",children:"Status: "}),T!=null?F.jsxs(F.Fragment,{children:["Logged in as ",F.jsx(ae,{children:T}),"."]}):F.jsx(F.Fragment,{children:"Not logged in."})]})]})]}),F.jsx(et,{renderErrorFallback:C=>F.jsxs(F.Fragment,{children:[F.jsx(Re,{children:"An Error occured while trying to login!"}),F.jsx(Re,{color:"red",children:C.message})]}),children:F.jsxs(Ee,{align:"center",p:10,mt:2,gap:3,border:"2px solid red",borderRadius:5,children:[F.jsx(ie,{textAlign:"center",children:"This part of the application is only visible when logged in."}),F.jsx(Rt,{}),F.jsxs(ie,{children:["The following button triggers a request against a backend. The request will automatically include the Keycloak token (see"," ",F.jsx(ae,{children:"SampleTokenInterceptor.ts"}),"):"]}),F.jsx(Oe,{onClick:y,children:"Trigger Request With Token"})]})})]})]})}const Lt=new URLSearchParams(window.location.search),jt=Lt.get("lang")||void 0,Ot=Ge({component:Ct,appMetadata:Et,config:{properties:{"@open-pioneer/authentication-keycloak":{keycloakOptions:{refreshOptions:{autoRefresh:!0,interval:6e3,timeLeft:70},keycloakInitOptions:{onLoad:"check-sso",pkceMethod:"S256"},keycloakConfig:{url:void 0,realm:void 0,clientId:void 0}}}},locale:jt}});customElements.define("keycloak-app-element",Ot);
