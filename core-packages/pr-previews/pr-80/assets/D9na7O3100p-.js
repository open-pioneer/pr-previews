var y=t=>{throw TypeError(t)};var E=(t,r,n)=>r.has(t)||y("Cannot "+n);var m=(t,r,n)=>(E(t,r,"read from private field"),n?n.call(t):r.get(t)),A=(t,r,n)=>r.has(t)?y("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(t):r.set(t,n),v=(t,r,n,s)=>(E(t,r,"write to private field"),s?s.call(t,n):r.set(t,n),n);import{r as c,z as O,j as e,a3 as B,S as U,V as q,H as R,E as k,F as C,G as L,I as D,J as G,a as H,b as N}from"./CxFa1ww1TkZU.js";import{F as $,a as W,b as J,c as K,d as Y}from"./3dtoWqy-20ah.js";import{u as P,I as Q,b as X,c as Z}from"./BzjkameTTGzc.js";import{G as ee}from"./CGKBgW4pvngU.js";import{I as V}from"./BowvygK9eSSf.js";import{H as I}from"./qfumF0c2gjEL.js";import{B as M}from"./CP7YdnlKaIE5.js";import{C as z}from"./C7rhUrrTH5Cz.js";import{T as te}from"./RzIwuIO4p29M.js";import{B as S}from"./3PHSIQtb1Tur.js";import{r as re,A as ne,u as se,F as oe,a as ie}from"./B2YpZjwgeS4M.js";import{_ as T}from"./CmsKOCeNyeyo.js";import{u as ae}from"./DtXrV0RI1Djv.js";import"./Fj3Td3w2I82k.js";import"./dvDQU9EciPth.js";import"./OQDrIKu4LmHY.js";import"./bnTu9Zi6KyUt.js";import"./C3JtgmrzhVmr.js";function le(t){const{value:r,defaultValue:n,onChange:s,shouldUpdate:a=(l,b)=>l!==b}=t,o=P(s),u=P(a),[i,d]=c.useState(n),h=r!==void 0,p=h?r:i,x=P(l=>{const w=typeof l=="function"?l(p):l;u(p,w)&&(h||d(w),o(w))},[h,o,p,u]);return[p,x]}const _=O("div",{base:{display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",zIndex:2,color:"fg.subtle",height:"full",fontSize:"sm",px:"3"},variants:{placement:{start:{insetInlineStart:"0"},end:{insetInlineEnd:"0"}}}}),F=c.forwardRef(function(r,n){const{label:s,children:a,helperText:o,errorText:u,optionalText:i,...d}=r;return e.jsxs($,{ref:n,...d,children:[s&&e.jsxs(W,{children:[s,e.jsx(J,{fallback:i})]}),a,o&&e.jsx(K,{children:o}),u&&e.jsx(Y,{children:u})]})}),ce=c.forwardRef(function(r,n){const{startElement:s,startElementProps:a,endElement:o,endElementProps:u,children:i,startOffset:d="6px",endOffset:h="6px",...p}=r,x=c.Children.only(i);return e.jsxs(ee,{ref:n,...p,children:[s&&e.jsx(_,{pointerEvents:"none",...a,children:s}),c.cloneElement(x,{...s&&{ps:`calc(var(--input-height) - ${d})`},...o&&{pe:`calc(var(--input-height) - ${h})`},...i.props}),o&&e.jsx(_,{placement:"end",...u,children:o})]})}),ue=c.forwardRef(function(r,n){const{rootProps:s,defaultVisible:a,visible:o,onVisibleChange:u,visibilityIcon:i={on:e.jsx(X,{}),off:e.jsx(Z,{})},...d}=r,[h,p]=le({value:o,defaultValue:a||!1,onChange:u}),x=c.useRef(null);return e.jsx(ce,{width:"full",endElement:e.jsx(de,{disabled:d.disabled,onPointerDown:l=>{d.disabled||l.button===0&&(l.preventDefault(),p(!h))},children:h?i.off:i.on}),...s,children:e.jsx(V,{...d,ref:B(n,x),type:h?"text":"password"})})}),de=c.forwardRef(function(r,n){return e.jsx(Q,{tabIndex:-1,ref:n,me:"-2",aspectRatio:"square",size:"sm",variant:"ghost",height:"calc(100% - {spacing.2})","aria-label":"Toggle password visibility",...r})});c.forwardRef(function(r,n){const{max:s=4,value:a,...o}=r,u=a/s*100,{label:i,colorPalette:d}=pe(u);return e.jsxs(U,{align:"flex-end",gap:"1",ref:n,...o,children:[e.jsx(I,{width:"full",ref:n,...o,children:Array.from({length:s}).map((h,p)=>e.jsx(M,{height:"1",flex:"1",rounded:"sm","data-selected":p<a?"":void 0,layerStyle:"fill.subtle",colorPalette:"gray",_selected:{colorPalette:d,layerStyle:"fill.solid"}},p))}),i&&e.jsx(I,{textStyle:"xs",children:i})]})});function pe(t){switch(!0){case t<33:return{label:"Low",colorPalette:"red"};case t<66:return{label:"Medium",colorPalette:"orange"};default:return{label:"High",colorPalette:"green"}}}function he({doLogin:t,doFail:r,wasLoggedIn:n}){const[s,a]=c.useState(""),[o,u]=c.useState(""),[i,d]=c.useState(),[h,p]=c.useState(n),x=l=>{l.preventDefault();const b=t(s,o);d(b||""),p(!1)};return e.jsx(z,{p:5,maxWidth:"xl",children:e.jsxs(q,{as:"form",onSubmit:x,gap:4,children:[e.jsx(R,{as:"h1",textAlign:"center",children:"Login"}),e.jsxs(te,{textAlign:"center",children:["Please enter your user name and password to authenticate.",e.jsx("br",{}),"Note: credentials are ",'"admin"'," / ",'"admin"']}),i&&e.jsxs(k,{status:"error",children:[e.jsx(C,{}),e.jsx(L,{children:e.jsx(D,{children:i})})]}),h&&e.jsxs(k,{status:"info",mb:5,children:[e.jsx(C,{}),e.jsx(L,{children:e.jsxs(G,{children:["Logout successful.",e.jsx("br",{}),"You can use the form below to log in again."]})})]}),e.jsx(F,{label:"User name",children:e.jsx(V,{placeholder:"User name",value:s,onChange:l=>a(l.target.value),autoComplete:"username"})}),e.jsx(F,{label:"Password",children:e.jsx(ue,{value:o,onChange:l=>u(l.target.value)})}),e.jsxs(I,{children:[e.jsx(S,{colorPalette:"red",onClick:r,children:"Let it fail!"}),e.jsx(S,{type:"submit",children:"Login"})]})]})})}var f,g,j;class me{constructor(){A(this,f,re({kind:"pending"}));A(this,g);A(this,j,!1);v(this,g,setTimeout(()=>{m(this,f).value={kind:"not-authenticated"}},500))}destroy(){clearTimeout(m(this,g)),v(this,g,void 0)}getAuthState(){return m(this,f).value}getLoginBehavior(){const r=(a,o)=>{if(a==="admin"&&o==="admin")m(this,f).value={kind:"authenticated",sessionInfo:{userId:"admin",userName:"Arnold Administrator"}},v(this,j,!0);else return"Invalid user name or password!"},n=()=>{m(this,f).value={kind:"error",error:new Error("Login failed!")}};return{kind:"fallback",Fallback:()=>c.createElement(he,{doLogin:r,doFail:n,wasLoggedIn:m(this,j)})}}logout(){(m(this,f).value.kind==="authenticated"||m(this,f).value.kind==="pending")&&(m(this,f).value={kind:"not-authenticated"},clearTimeout(m(this,g)),v(this,g,void 0))}}f=new WeakMap,g=new WeakMap,j=new WeakMap;const fe={"auth-app":{name:"auth-app",services:{TestAuthPlugin:{name:"TestAuthPlugin",clazz:me,provides:[{name:"authentication.AuthPlugin",qualifier:void 0}],references:{}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/authentication":{name:"@open-pioneer/authentication",services:{AuthServiceImpl:{name:"AuthServiceImpl",clazz:ne,provides:[{name:"authentication.AuthService",qualifier:void 0}],references:{plugin:{name:"authentication.AuthPlugin",qualifier:void 0,all:!1}}}},ui:{references:[{name:"authentication.AuthService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/reactivity":{name:"@open-pioneer/reactivity",services:{},ui:{references:[]},properties:{}}},ge="",xe=["en","de"];function ve(t){switch(t){case"en":return T(()=>import("./P9WplnIxWHzS.js"),[],import.meta.url).then(r=>r.default);case"de":return T(()=>import("./z2D46c5wMnzO.js"),[],import.meta.url).then(r=>r.default)}throw new Error(`Unsupported locale: '${t}'`)}const je=H(ge),be=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:ve,locales:xe,packages:fe,styles:je},Symbol.toStringTag,{value:"Module"})),Ae="auth-app",Se=ae.bind(void 0,Ae);function we(){const t=Se("authentication.AuthService"),r=se(t),n=()=>{t.logout()};return r.kind==="not-authenticated"||r.kind==="pending"?null:e.jsx(S,{colorPalette:"red",onClick:n,children:"Log out"})}function Pe(){return e.jsx(oe,{errorFallback:Ie,children:e.jsxs(z,{p:5,maxWidth:"xl",children:[e.jsx(R,{as:"h1",children:"Authenticated"}),"This is the actual content of the app. Authentication was successful.",e.jsx(ie,{pt:5,flexDirection:"row",justifyContent:"center",children:e.jsx(we,{})})]})})}function Ie(t){return e.jsxs(e.Fragment,{children:[e.jsx(M,{margin:2,color:"red",children:t.error.message}),e.jsx(S,{margin:2,onClick:()=>window.location.reload(),children:"reload"})]})}const ye=N({component:Pe,appMetadata:be});customElements.define("auth-app",ye);
