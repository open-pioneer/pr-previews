var d=n=>{throw TypeError(n)};var l=(n,e,t)=>e.has(n)||d("Cannot "+t);var u=(n,e,t)=>(l(n,e,"read from private field"),t?t.call(n):e.get(n)),m=(n,e,t)=>e.has(n)?d("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),h=(n,e,t,i)=>(l(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),x=(n,e,t)=>(l(n,e,"access private method"),t);import{c as T,a as A,r as f,j as s,V as b,H as E,b as y}from"./BMJNq4QBB6Gl.js";import{u as j}from"./RDYnvDkk14QY.js";import{C as z}from"./CRzx9rnfYly0.js";import{T as C}from"./BK8dm6Y77gOg.js";import{B as w}from"./CaDGJ8LO8gzV.js";const p=Symbol("EventEmitterState");class M{[p]=new q;on(e,t){return this[p].on(e,{listener:t})}once(e,t){return this[p].on(e,{listener:t,once:!0})}emit(e,...t){this[p].emit(e,t[0])}}class q{handlers=new Map;on(e,t){let i=this.handlers.get(e);return i||(i=new Set,this.handlers.set(e,i)),i.add(t),{destroy(){t.removed=!0,i?.delete(t),i=void 0}}}emit(e,t){const i=this.handlers.get(e);if(!i)return;const c=[...i];for(const r of c)r.removed||(r.once&&(r.removed=!0,i.delete(r)),r.listener(t))}}class I{textService;logger;constructor(e){this.textService=e.references.textService,this.logger=T("api-app:TextApiExtension")}async getApiMethods(){return{changeText:e=>{this.logger.info("Changing text to",JSON.stringify(e)),this.textService.setText(e)}}}}class _ extends M{text="not yet set";setText(e){const t=this.text;this.text=e,this.emit("text-changed",{newText:this.text,oldText:t})}getText(){return this.text}}class k{async getApiMethods(){return{justAnotherApiMethod:()=>{console.log("justAnotherApiMethod")}}}}var o,a,v;class B{constructor({references:e}){m(this,a);m(this,o);h(this,o,e.ctx)}emitEvent(e,t=null){if(e==null)return;if(e instanceof Event){x(this,a,v).call(this,e);return}const i=new CustomEvent(e,{bubbles:!1,cancelable:!1,detail:t});x(this,a,v).call(this,i)}}o=new WeakMap,a=new WeakSet,v=function(e){u(this,o).getHostElement().dispatchEvent(e)};const H={"api-app":{name:"api-app",services:{TextApiExtension:{name:"TextApiExtension",clazz:I,provides:[{name:"integration.ApiExtension",qualifier:void 0}],references:{textService:{name:"api-app.TextService",qualifier:void 0,all:!1}}},TextService:{name:"TextService",clazz:_,provides:[{name:"api-app.TextService",qualifier:void 0}],references:{}},SecondApiExtension:{name:"SecondApiExtension",clazz:k,provides:[{name:"integration.ApiExtension",qualifier:void 0}],references:{}}},ui:{references:[{name:"api-app.TextService",qualifier:void 0,all:!1},{name:"integration.ExternalEventService",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/integration":{name:"@open-pioneer/integration",services:{ExternalEventServiceImpl:{name:"ExternalEventServiceImpl",clazz:B,provides:[{name:"integration.ExternalEventService",qualifier:void 0}],references:{ctx:{name:"runtime.ApplicationContext",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}}},P="",N=[];function R(n){throw new Error(`Unsupported locale: '${n}'`)}const U=A(P),V=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:R,locales:N,packages:H,styles:U},Symbol.toStringTag,{value:"Module"})),D="api-app",g=j.bind(void 0,D);function G(){const n=g("integration.ExternalEventService"),e=()=>{n.emitEvent("my-custom-event",{data:"my-event-data"})},t=g("api-app.TextService"),[i,c]=f.useState("");return f.useEffect(()=>{c(t.getText());const r=t.on("text-changed",S=>{c(S.newText)});return()=>r.destroy()},[t]),s.jsx(z,{maxWidth:"xl",children:s.jsxs(b,{children:[s.jsx(E,{size:"md",children:"Emitting Events"}),s.jsx(C,{children:"Click this button to emit a browser event:"}),s.jsx(w,{onClick:e,children:"Emit Event"}),s.jsx(E,{size:"md",pt:20,children:"Reacting to API calls from the host site"}),s.jsxs("div",{children:["Current text: ",i]})]})})}const J=y({component:G,appMetadata:V});customElements.define("api-app",J);
