import{aC as x,aD as q,r as o,am as C,aE as E,aF as R,aG as k}from"./DkSnucxBg0oT.js";var F=x(t=>t),g=t=>t?.constructor.name==="Array",A=(t,e)=>{if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!l(t[n],e[n]))return!1;return!0},l=(t,e)=>{if(Object.is(t,e))return!0;if(t==null&&e!=null||t!=null&&e==null)return!1;if(typeof t?.isEqual=="function"&&typeof e?.isEqual=="function")return t.isEqual(e);if(typeof t=="function"&&typeof e=="function")return t.toString()===e.toString();if(g(t)&&g(e))return A(Array.from(t),Array.from(e));if(typeof t!="object"||typeof e!="object")return!1;const n=Object.keys(e??Object.create(null)),s=n.length;for(let r=0;r<s;r++)if(!Reflect.has(t,n[r]))return!1;for(let r=0;r<s;r++){const c=n[r];if(!l(t[c],e[c]))return!1}return!0},O=Function.prototype.toString;O.call(Object);function S(t){if(!M(t)||t===void 0)return t;const e=Reflect.ownKeys(t).filter(s=>typeof s=="string"),n={};for(const s of e){const r=t[s];r!==void 0&&(n[s]=S(r))}return n}var M=t=>t&&typeof t=="object"&&t.constructor===Object;function j(t,e){const n=o.useRef(!1),s=o.useRef(!1);o.useEffect(()=>{if(n.current&&s.current)return t();s.current=!0},e),o.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[])}var w=q("__zag__targetCache",()=>new WeakMap);function v(t,e){const{actions:n,context:s,sync:r}=e??{},c=o.useRef(void 0),u=o.useRef(void 0),y=o.useSyncExternalStore(o.useCallback(a=>C(t.state,a,r),[r]),()=>{const a=E(t.state);try{if(c.current&&u.current&&!R(c.current,a,u.current,new WeakMap))return c.current}catch{}return a},()=>E(t.state));t.setOptions({actions:n});const i=o.useMemo(()=>S(s??{}),[s]);j(()=>{const a=Object.entries(i),d=t.contextSnapshot??{};a.map(([f,h])=>({key:f,curr:h,prev:d[f],equal:l(d[f],h)})).every(({equal:f})=>f)||t.setContext(i)},[i]);const p=new WeakMap;o.useEffect(()=>{c.current=y,u.current=p});const m=o.useMemo(()=>new WeakMap,[]);return k(y,p,m,w)}function I(t){return[v(t),t.send]}function _(t){const e=o.useRef(void 0);return e.current||(e.current={v:t()}),e.current.v}var W=typeof document<"u"?o.useLayoutEffect:o.useEffect;function z(t,e){const{state:n,context:s}=e??{},r=_(()=>{const u=typeof t=="function"?t():t;return s&&u.setContext(s),u._created(),u}),c=o.useRef(void 0);return W(()=>{const u=n??c.current;return r.start(u),()=>{r.stop()}},[]),r}function D(t,e){const n=z(t,e);return[v(n,e),n.send,n]}export{I as a,F as n,D as u};
