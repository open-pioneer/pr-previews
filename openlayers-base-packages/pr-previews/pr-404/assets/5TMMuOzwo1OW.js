const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./hgpOibJb62yE.js","./CmsKOCeNyeyo.js","./COqgV6NuVY8P.js","./B_v8iqUKZusO.js","./D3OchF5tz_JL.js","./B7Yu7PJrmlVj.js","./B1EYIkmopxze.js","./Cz043qeMr32Q.js","./DyN_bq02jTYT.js","./BQcCgYBPITKg.js","./ICvFkUXNF0VB.js","./CU8oifTzXOca.js","./BCNjkw9XwAxH.js"])))=>i.map(i=>d[i]);
var Pn=Object.defineProperty;var _t=i=>{throw TypeError(i)};var Fn=(i,e,t)=>e in i?Pn(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var S=(i,e,t)=>Fn(i,typeof e!="symbol"?e+"":e,t),Qe=(i,e,t)=>e.has(i)||_t("Cannot "+t);var p=(i,e,t)=>(Qe(i,e,"read from private field"),t?t.call(i):e.get(i)),b=(i,e,t)=>e.has(i)?_t("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),M=(i,e,t,n)=>(Qe(i,e,"write to private field"),n?n.call(i,t):e.set(i,t),t),Q=(i,e,t)=>(Qe(i,e,"access private method"),t);import{h as dt,u as Bt,o as $t,k as Wt,j as d,g as z,s as Ln,t as Tn,r as _,v as ye,w as St,x as In,y as An,z as Rn,i as De,c as fe,d as zt,B as k,C as vt,b as Kt,D as Nn,G as On,H as qt,V as kn,p as jn,I as Dn}from"./D3OchF5tz_JL.js";import{I as A,aD as Gn,b6 as Vn,b7 as Hn,b8 as Un,aO as Bn,aW as $n,b9 as Wn,ba as zn,K as Kn,bb as qn,r as qe,T as Yn,bc as Xn,s as Jn,bd as Zn,be as Qn,bf as es,bg as Yt,bh as ts,bi as ns,a as me,b as Ye,aK as Ge,bj as xt,bk as se,a9 as Et,bl as et,a$ as de,at as bt,bm as Oe,p as N,bn as D,bo as wt,bp as O,bq as Ve,br as ss,bs as is,z as rs,bt as it,bu as os,bv as Xt,aC as Jt,bw as as,bx as cs,by as ls,bz as Mt,bA as us,bB as Ct,bC as ds,bD as Pt,j as W,b0 as ht,bE as Zt,bF as hs,b1 as gs,f as gt,u as ne,aY as X,i as J,aZ as fs,b4 as Xe,bG as ms,as as He,bH as ps,bI as ys,c as Ue,am as Se,C as _s,F as rt,bJ as Ft,bK as Ss,bL as Lt,k as Tt}from"./B_v8iqUKZusO.js";import{X as Qt,p as w,m as E,k as m,r as x,l as T,n as ft,o as ot,q,s as vs,t as xs,u as Es,v as bs}from"./QMSP2AZvqaWT.js";import{G as en,a as Z,i as ws,g as U,s as tn}from"./COqgV6NuVY8P.js";import{a as Ms}from"./B7Yu7PJrmlVj.js";import{D as nn,S as Cs,I as Ps,c as Fs,a as Ls}from"./Om1O93oaKd-X.js";import{u as Y}from"./Cz043qeMr32Q.js";import{T as he,L as Ts}from"./BCNjkw9XwAxH.js";import{c as sn}from"./ICvFkUXNF0VB.js";import{L as at}from"./B1EYIkmopxze.js";import{u as rn,F as Be}from"./DyN_bq02jTYT.js";import{s as Is,F as $e}from"./8OjDbEtI8YHq.js";import{H as ct}from"./DgM8HGIU7A1c.js";import{_ as As}from"./CmsKOCeNyeyo.js";import{F as Rs}from"./CU8oifTzXOca.js";const mt=dt(function(e,t){const{htmlSize:n,...s}=e,r=Bt("Input",s),a=$t(s),o=rn(a),c=Wt("chakra-input",e.className);return d.jsx(z.input,{size:n,...o,__css:r.field,ref:t,className:c})});mt.displayName="Input";mt.id="Input";const on=dt(function(e,t){const{children:n,placeholder:s,className:r,...a}=e;return d.jsxs(z.select,{...a,ref:t,className:Wt("chakra-select",r),children:[s&&d.jsx("option",{value:"",children:s}),n]})});on.displayName="SelectField";const pt=dt((i,e)=>{const t=Bt("Select",i),{rootProps:n,placeholder:s,icon:r,color:a,height:o,h:c,minH:u,minHeight:l,iconColor:h,iconSize:g,...f}=$t(i),[y,v]=Is(f,Tn),C=rn(v),j={width:"100%",height:"fit-content",position:"relative",color:a},G={paddingEnd:"2rem",...t.field,_focus:{zIndex:"unset",...t.field?._focus}};return d.jsxs(z.div,{className:"chakra-select__wrapper",__css:j,...y,...n,children:[d.jsx(on,{ref:e,height:c??o,minH:u??l,placeholder:s,...C,__css:G,children:i.children}),d.jsx(an,{"data-disabled":Ln(C.disabled),...(h||a)&&{color:h||a},__css:t.icon,...g&&{fontSize:g},children:r})]})});pt.displayName="Select";const Ns=i=>d.jsx("svg",{viewBox:"0 0 24 24",...i,children:d.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),Os=z("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),an=i=>{const{children:e=d.jsx(Ns,{}),...t}=i,n=_.cloneElement(e,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return d.jsx(Os,{...t,className:"chakra-select__icon-wrapper",children:_.isValidElement(e)?n:null})};an.displayName="SelectIcon";function ks(i,e){const t=i??"bottom";return{"top-start":{ltr:"top-left",rtl:"top-right"},"top-end":{ltr:"top-right",rtl:"top-left"},"bottom-start":{ltr:"bottom-left",rtl:"bottom-right"},"bottom-end":{ltr:"bottom-right",rtl:"bottom-left"}}[t]?.[e]??t}function js(i,e){const t=s=>({...e,...s,position:ks(s?.position??e?.position,i)}),n=s=>{const r=t(s),a=In(r);return ye.notify(a,r)};return n.update=(s,r)=>{ye.update(s,t(r))},n.promise=(s,r)=>{const a=n({...r.loading,status:"loading",duration:null});s.then(o=>n.update(a,{status:"success",duration:5e3,...St(r.success,o)})).catch(o=>n.update(a,{status:"error",duration:5e3,...St(r.error,o)}))},n.closeAll=ye.closeAll,n.close=ye.close,n.isActive=ye.isActive,n}function Ds(i){const{theme:e}=An(),t=Rn();return _.useMemo(()=>js(e.direction,{...t,...i}),[i,e.direction,t])}const I=[null,"http://www.opengis.net/ows/1.1"],Gs=E(I,{ServiceIdentification:m(ui),ServiceProvider:m(hi),OperationsMetadata:m(ci)});class Vs extends Qt{constructor(){super()}readFromNode(e){const t=w({},Gs,e,[]);return t||null}}const Hs=E(I,{DeliveryPoint:m(x),City:m(x),AdministrativeArea:m(x),PostalCode:m(x),Country:m(x),ElectronicMailAddress:m(x)}),Us=E(I,{Value:T(gi)}),Bs=E(I,{AllowedValues:m(ti)}),$s=E(I,{Phone:m(li),Address:m(ei)}),Ws=E(I,{HTTP:m(oi)}),zs=E(I,{Get:T(ri),Post:void 0}),Ks=E(I,{DCP:m(ii)}),qs=E(I,{Operation:ai}),Ys=E(I,{Voice:m(x),Facsimile:m(x)}),Xs=E(I,{Constraint:T(ni)}),Js=E(I,{IndividualName:m(x),PositionName:m(x),ContactInfo:m(si)}),Zs=E(I,{Abstract:m(x),AccessConstraints:m(x),Fees:m(x),Title:m(x),ServiceTypeVersion:m(x),ServiceType:m(x)}),Qs=E(I,{ProviderName:m(x),ProviderSite:m(ft),ServiceContact:m(di)});function ei(i,e){return w({},Hs,i,e)}function ti(i,e){return w({},Us,i,e)}function ni(i,e){const t=i.getAttribute("name");if(t)return w({name:t},Bs,i,e)}function si(i,e){return w({},$s,i,e)}function ii(i,e){return w({},Ws,i,e)}function ri(i,e){const t=ft(i);if(t)return w({href:t},Xs,i,e)}function oi(i,e){return w({},zs,i,e)}function ai(i,e){const t=i.getAttribute("name"),n=w({},Ks,i,e);if(!n)return;const s=e[e.length-1];s[t]=n}function ci(i,e){return w({},qs,i,e)}function li(i,e){return w({},Ys,i,e)}function ui(i,e){return w({},Zs,i,e)}function di(i,e){return w({},Js,i,e)}function hi(i,e){return w({},Qs,i,e)}function gi(i,e){return x(i)}const B=[null,"http://www.opengis.net/wmts/1.0"],pe=[null,"http://www.opengis.net/ows/1.1"],fi=E(B,{Contents:m(Mi)});class mi extends Qt{constructor(){super(),this.owsParser_=new Vs}readFromNode(e){let t=e.getAttribute("version");t&&(t=t.trim());let n=this.owsParser_.readFromNode(e);return n?(n.version=t,n=w(n,fi,e,[]),n||null):null}}const pi=E(B,{Layer:T(Ci),TileMatrixSet:T(Pi)}),yi=E(B,{Style:T(Fi),Format:T(x),TileMatrixSetLink:T(Li),Dimension:T(Ti),ResourceURL:T(Ii)},E(pe,{Title:m(x),Abstract:m(x),WGS84BoundingBox:m(ln),BoundingBox:T(Ai),Identifier:m(x)})),_i=E(B,{LegendURL:T(Ri)},E(pe,{Title:m(x),Identifier:m(x)})),Si=E(B,{TileMatrixSet:m(x),TileMatrixSetLimits:m(Oi)}),vi=E(B,{TileMatrixLimits:ot(ki)}),xi=E(B,{TileMatrix:m(x),MinTileRow:m(q),MaxTileRow:m(q),MinTileCol:m(q),MaxTileCol:m(q)}),Ei=E(B,{Default:m(x),Value:T(x)},E(pe,{Identifier:m(x)})),cn=E(pe,{LowerCorner:ot(lt),UpperCorner:ot(lt)}),bi=E(B,{WellKnownScaleSet:m(x),TileMatrix:T(Ni)},E(pe,{SupportedCRS:m(x),Identifier:m(x),BoundingBox:m(ln)})),wi=E(B,{TopLeftCorner:m(lt),ScaleDenominator:m(vs),TileWidth:m(q),TileHeight:m(q),MatrixWidth:m(q),MatrixHeight:m(q)},E(pe,{Identifier:m(x)}));function Mi(i,e){return w({},pi,i,e)}function Ci(i,e){return w({},yi,i,e)}function Pi(i,e){return w({},bi,i,e)}function Fi(i,e){const t=w({},_i,i,e);if(!t)return;const n=i.getAttribute("isDefault")==="true";return t.isDefault=n,t}function Li(i,e){return w({},Si,i,e)}function Ti(i,e){return w({},Ei,i,e)}function Ii(i,e){const t=i.getAttribute("format"),n=i.getAttribute("template"),s=i.getAttribute("resourceType"),r={};return t&&(r.format=t),n&&(r.template=n),s&&(r.resourceType=s),r}function ln(i,e){const t=w([],cn,i,e);if(t.length==2)return A(t)}function Ai(i,e){const t=i.getAttribute("crs"),n=w([],cn,i,e);if(n.length==2)return{extent:A(n),crs:t}}function Ri(i,e){const t={};return t.format=i.getAttribute("format"),t.href=ft(i),t}function lt(i,e){const t=x(i).split(/\s+/);if(!t||t.length!=2)return;const n=+t[0],s=+t[1];if(!(isNaN(n)||isNaN(s)))return[n,s]}function Ni(i,e){return w({},wi,i,e)}function Oi(i,e){return w([],vi,i,e)}function ki(i,e){return w({},xi,i,e)}const F={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Je extends Gn{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+Vn,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(F.ELEMENT,this.handleElementChanged),this.addChangeListener(F.MAP,this.handleMapChanged),this.addChangeListener(F.OFFSET,this.handleOffsetChanged),this.addChangeListener(F.POSITION,this.handlePositionChanged),this.addChangeListener(F.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(F.ELEMENT)}getId(){return this.id}getMap(){return this.get(F.MAP)||null}getOffset(){return this.get(F.OFFSET)}getPosition(){return this.get(F.POSITION)}getPositioning(){return this.get(F.POSITIONING)}handleElementChanged(){Hn(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(this.element?.remove(),Un(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=Bn(e,$n.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(F.ELEMENT,e)}setMap(e){this.set(F.MAP,e)}setOffset(e){this.set(F.OFFSET,e)}setPosition(e){this.set(F.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(F.POSITION))return;const n=this.getRect(t.getTargetElement(),t.getSize()),s=this.getElement(),r=this.getRect(s,[Wn(s),zn(s)]);e=e||{};const a=e.margin===void 0?20:e.margin;if(!Kn(n,r)){const o=r[0]-n[0],c=n[2]-r[2],u=r[1]-n[1],l=n[3]-r[3],h=[0,0];if(o<0?h[0]=o-a:c<0&&(h[0]=Math.abs(c)+a),u<0?h[1]=u-a:l<0&&(h[1]=Math.abs(l)+a),h[0]!==0||h[1]!==0){const g=t.getView().getCenterInternal(),f=t.getPixelFromCoordinateInternal(g);if(!f)return;const y=[f[0]+h[0],f[1]+h[1]],v=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(y),duration:v.duration,easing:v.easing})}}}getRect(e,t){const n=e.getBoundingClientRect(),s=n.left+window.pageXOffset,r=n.top+window.pageYOffset;return[s,r,s+t[0],r+t[1]]}setPositioning(e){this.set(F.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const n=e.getPixelFromCoordinate(t),s=e.getSize();this.updateRenderedPosition(n,s)}updateRenderedPosition(e,t){const n=this.element.style,s=this.getOffset(),r=this.getPositioning();this.setVisible(!0);const a=Math.round(e[0]+s[0])+"px",o=Math.round(e[1]+s[1])+"px";let c="0%",u="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?c="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(c="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?u="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(u="-50%");const l=`translate(${c}, ${u}) translate(${a}, ${o})`;this.rendered.transform_!=l&&(this.rendered.transform_=l,n.transform=l)}getOptions(){return this.options}}const ee=fe("map:WMTSLayer");var re,oe,ae,xe,Ee,be,we,Me,ge,un,dn;class ji extends qn{constructor(t){const n=new Yn;super({...t,olLayer:n});b(this,ge);b(this,re);b(this,oe);b(this,ae);b(this,xe);b(this,Ee);b(this,be);b(this,we,qe());b(this,Me,new AbortController);M(this,re,t.url),M(this,oe,t.name),M(this,xe,n),M(this,ae,t.matrixSet),M(this,be,t.sourceOptions)}get type(){return"wmts"}destroy(){p(this,Me).abort(),super.destroy()}get legend(){return p(this,we).value}get sublayers(){}get layers(){}__attachToMap(t){super.__attachToMap(t),Q(this,ge,un).call(this).then(n=>{const r=new mi().read(n),a=xs(r,{layer:p(this,oe),matrixSet:p(this,ae)});if(!a)throw new Error("Layer was not found in capabilities");const o=new Es({...a,...p(this,be),tileLoadFunction:(l,h)=>{Q(this,ge,dn).call(this,l,h)}});M(this,Ee,o),p(this,xe).setSource(p(this,Ee));const c=o.getStyle(),u=Gi(r,this.name,c);p(this,we).value=u}).catch(n=>{if(De(n)){ee.error(`Layer ${this.name} has been destroyed before fetching the data`);return}ee.error(`Failed fetching WMTS capabilities for Layer ${this.name}`,n)})}get url(){return p(this,re)}get name(){return p(this,oe)}get matrixSet(){return p(this,ae)}}re=new WeakMap,oe=new WeakMap,ae=new WeakMap,xe=new WeakMap,Ee=new WeakMap,be=new WeakMap,we=new WeakMap,Me=new WeakMap,ge=new WeakSet,un=async function(){const t=this.map.__sharedDependencies.httpService;return bs(p(this,re),t,p(this,Me).signal)},dn=async function(t,n){const s=this.map.__sharedDependencies.httpService;try{if(!(t instanceof Xn))throw new Error("Only 'ImageTile' is supported for now.");const r=t.getImage();if(!Di(r))throw new Error("Only <img> tags are supported as tiles for now.");const a=await s.fetch(n);if(!a.ok)throw new Error(`Tile request failed with status ${a.status}.`);const o=await a.blob(),c=URL.createObjectURL(o),u=()=>{URL.revokeObjectURL(c),r.removeEventListener("load",u),r.removeEventListener("error",u)};r.addEventListener("load",u),r.addEventListener("error",u),r.src=c}catch(r){t.setState(Jn.ERROR),De(r)||ee.error("Failed to load tile",r)}};function Di(i){return i.tagName==="IMG"}function Gi(i,e,t){const s=i?.Contents?.Layer;let r=s?.find(u=>u?.Identifier===e);if(!r&&(ee.debug("Failed to find the active layer in WMTS layer capabilities."),r=s?.[0],!r)){ee.debug("No layer in WMTS capabilities - giving up.");return}const a=r.Style;let o=a?.find(u=>u?.Identifier===t);if(!o&&(ee.debug("Failed to find active style in WMTS layer."),o=a?.[0],!o)){ee.debug("No style in WMTS layer capabilities - giving up.");return}return o.LegendURL?.[0]?.href}const Ao=ji,It=0,ve=1,At=[0,0,0,0],ie=[],tt={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class nt extends Jt{constructor(e,t,n){super(e),this.features=t,this.mapBrowserEvent=n}}class Vi extends Zn{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:Qn,this.defaultDeleteCondition_=function(n){return es(n)&&Yt(n)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:ts,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new ns,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new me({source:new Ye({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:Ui(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let t;if(e.features?t=e.features:e.source&&(this.source_=e.source,t=new Ge(this.source_.getFeatures()),this.source_.addEventListener(xt.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(xt.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(se.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(se.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}addFeature_(e){const t=e.getGeometry();if(t){const s=this.SEGMENT_WRITERS_[t.getType()];s&&s(e,t)}const n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(n.getCoordinateFromPixel(this.lastPixel_)),e.addEventListener(Et.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Ge;const n=this.featuresBeingModified_.getArray();for(let s=0,r=t.length;s<r;++s){const a=t[s].feature;a&&!n.includes(a)&&this.featuresBeingModified_.push(a)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new nt(tt.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(Et.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,n=[];t.forEach(function(s){e===s.feature&&n.push(s)});for(let s=n.length-1;s>=0;--s){const r=n[s];for(let a=this.dragSegments_.length-1;a>=0;--a)this.dragSegments_[a][0]===r&&this.dragSegments_.splice(a,1);t.remove(r)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const n=t.getCoordinates(),s={feature:e,geometry:t,segment:[n,n]};this.rBush_.insert(t.getExtent(),s)}writeMultiPointGeometry_(e,t){const n=t.getCoordinates();for(let s=0,r=n.length;s<r;++s){const a=n[s],o={feature:e,geometry:t,depth:[s],index:s,segment:[a,a]};this.rBush_.insert(t.getExtent(),o)}}writeLineStringGeometry_(e,t){const n=t.getCoordinates();for(let s=0,r=n.length-1;s<r;++s){const a=n.slice(s,s+2),o={feature:e,geometry:t,index:s,segment:a};this.rBush_.insert(A(a),o)}}writeMultiLineStringGeometry_(e,t){const n=t.getCoordinates();for(let s=0,r=n.length;s<r;++s){const a=n[s];for(let o=0,c=a.length-1;o<c;++o){const u=a.slice(o,o+2),l={feature:e,geometry:t,depth:[s],index:o,segment:u};this.rBush_.insert(A(u),l)}}}writePolygonGeometry_(e,t){const n=t.getCoordinates();for(let s=0,r=n.length;s<r;++s){const a=n[s];for(let o=0,c=a.length-1;o<c;++o){const u=a.slice(o,o+2),l={feature:e,geometry:t,depth:[s],index:o,segment:u};this.rBush_.insert(A(u),l)}}}writeMultiPolygonGeometry_(e,t){const n=t.getCoordinates();for(let s=0,r=n.length;s<r;++s){const a=n[s];for(let o=0,c=a.length;o<c;++o){const u=a[o];for(let l=0,h=u.length-1;l<h;++l){const g=u.slice(l,l+2),f={feature:e,geometry:t,depth:[o,s],index:l,segment:g};this.rBush_.insert(A(g),f)}}}}writeCircleGeometry_(e,t){const n=t.getCenter(),s={feature:e,geometry:t,index:It,segment:[n,n]},r={feature:e,geometry:t,index:ve,segment:[n,n]},a=[s,r];s.featureSegments=a,r.featureSegments=a,this.rBush_.insert(et(n),s);let o=t;this.rBush_.insert(o.getExtent(),r)}writeGeometryCollectionGeometry_(e,t){const n=t.getGeometriesArray();for(let s=0;s<n.length;++s){const r=n[s],a=this.SEGMENT_WRITERS_[r.getType()];a(e,r)}}createOrUpdateVertexFeature_(e,t,n,s){let r=this.vertexFeature_;return r?r.getGeometry().setCoordinates(e):(r=new de(new bt(e)),this.vertexFeature_=r,this.overlay_.getSource().addFeature(r)),r.set("features",t),r.set("geometries",n),r.set("existing",s),r}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let t;return!e.map.getView().getInteracting()&&e.type==Oe.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=Oe.SINGLECLICK||!this.ignoreNextSingleClick_?t=this.removePoint():t=!0),e.type==Oe.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}findInsertVerticesAndUpdateDragSegments_(e){this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null;const t=this.vertexFeature_;if(!t)return;this.getMap().getView().getProjection();const n=[],s=t.getGeometry().getCoordinates(),r=A([s]),a=this.rBush_.getInExtent(r),o={};a.sort(Hi);for(let c=0,u=a.length;c<u;++c){const l=a[c],h=l.segment;let g=N(l.geometry);const f=l.depth;if(f&&(g+="-"+f.join("-")),o[g]||(o[g]=new Array(2)),l.geometry.getType()==="Circle"&&l.index===ve){const y=Nt(e,l);D(y,s)&&!o[g][0]&&(this.dragSegments_.push([l,0]),o[g][0]=l);continue}if(D(h[0],s)&&!o[g][0]){this.dragSegments_.push([l,0]),o[g][0]=l;continue}if(D(h[1],s)&&!o[g][1]){if(o[g][0]&&o[g][0].index===0){let y=l.geometry.getCoordinates();switch(l.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":y=y[f[1]];case"Polygon":if(l.index!==y[f[0]].length-2)continue;break}}this.dragSegments_.push([l,1]),o[g][1]=l;continue}N(h)in this.vertexSegments_&&!o[g][0]&&!o[g][1]&&n.push(l)}return n}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([r])=>r));const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],n=[],s=[];for(let r=0,a=this.dragSegments_.length;r<a;++r){const o=this.dragSegments_[r],c=o[0],u=c.feature;n.includes(u)||n.push(u);const l=c.geometry;s.includes(l)||s.push(l);const h=c.depth;let g;const f=c.segment,y=o[1];for(;t.length<l.getStride();)t.push(f[y][t.length]);switch(l.getType()){case"Point":g=t,f[0]=t,f[1]=t;break;case"MultiPoint":g=l.getCoordinates(),g[c.index]=t,f[0]=t,f[1]=t;break;case"LineString":g=l.getCoordinates(),g[c.index+y]=t,f[y]=t;break;case"MultiLineString":g=l.getCoordinates(),g[h[0]][c.index+y]=t,f[y]=t;break;case"Polygon":g=l.getCoordinates(),g[h[0]][c.index+y]=t,f[y]=t;break;case"MultiPolygon":g=l.getCoordinates(),g[h[1]][h[0]][c.index+y]=t,f[y]=t;break;case"Circle":const v=l;if(f[0]=t,f[1]=t,c.index===It)this.changingFeature_=!0,v.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0,e.map.getView().getProjection();let C=wt(O(v.getCenter()),O(t));v.setRadius(C),this.changingFeature_=!1}break}g&&this.setGeometryCoordinates_(l,g)}this.createOrUpdateVertexFeature_(t,n,s,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate,n=this.findInsertVerticesAndUpdateDragSegments_(t);if(n?.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,n),this.vertexFeature_)){const s=this.vertexFeature_.getGeometry().getCoordinates();for(let r=n.length-1;r>=0;--r)this.insertVertex_(n[r],s);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const n=this.dragSegments_[t][0],s=n.geometry;if(s.getType()==="Circle"){const r=s,a=r.getCenter(),o=n.featureSegments[0],c=n.featureSegments[1];o.segment[0]=a,o.segment[1]=a,c.segment[0]=a,c.segment[1]=a,this.rBush_.update(et(a),o);let u=r;this.rBush_.update(u.getExtent(),c)}else this.rBush_.update(A(n.segment),n)}return this.featuresBeingModified_&&(this.dispatchEvent(new nt(tt.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.coordinate)}handlePointerAtPixel_(e){const t=this.getMap(),n=t.getPixelFromCoordinate(e);t.getView().getProjection();const s=function(o,c){return Rt(e,o)-Rt(e,c)};let r,a;if(this.hitDetection_){const o=typeof this.hitDetection_=="object"?c=>c===this.hitDetection_:void 0;t.forEachFeatureAtPixel(n,(c,u,l)=>{l&&l.getType()==="Point"&&(l=new bt(Ve(l.getCoordinates())));const h=l||c.getGeometry();if(h&&h.getType()==="Point"&&c instanceof de&&this.features_.getArray().includes(c)){a=h;const g=c.getGeometry().getFlatCoordinates().slice(0,2);r=[{feature:c,geometry:a,segment:[g,g]}]}return!0},{layerFilter:o})}if(!r){const o=ss(et(e,At)),c=t.getView().getResolution()*this.pixelTolerance_,u=is(rs(o,c,At));r=this.rBush_.getInExtent(u)}if(r&&r.length>0){const o=r.sort(s)[0],c=o.segment;let u=Nt(e,o);const l=t.getPixelFromCoordinate(u);let h=wt(n,l);if(a||h<=this.pixelTolerance_){const g={};if(g[N(c)]=!0,this.snapToPointer_||(this.delta_[0]=u[0]-e[0],this.delta_[1]=u[1]-e[1]),o.geometry.getType()==="Circle"&&o.index===ve)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u,[o.feature],[o.geometry],this.snappedToVertex_);else{const f=t.getPixelFromCoordinate(c[0]),y=t.getPixelFromCoordinate(c[1]),v=it(l,f),C=it(l,y);if(h=Math.sqrt(Math.min(v,C)),this.snappedToVertex_=h<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(u=v>C?c[1]:c[0]),this.createOrUpdateVertexFeature_(u,[o.feature],[o.geometry],this.snappedToVertex_);const j={};j[N(o.geometry)]=!0;for(let G=1,P=r.length;G<P;++G){const L=r[G].segment;if(D(c[0],L[0])&&D(c[1],L[1])||D(c[0],L[1])&&D(c[1],L[0])){const R=N(r[G].geometry);R in j||(j[R]=!0,g[N(L)]=!0)}else break}}this.vertexSegments_=g;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const n=e.segment,s=e.feature,r=e.geometry,a=e.depth,o=e.index;let c;for(;t.length<r.getStride();)t.push(0);switch(r.getType()){case"MultiLineString":c=r.getCoordinates(),c[a[0]].splice(o+1,0,t);break;case"Polygon":c=r.getCoordinates(),c[a[0]].splice(o+1,0,t);break;case"MultiPolygon":c=r.getCoordinates(),c[a[1]][a[0]].splice(o+1,0,t);break;case"LineString":c=r.getCoordinates(),c.splice(o+1,0,t);break;default:return!1}this.setGeometryCoordinates_(r,c);const u=this.rBush_;u.remove(e),this.updateSegmentIndices_(r,o,a,1);const l={segment:[n[0],t],feature:s,geometry:r,depth:a,index:o};u.insert(A(l.segment),l),this.dragSegments_.push([l,1]);const h={segment:[t,n[1]],feature:s,geometry:r,depth:a,index:o+1};return u.insert(A(h.segment),h),this.dragSegments_.push([h,0]),!0}updatePointer_(e){return e&&this.findInsertVerticesAndUpdateDragSegments_(e),this.vertexFeature_?.getGeometry().getCoordinates()}getPoint(){const e=this.vertexFeature_?.getGeometry().getCoordinates();return e?Ve(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(n=>n.getType()==="Circle"||n.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(A([e])).some(({segment:n})=>D(n[0],e)||D(n[1],e))}removePoint(e){if(e&&(e=O(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=Oe.POINTERDRAG){const t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_.map(([s])=>s));const n=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new nt(tt.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,n}return!1}removeVertex_(){const e=this.dragSegments_,t={};let n=!1,s,r,a,o,c,u,l,h,g,f,y;for(c=e.length-1;c>=0;--c)a=e[c],f=a[0],y=N(f.feature),f.depth&&(y+="-"+f.depth.join("-")),y in t||(t[y]={}),a[1]===0?(t[y].right=f,t[y].index=f.index):a[1]==1&&(t[y].left=f,t[y].index=f.index+1);for(y in t){switch(g=t[y].right,l=t[y].left,u=t[y].index,h=u-1,l!==void 0?f=l:f=g,h<0&&(h=0),o=f.geometry,r=o.getCoordinates(),s=r,n=!1,o.getType()){case"MultiLineString":r[f.depth[0]].length>2&&(r[f.depth[0]].splice(u,1),n=!0);break;case"LineString":r.length>2&&(r.splice(u,1),n=!0);break;case"MultiPolygon":s=s[f.depth[1]];case"Polygon":s=s[f.depth[0]],s.length>4&&(u==s.length-1&&(u=0),s.splice(u,1),n=!0,u===0&&(s.pop(),s.push(s[0]),h=s.length-1));break}if(n){this.setGeometryCoordinates_(o,r);const v=[];if(l!==void 0&&(this.rBush_.remove(l),v.push(l.segment[0])),g!==void 0&&(this.rBush_.remove(g),v.push(g.segment[1])),l!==void 0&&g!==void 0){const C={depth:f.depth,feature:f.feature,geometry:f.geometry,index:h,segment:v};this.rBush_.insert(A(C.segment),C)}this.updateSegmentIndices_(o,u,f.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return n}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(n=>n.getType()==="Circle"||n.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(A([e])).some(({segment:n})=>!(D(n[0],e)||D(n[1],e)))}insertPoint(e){const t=e?O(e,this.getMap().getView().getProjection()):this.vertexFeature_?.getGeometry().getCoordinates();return t?this.findInsertVerticesAndUpdateDragSegments_(t).reduce((s,r)=>s||this.insertVertex_(r,t),!1):!1}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,n,s){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(n===void 0||r.depth===void 0||os(r.depth,n))&&r.index>t&&(r.index+=s)})}}function Hi(i,e){return i.index-e.index}function Rt(i,e,t){const n=e.geometry;if(n.getType()==="Circle"){let r=n;if(e.index===ve){const a=it(r.getCenter(),O(i)),o=Math.sqrt(a)-r.getRadius();return o*o}}const s=O(i);return ie[0]=O(e.segment[0]),ie[1]=O(e.segment[1]),cs(s,ie)}function Nt(i,e,t){const n=e.geometry;if(n.getType()==="Circle"&&e.index===ve)return Ve(n.getClosestPoint(O(i)));const s=O(i);return ie[0]=O(e.segment[0]),ie[1]=O(e.segment[1]),Ve(as(s,ie))}function Ui(){const i=Xt();return function(e,t){return i.Point}}const Bi={SELECT:"select"};class $i extends Jt{constructor(e,t,n,s){super(e),this.selected=t,this.deselected=n,this.mapBrowserEvent=s}}const ke={};class hn extends ls{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:Yt,this.addCondition_=e.addCondition?e.addCondition:Mt,this.removeCondition_=e.removeCondition?e.removeCondition:Mt,this.toggleCondition_=e.toggleCondition?e.toggleCondition:us,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:Ct,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:Wi(),this.features_=e.features||new Ge;let t;if(e.layers)if(typeof e.layers=="function")t=e.layers;else{const n=e.layers;t=function(s){return n.includes(s)}}else t=Ct;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[N(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[N(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(se.ADD,this.boundAddFeature_),this.features_.addEventListener(se.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(se.ADD,this.boundAddFeature_),this.features_.removeEventListener(se.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const n=this.getMap().getAllLayers().find(function(s){if(s instanceof me&&s.getSource()&&s.getSource().hasFeature(t))return s});n&&this.addFeatureLayerAssociation_(t,n)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const t=N(e);t in ke||(ke[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let s=t.length-1;s>=0;--s){const r=t[s];if(r!==this&&r instanceof hn&&r.getStyle()&&r.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(r.getStyle());return}}const n=N(e);e.setStyle(ke[n]),delete ke[n]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[N(e)]}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),n=this.removeCondition_(e),s=this.toggleCondition_(e),r=!t&&!n&&!s,a=e.map,o=this.getFeatures(),c=[],u=[];if(r){ds(this.featureLayerAssociation_),a.forEachFeatureAtPixel(e.pixel,(l,h)=>{if(!(!(l instanceof de)||!this.filter_(l,h)))return this.addFeatureLayerAssociation_(l,h),u.push(l),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let l=o.getLength()-1;l>=0;--l){const h=o.item(l),g=u.indexOf(h);g>-1?u.splice(g,1):(o.remove(h),c.push(h))}u.length!==0&&o.extend(u)}else{a.forEachFeatureAtPixel(e.pixel,(l,h)=>{if(!(!(l instanceof de)||!this.filter_(l,h)))return(t||s)&&!o.getArray().includes(l)?(this.addFeatureLayerAssociation_(l,h),u.push(l)):(n||s)&&o.getArray().includes(l)&&(c.push(l),this.removeFeatureLayerAssociation_(l)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let l=c.length-1;l>=0;--l)o.remove(c[l]);o.extend(u)}return(u.length>0||c.length>0)&&this.dispatchEvent(new $i(Bi.SELECT,u,c,e)),!0}}function Wi(){const i=Xt();return Pt(i.Polygon,i.LineString),Pt(i.GeometryCollection,i.LineString),function(e){return e.getGeometry()?i[e.getGeometry().getType()]:null}}async function zi(i,e,t,n){const r=n.getCode().replace("EPSG:","http://www.opengis.net/def/crs/EPSG/0/"),a=await i.fetch(e,{method:"POST",body:JSON.stringify({type:"Feature",properties:{},geometry:t}),headers:{"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${r}>`}});if(!a||!a.ok||a.status!==201)throw new Error("Request failed: "+a.status);const o=a.headers.get("location");if(!o)throw new Error("Request failed: no Location response header");const c=o.substring(o.lastIndexOf("/")+1);return Promise.resolve(c)}async function Ki(i,e,t,n,s){const a=s.getCode().replace("EPSG:","http://www.opengis.net/def/crs/EPSG/0/"),o=new URL(`${e.toString()}/${t}`),c=await i.fetch(o,{method:"PATCH",body:JSON.stringify({type:"Feature",properties:{},geometry:n}),headers:{"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${a}>`}});if(!c||!c.ok||c.status!==204)throw new Error("Request failed: "+c.status);return Promise.resolve(t)}function gn(i,e){const t=document.createElement("div");t.className="editing-tooltip editing-tooltip-hidden",t.role="tooltip";const n=document.createElement("span");n.textContent=e,t.appendChild(n);const s=new Je({element:t,offset:[15,0],positioning:"center-left"}),r=i.on("pointermove",a=>{a.dragging||s.setPosition(a.coordinate)});return i.addOverlay(s),{destroy(){W(r),i.removeOverlay(s)},setVisible(a){t.classList.toggle("editing-tooltip-hidden",!a)},setText(a){n.textContent=a}}}function fn(i){let e=Ot(i.polygon);Array.isArray(e)&&(e=e[0]);let t=Ot(i.vertex);Array.isArray(t)&&(t=t[0]);const n=[];return e&&n.push(e),t&&(t.setGeometry(qi),n.push(t)),n}const qi=i=>{if(i){const e=i.getGeometry();if(e&&e.getType()==="Polygon"){const t=e.getCoordinates()[0];if(t)return new Ms(t)}}},Ot=i=>{const e=new de,n=new me({style:i}).getStyleFunction();if(!n)throw new Error("can't retrieve style function");const s=n(e,1);if(!s)throw new Error("can't retrieve styles from feature style function");return Array.isArray(s)&&s.length?s.length>1?s:s[0]:s},Yi=fe("editing:EditingCreateWorkflowImpl");var $;class Xi{constructor(e){b(this,$);S(this,"_httpService");S(this,"_intl");S(this,"_map");S(this,"_polygonStyle");S(this,"_vertexStyle");S(this,"_state");S(this,"_editLayerURL");S(this,"_featureId");S(this,"_editingSource");S(this,"_editingLayer");S(this,"_drawInteraction");S(this,"_olMap");S(this,"_tooltip");S(this,"_enterHandler");S(this,"_escapeHandler");S(this,"_error");S(this,"_interactionListener");S(this,"_mapListener");this._httpService=e.httpService,this._intl=e.intl,this._polygonStyle=e.polygonStyle,this._vertexStyle=e.vertexStyle,this._map=e.map,this._olMap=e.map.olMap,this._state=qe("active:initialized"),this._editLayerURL=e.ogcApiFeatureLayerUrl,this._editingSource=new Ye,this._editingLayer=new me({source:this._editingSource,zIndex:ht,properties:{name:"editing-layer"}}),this._drawInteraction=new nn({source:this._editingSource,type:"Polygon",style:fn({polygon:this._polygonStyle,vertex:this._vertexStyle})}),this._tooltip=gn(this._olMap,this._intl.formatMessage({id:"create.tooltip.begin"})),this._enterHandler=t=>{if((t.code==="Enter"||t.code==="NumpadEnter")&&t.target===this._olMap.getTargetElement()){const n=this._drawInteraction.getOverlay().getSource()?.getFeatures()??[];n[0]&&n[0].getGeometry().getCoordinates()[0].length>4&&this.triggerSave()}},this._escapeHandler=t=>{t.code==="Escape"&&t.target===this._olMap.getTargetElement()&&this.reset()},this._interactionListener=[],this._mapListener=[],this._start()}getDrawInteraction(){return this._drawInteraction}getState(){return this._state.value}_setState(e){this._state.value=e}_save(e){this._setState("active:saving");const t=this._editLayerURL,n=e.getGeometry();if(!n){this._destroy(),this._error=new Error("no geometry available"),p(this,$)?.reject(this._error);return}const s=this._olMap.getView().getProjection(),a=new en({dataProjection:s}).writeGeometryObject(n,{rightHanded:!0,decimals:10});this._olMap.removeInteraction(this._drawInteraction),this._tooltip.destroy(),zi(this._httpService,t,a,s).then(o=>{this._featureId=o,this._destroy(),p(this,$)?.resolve({featureId:this._featureId})}).catch(o=>{Yi.error(o),this._destroy(),this._error=new Error("Failed to save feature",{cause:o}),p(this,$)?.reject(this._error)})}_start(){this._olMap.addLayer(this._editingLayer),this._olMap.addInteraction(this._drawInteraction);const e=Zt(()=>{const s=this._map.container;if(s)return s.addEventListener("keydown",this._enterHandler,!1),s.addEventListener("keydown",this._escapeHandler,!1),()=>{s.removeEventListener("keydown",this._enterHandler),s.removeEventListener("keydown",this._escapeHandler)}});this._tooltip.setVisible(!0);const t=this._drawInteraction.on("drawstart",()=>{this._setState("active:drawing"),this._tooltip.setText(this._intl.formatMessage({id:"create.tooltip.continue"}))}),n=this._drawInteraction.on("drawend",s=>{const r=s.feature;if(!r){this._destroy(),this._error=new Error("no feature available"),p(this,$)?.reject(this._error);return}this._save(r)});this._interactionListener.push(t,n),this._mapListener.push(e)}reset(){this._drawInteraction.abortDrawing(),this._tooltip.setText(this._intl.formatMessage({id:"create.tooltip.begin"})),this._setState("active:initialized")}stop(){this._destroy(),p(this,$)?.resolve(void 0)}_destroy(){this._olMap.removeLayer(this._editingLayer),this._olMap.removeInteraction(this._drawInteraction),this._tooltip.destroy(),this._interactionListener.forEach(e=>{W(e)}),this._mapListener.forEach(e=>{e.destroy()}),this._setState("destroyed")}triggerSave(){this._drawInteraction.finishDrawing()}whenComplete(){return this._state.value==="destroyed"?this._error?Promise.reject(this._error):this._featureId?Promise.resolve({featureId:this._featureId}):Promise.resolve(void 0):(p(this,$)??M(this,$,zt())).promise}}$=new WeakMap;var V;class Ji{constructor(e){b(this,V);S(this,"_httpService");S(this,"_intl");S(this,"_map");S(this,"_polygonStyle");S(this,"_vertexStyle");S(this,"_state");S(this,"_editLayerURL");S(this,"_featureId");S(this,"_initialFeature");S(this,"_editFeature");S(this,"_editingSource");S(this,"_editingLayer");S(this,"_modifyInteraction");S(this,"_olMap");S(this,"_tooltip");S(this,"_enterHandler");S(this,"_escapeHandler");S(this,"_error");S(this,"_interactionListener");S(this,"_mapListener");this._httpService=e.httpService,this._intl=e.intl,this._polygonStyle=e.polygonStyle,this._vertexStyle=e.vertexStyle,this._map=e.map,this._olMap=e.map.olMap,this._state=qe("active:initialized"),this._editLayerURL=e.ogcApiFeatureLayerUrl,this._initialFeature=e.feature.clone(),this._initialFeature.setId(e.feature.getId()),this._editFeature=e.feature.clone(),this._editFeature.setId(e.feature.getId()),this._editFeature.setStyle(fn({polygon:this._polygonStyle,vertex:this._vertexStyle})),this._editingSource=new Ye({features:new Ge([this._editFeature])}),this._editingLayer=new me({source:this._editingSource,zIndex:ht,properties:{name:"editing-layer"}}),this._modifyInteraction=new Vi({source:this._editingSource}),this._tooltip=gn(this._olMap,this._intl.formatMessage({id:"create.tooltip.deselect"})),this._enterHandler=t=>{if((t.code==="Enter"||t.code==="NumpadEnter")&&t.target===this._olMap.getTargetElement()){const n=this._editingSource.getFeatures()[0];if(!n)throw Error("no updated feature found");this._save(n)}},this._escapeHandler=t=>{t.code==="Escape"&&t.target===this._olMap.getTargetElement()&&this.reset()},this._interactionListener=[],this._mapListener=[],this._start()}getModifyInteraction(){return this._modifyInteraction}getState(){return this._state.value}_setState(e){this._state.value=e}_save(e){this._setState("active:saving");const t=this._editLayerURL;if(this._featureId=e.getId()?.toString(),!this._featureId){this._destroy(),this._error=new Error("no feature id available"),p(this,V)?.reject(this._error);return}const n=e?.getGeometry();if(!n){this._destroy(),this._error=new Error("no geometry available"),p(this,V)?.reject(this._error);return}const s=this._olMap.getView().getProjection(),a=new en({dataProjection:s}).writeGeometryObject(n,{rightHanded:!0,decimals:10});this._olMap.removeInteraction(this._modifyInteraction),this._tooltip.destroy(),Ki(this._httpService,t,this._featureId,a,s).then(o=>{this._destroy(),p(this,V)?.resolve({featureId:o})}).catch(o=>{this._destroy(),this._error=new Error("Failed to save feature",{cause:o}),p(this,V)?.reject(this._error)})}_start(){this._olMap.addLayer(this._editingLayer),this._olMap.addInteraction(this._modifyInteraction);const e=this._editingSource.getFeatures()[0];if(e&&!e.getId()?.toString()){this._destroy(),this._error=new Error("no feature id available"),p(this,V)?.reject(this._error);return}const t=Zt(()=>{const r=this._map.container;if(r)return r.addEventListener("keydown",this._enterHandler,!1),r.addEventListener("keydown",this._escapeHandler,!1),()=>{r.removeEventListener("keydown",this._enterHandler),r.removeEventListener("keydown",this._escapeHandler)}});this._tooltip.setVisible(!0);const n=this._map.olMap.on("click",r=>{const a=r.coordinate,o=r.originalEvent.altKey,c=this._editingSource.getFeaturesAtCoordinate(a);o||c.length===0&&this.triggerSave()}),s=this._modifyInteraction.on("modifystart",()=>{this._setState("active:drawing")});this._interactionListener.push(n,s),this._mapListener.push(t)}reset(){const e=this._initialFeature.getGeometry()?.clone(),t=this._editingSource.getFeatures()[0];if(!t)throw Error("no updated feature found");t.setGeometry(e),this._setState("active:initialized")}stop(){this._destroy(),p(this,V)?.resolve(void 0)}_destroy(){this._editingSource.clear(),this._olMap.removeLayer(this._editingLayer),this._olMap.removeInteraction(this._modifyInteraction),this._tooltip.destroy(),this._interactionListener.forEach(e=>{W(e)}),this._mapListener.forEach(e=>{e.destroy()}),this._setState("destroyed")}triggerSave(){const e=this._editingSource.getFeatures()[0];if(!e)throw Error("no updated feature found");this._save(e)}whenComplete(){return this._state.value==="destroyed"?this._error?Promise.reject(this._error):this._featureId?Promise.resolve({featureId:this._featureId}):Promise.resolve(void 0):(p(this,V)??M(this,V,zt())).promise}}V=new WeakMap;class Ro{_serviceOptions;_workflows;constructor(e){this._serviceOptions=e,this._workflows=new Map}createFeature(e,t){if(!t||!e||!e.id)throw new Error("Map, mapId or url is undefined.");const n=e.id;let s=this._workflows.get(n);if(s)throw new Error("EditingWorkflow could not be started. EditingWorkflow already in progress for this map.");return s=new Xi({map:e,ogcApiFeatureLayerUrl:t,polygonStyle:this._serviceOptions.properties.polygonStyle,vertexStyle:this._serviceOptions.properties.vertexStyle,httpService:this._serviceOptions.references.httpService,intl:this._serviceOptions.intl}),this._workflows.set(n,s),this._connectToWorkflowDestroyEvent(s,n),s}updateFeature(e,t,n){if(!t||!e||!e.id)throw new Error("Map, mapId or url is undefined.");const s=e.id;let r=this._workflows.get(s);if(r)throw new Error("EditingWorkflow could not be started. EditingWorkflow already in progress for this map.");return r=new Ji({map:e,ogcApiFeatureLayerUrl:t,feature:n,polygonStyle:this._serviceOptions.properties.polygonStyle,vertexStyle:this._serviceOptions.properties.vertexStyle,httpService:this._serviceOptions.references.httpService,intl:this._serviceOptions.intl}),this._workflows.set(s,r),this._connectToWorkflowDestroyEvent(r,s),r}stop(e){const t=typeof e=="string"?e:e.id,n=this._workflows.get(t);n&&n.stop()}reset(e){const t=typeof e=="string"?e:e.id,n=this._workflows.get(t);if(n)n.reset();else throw new Error("No workflow found for mapId: "+t)}_connectToWorkflowDestroyEvent(e,t){const n=hs(()=>[e.getState()],([s])=>{s==="destroyed"&&(this._workflows.get(t)===e&&this._workflows.delete(t),n.destroy())})}}var te,K,Ce,Pe,Fe,ut;class Zi{constructor(e,t,n){b(this,Fe);S(this,"label");b(this,te,qe({kind:"available"}));b(this,K);b(this,Ce);b(this,Pe);this.label=t,M(this,K,e),M(this,Pe,n),Q(this,Fe,ut).call(this),M(this,Ce,p(this,K).on("change:visible",()=>{Q(this,Fe,ut).call(this)}))}destroy(){W(p(this,Ce))}get status(){return p(this,te).value}async select(e,t){if(e.type!=="extent")throw new Error(`Unsupported selection kind: ${e.type}`);if(p(this,te).value.kind!=="available"||p(this,K).getSource()===null)return[];const n=[];p(this,K).getSource().forEachFeatureIntersectingExtent(e.extent,a=>{if(!a.getGeometry())return;const o={...a.getProperties()};delete o.geometries;const c={id:a.getId()?.toString()||gs(),geometry:a.getGeometry(),properties:o};n.push(c)});const s=n.filter(a=>a!=null);return s.length>t.maxResults?s.slice(0,t.maxResults):s}}te=new WeakMap,K=new WeakMap,Ce=new WeakMap,Pe=new WeakMap,Fe=new WeakSet,ut=function(){const t=p(this,K).getVisible()?{kind:"available"}:{kind:"unavailable",reason:p(this,Pe)};t.kind!==p(this,te).value.kind&&(p(this,te).value=t)};var Le;class No{constructor({intl:e}){b(this,Le);M(this,Le,e)}createSelectionSource(e){return new Zi(e.vectorLayer,e.label,p(this,Le).formatMessage({id:"layerNotVisibleReason"}))}}Le=new WeakMap;const Qi="@open-pioneer/notifier",er=gt.bind(void 0,Qi),tr=sn({d:"M23.384,21.619,16.855,15.09a9.284,9.284,0,1,0-1.768,1.768l6.529,6.529a1.266,1.266,0,0,0,1.768,0A1.251,1.251,0,0,0,23.384,21.619ZM2.75,9.5a6.75,6.75,0,1,1,6.75,6.75A6.758,6.758,0,0,1,2.75,9.5Z",displayName:"SearchIcon"}),mn=sn({displayName:"WarningTwoIcon",d:"M23.119,20,13.772,2.15h0a2,2,0,0,0-3.543,0L.881,20a2,2,0,0,0,1.772,2.928H21.347A2,2,0,0,0,23.119,20ZM11,8.423a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Zm1.05,11.51h-.028a1.528,1.528,0,0,1-1.522-1.47,1.476,1.476,0,0,1,1.448-1.53h.028A1.527,1.527,0,0,1,13.5,18.4,1.475,1.475,0,0,1,12.05,19.933Z"});function Oo(i){const{position:e="top-right"}=i,t=Ds(),n=er("notifier.NotificationService"),[s,r]=_.useState(!0),a=Y(c=>{const u=c.level==="error"?d.jsx(mn,{h:"100%",w:"100%"}):void 0;t({position:e,title:c.title,description:c.message||null,status:c.level,isClosable:!0,duration:c.displayDuration??null,icon:u})}),o=Y(()=>{t.closeAll()});return _.useEffect(()=>{const c=n.registerHandler({showNotification:a,closeAll:o});return()=>c.destroy()},[s,n,a,o]),d.jsx(d.Fragment,{})}const nr="@open-pioneer/coordinate-viewer",sr=ne.bind(void 0,nr),ir=4,rr="decimal",ko=i=>{const{precision:e,displayProjectionCode:t,format:n}=i,{containerProps:s}=X("coordinate-viewer",i),{map:r}=J(i),a=r?.olMap,o=Z(()=>r?.projection.getCode()??"",[r]);let{coordinates:c}=ar(a);c=c&&t?lr(c,o,t):c;const u=or(c,e,n),l=t||o,h=u?u+" "+l:"";return d.jsx(k,{...s,children:d.jsx(he,{className:"coordinate-viewer-text",children:h})})};function or(i,e,t){const n=sr();return i?cr(i,e,n,t):""}function ar(i){const[e,t]=_.useState();return _.useEffect(()=>{if(!i)return;const n=i.on("pointermove",s=>{t(s.coordinate)});return()=>W(n)},[i]),{coordinates:e}}function cr(i,e,t,n){if(i[0]==null||i[1]==null)return"";const s=e??ir,r=n??rr,[a,o]=i;let c;if(r==="degree"&&isFinite(a)&&isFinite(o)){const[u,l,h]=kt(a,t,s),[g,f,y]=kt(o,t,s),v=`${Math.abs(u)}°${l}'${h}"${0<=u?"(E)":"(W)"}`,C=`${Math.abs(g)}°${f}'${y}"${0<=g?"(N)":"(S)"}`;c=v+" "+C}else{const u=t.formatNumber(a,{maximumFractionDigits:s,minimumFractionDigits:s}),l=t.formatNumber(o,{maximumFractionDigits:s,minimumFractionDigits:s});c=u+" "+l}return c}function kt(i,e,t){const n=Math.floor(i),s=i-n,r=Math.floor(60*s),o=60*(60*s-r),c=e.formatNumber(o,{maximumFractionDigits:t,minimumFractionDigits:t});return[n,r,c]}function lr(i,e,t){return fs(i,e,t)}const jo=i=>{const{displayMode:e="line"}=i,{containerProps:t}=X("scale-bar",i),{map:n}=J(i),s=_.useRef(null);return _.useEffect(()=>{if(s.current&&n){const r=n.olMap,a=new Cs({units:"metric",target:s.current,bar:e==="bar"});return r.addControl(a),()=>{r.removeControl(a)}}},[e,n]),d.jsx(k,{...t,ref:s})},ur="@open-pioneer/scale-viewer",dr=ne.bind(void 0,ur),Do=i=>{const{containerProps:e}=X("scale-viewer",i),{map:t}=J(i),n=dr(),s=Z(()=>t?.scale??1,[t]),r=s?n.formatNumber(s):void 0;return d.jsx(k,{...e,children:r&&d.jsxs(he,{children:["1:",r]})})},hr="@open-pioneer/legend",pn=ne.bind(void 0,hr),Go=i=>{const{showBaseLayers:e=!1}=i,{containerProps:t}=X("legend",i),{map:n}=J(i);return d.jsx(k,{...t,children:n?d.jsx(gr,{map:n,showBaseLayers:e}):null})};function gr(i){const{map:e,showBaseLayers:t}=i,s=mr(e).map(r=>d.jsx(yn,{layer:r,showBaseLayers:t},r.id));return d.jsx(Ts,{as:"ul",className:"legend-layer-list",listStyleType:"none",spacing:2,children:s})}function yn(i){const{layer:e,showBaseLayers:t}=i,n=Z(()=>e.visible,[e]),s=pr(e);if(!n||!t&&ws(e)&&_n(e))return;const r=[];return s?.length&&s.forEach(a=>{r.push(d.jsx(yn,{layer:a,showBaseLayers:t},a.id))}),d.jsxs(d.Fragment,{children:[d.jsx(fr,{layer:e,showBaseLayers:t}),r]})}function fr(i){const e=pn(),{layer:t,showBaseLayers:n}=i,s=_n(t),r=yr(t),a=Z(()=>t.legend,[t]);let o;return r?.Component?o=d.jsx(r.Component,{layer:t}):r?.imageUrl?o=d.jsx(jt,{layer:t,imageUrl:r.imageUrl}):a&&(o=d.jsx(jt,{layer:t,imageUrl:a})),o?d.jsxs(k,{as:"li",className:Xe("legend-item",`layer-${_r(t.id)}`),children:[n&&s?d.jsx(he,{as:"b",children:e.formatMessage({id:"basemapLabel"})}):null,o]}):void 0}function jt(i){const e=pn(),{layer:t,imageUrl:n}=i;return d.jsxs(k,{children:[d.jsx(he,{children:t.title}),d.jsx(Ps,{maxW:"none",maxH:"none",src:n,alt:e.formatMessage({id:"altLabel"},{layerName:t.title}),className:"legend-item__image",fallbackStrategy:"onError",fallback:d.jsx(k,{children:d.jsxs(he,{children:[d.jsx(mn,{me:2}),e.formatMessage({id:"fallbackLabel"})]})})})]})}function mr(i){return Z(()=>{const e=i.layers.getLayers({sortByDisplayOrder:!0})??[];return e.reverse(),e},[i])}function pr(i){return Z(()=>{const e=i.sublayers?.getSublayers({sortByDisplayOrder:!0});if(e)return e.reverse(),e},[i])}function yr(i){return Z(()=>i.attributes.legend,[i])}function _n(i){return!("parentLayer"in i)&&i.isBaseLayer}function _r(i){return i.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}const Sr="@open-pioneer/measurement",vr=ne.bind(void 0,Sr);class xr{olMap;messages;activeFeatureStyle;layer;source;draw=void 0;activeMeasurement;predefinedMeasurements=new Map;finishedMeasurements=new Set;helpTooltip;resources=[];measurementChangedHandler;constructor(e,t){this.olMap=e,this.messages=t;const n=this.source=new Ye;this.layer=new me({source:n,zIndex:ht,properties:{name:"measurement-layer"}}),e.addLayer(this.layer);const s=e.on("pointermove",this.handlePointerMove.bind(this));this.resources.push({destroy(){W(s)}});const r=()=>{this.helpTooltip.element.classList.add("hidden")};e.getViewport().addEventListener("mouseout",r),this.resources.push({destroy(){e.getViewport().removeEventListener("mouseout",r)}}),this.helpTooltip=br(this.olMap)}destroy(){this.stopMeasurement();for(const e of this.resources)e.destroy();this.resources=[],this.activeMeasurement=vt(this.activeMeasurement);for(const e of this.finishedMeasurements)e.destroy();this.finishedMeasurements.clear(),this.helpTooltip.destroy(),this.olMap.removeLayer(this.layer),this.layer.dispose(),this.source.dispose(),this.measurementChangedHandler=void 0,this.predefinedMeasurements.clear()}getVectorLayer(){return this.layer}setFinishedFeatureStyle(e){this.layer.setStyle(e)}setMeasurementSourceChangedHandler(e){this.measurementChangedHandler=e}setPredefinedMeasurements(e){this.updatePredefinedMeasurements(e)}setActiveFeatureStyle(e){const t=ms(e);this.activeFeatureStyle=(n,...s)=>{const r=n?.getGeometry()?.getType();if(r==="Polygon"||r==="LineString"||r==="Point")return t(n,...s)},this.draw?.getOverlay().setStyle(this.activeFeatureStyle)}clearMeasurements(){const e=this.source.getFeatures();this.source.clear(),e.forEach(t=>{this.raiseMeasurementsChangeEvent("remove-measurement",t)}),this.predefinedMeasurements.clear();for(const t of this.finishedMeasurements)t.destroy();this.finishedMeasurements.clear()}startMeasurement(e){if(this.draw)throw new Error("Internal error: another measurement interaction is still active.");const t=e==="area"?"Polygon":"LineString",n=this.draw=new nn({source:this.source,type:t,style:this.activeFeatureStyle});this.olMap.addInteraction(n);let s,r;n.on("drawstart",a=>{const o=a.feature;o&&(s=this.activeMeasurement=new Dt("active",o,this),r=o.getGeometry()?.on("change",()=>{s?.updateTooltipContent(),s?.updateTooltipPosition()}))}),n.on("drawend",()=>{if(s&&s===this.activeMeasurement){const a=s;a.updateState("finished"),this.finishedMeasurements.add(a),this.raiseMeasurementsChangeEvent("add-measurement",a.feature),this.activeMeasurement=s=void 0}s=void 0,r&&W(r)}),n.on("drawabort",()=>{s&&(s.destroy(),s===this.activeMeasurement&&(this.activeMeasurement=void 0),s=void 0),r&&W(r)})}stopMeasurement(){this.draw&&(this.olMap.removeInteraction(this.draw),this.draw.abortDrawing(),this.draw.dispose(),this.draw=void 0),this.activeMeasurement=vt(this.activeMeasurement)}handlePointerMove(e){if(e.dragging)return;const t=this.helpTooltip,n=Mr(this.messages,this.activeMeasurement);t.setText(n),t.overlay.setPosition(e.coordinate),t.element.classList.remove("hidden")}updatePredefinedMeasurements(e){const t=e.filter(s=>!this.predefinedMeasurements.has(s)),n=[];for(const s of this.predefinedMeasurements.keys())e.includes(s)||n.push(s);t.forEach(s=>{const r=new de(s);this.source.addFeature(r);const a=new Dt("finished",r,this);this.finishedMeasurements.add(a),this.predefinedMeasurements.set(s,a),this.raiseMeasurementsChangeEvent("add-measurement",r)}),n.forEach(s=>{const r=this.predefinedMeasurements.get(s);r&&(this.source.removeFeature(r.feature),this.finishedMeasurements.delete(r),r.destroy(),this.raiseMeasurementsChangeEvent("remove-measurement",r.feature)),this.predefinedMeasurements.delete(s)})}raiseMeasurementsChangeEvent(e,t){const n=t.getGeometry();this.measurementChangedHandler&&n&&this.measurementChangedHandler({kind:e,geometry:(n instanceof He,n)})}}class Dt{controller;feature;_state;tooltip;constructor(e,t,n){this.controller=n,this._state=e,this.feature=t,this.tooltip=wr(this.olMap),this.updateTooltipContent(),this.updateTooltipPosition(),this.tooltip.setActive(e==="active")}destroy(){this.tooltip.destroy()}get state(){return this._state}updateState(e){this._state!==e&&(this._state=e,this.tooltip.setActive(e==="active"))}updateTooltipContent(){const e=this.feature.getGeometry();if(!e)return;const t=this.olMap.getView().getProjection();let n;e instanceof He?n=Cr(e,t,this.messages):e instanceof at&&(n=Pr(e,t,this.messages)),n&&this.tooltip.setHtml(n)}updateTooltipPosition(){const e=this.feature.getGeometry();if(!e)return;let t;if(e instanceof He)t=e.getInteriorPoint().getCoordinates()||null;else if(e instanceof at)t=e.getLastCoordinate()||null;else return;this.tooltip.overlay.setPosition(t)}get olMap(){return this.controller.olMap}get messages(){return this.controller.messages}}const Gt=[0,-15],Er=[0,-7];function br(i){const e=document.createElement("div");e.className="measurement-tooltip printing-hide hidden",e.role="tooltip";const t=document.createElement("span");e.appendChild(t);const n=new Je({element:e,offset:[15,0],positioning:"center-left"});return i.addOverlay(n),{overlay:n,element:e,destroy(){i.removeOverlay(n)},setText(s){t.textContent=s},setHtml(s){t.innerHTML=s}}}function wr(i){const e=document.createElement("div");e.role="tooltip",e.className="measurement-tooltip measurement-active-tooltip printing-hide";const t=document.createElement("span");e.appendChild(t);const n=new Je({element:e,offset:Gt,positioning:"bottom-center",stopEvent:!1,insertFirst:!1});return i.addOverlay(n),{overlay:n,element:e,destroy(){i.removeOverlay(n)},setActive(s){s?(e.className="measurement-tooltip measurement-active-tooltip printing-hide",n.setOffset(Gt)):(e.className="measurement-tooltip measurement-finished-tooltip",n.setOffset(Er))},setText(s){t.textContent=s},setHtml(s){t.innerHTML=s}}}function Mr(i,e){if(e){const t=e.feature.getGeometry();if(t instanceof He||t instanceof at)return i.getContinueMessage()}return i.getHelpMessage()}function Cr(i,e,t){const n=ps(i,{projection:e});let s;return n>=1e6?s=`${t.formatNumber(n/1e6)} km<sup>2</sup>`:s=`${t.formatNumber(n)} m<sup>2</sup>`,s}function Pr(i,e,t){const n=ys(i,{projection:e});let s;return n>=1e3?s=`${t.formatNumber(n/1e3)} km`:s=`${t.formatNumber(n)} m`,s}const Vo=i=>{const e=vr(),{containerProps:t}=X("measurement",i),[n,s]=_.useState("distance"),r=l=>e.formatMessage({id:l}),a=J(i),o=Fr(a.map,i,e);_.useEffect(()=>{if(o)return o.startMeasurement(n),()=>{o.stopMeasurement()}},[o,n]);function c(l){if(l==="distance"||l==="area")s(l);else throw new Error(`Unexpected measurement type: '${l}'.`)}function u(){o?.clearMeasurements()}return d.jsxs(k,{...t,children:[d.jsx(he,{mb:3,children:e.formatMessage({id:"measurementInfoText"})}),d.jsx(Be,{mb:4,alignItems:"center",children:d.jsxs(ct,{mb:2,children:[d.jsx($e,{mb:1,children:r("measurementLabel")}),d.jsxs(pt,{value:n,onChange:l=>c(l.target.value),className:"measurement-select",children:[d.jsx("option",{value:"distance",children:r("distance")}),d.jsx("option",{value:"area",children:r("area")})]})]})}),d.jsx(Kt,{padding:2,className:"measurement-delete-button",onClick:u,width:"100%",children:r("deleteMeasurementLabel")})]})};function Fr(i,e,t){const{activeFeatureStyle:n,finishedFeatureStyle:s,onMeasurementsChange:r,predefinedMeasurements:a}=e,[o,c]=_.useState(void 0);return _.useEffect(()=>{if(!i)return;const u=new xr(i.olMap,{getContinueMessage(){return t.formatMessage({id:"tooltips.continue"})},getHelpMessage(){return t.formatMessage({id:"tooltips.help"})},formatNumber(l){return t.formatNumber(l,{maximumFractionDigits:2})}});return c(u),()=>{u.destroy(),c(void 0)}},[i,t]),_.useEffect(()=>{o?.setActiveFeatureStyle(n??Lr())},[o,n]),_.useEffect(()=>{o?.setFinishedFeatureStyle(s??Tr())},[o,s]),_.useEffect(()=>{o?.setMeasurementSourceChangedHandler(r)},[o,r]),_.useEffect(()=>{o?.setPredefinedMeasurements(a??[])},[o,a]),o}function Lr(){return[new Ue({stroke:new Se({color:"#fff",lineDash:[10,10],width:5})}),new Ue({fill:new rt({color:"rgba(0,0,0,0.15)"}),stroke:new Se({color:"rgba(0, 0, 0, 0.7)",lineDash:[10,10],width:3}),image:new _s({radius:5,stroke:new Se({color:"rgba(0, 0, 0, 0.7)",width:2}),fill:new rt({color:"rgba(255, 255, 255, 0.2)"})})})]}function Tr(){return[new Ue({stroke:new Se({color:"#fff",width:5})}),new Ue({stroke:new Se({color:"#0b96fc",width:3}),fill:new rt({color:"rgba(11,150,252,0.15)"})})]}const Sn="@open-pioneer/printing",vn=gt.bind(void 0,Sn),Ir=ne.bind(void 0,Sn),Ar="map";class Rr{olMap;i18n;printingService;viewPadding;printMap=void 0;overlay=void 0;constructor(e,t,n){this.olMap=e,this.printingService=t,this.i18n=n}destroy(){this.reset()}setViewPadding(e){this.viewPadding=e}async handleMapExport(e){if(this.olMap)try{this.begin(),this.printMap=await this.printingService.printMap(this.olMap,{blockUserInteraction:!1,viewPadding:this.viewPadding});const t=this.printMap.getCanvas();if(t)e.fileFormat=="png"?await this.exportMapInPNG(t,e):await this.exportMapInPDF(t,e);else throw new Error("Canvas export failed")}finally{this.reset()}}begin(){const e=this.olMap.getTargetElement();e&&(this.overlay=Fs(e,this.i18n.overlayText))}reset(){this.overlay?.destroy(),this.overlay=void 0}getTitleAndFileName(e){const t=e.title||"",n=e.title||Ar;return{title:t,fileName:n}}async exportMapInPNG(e,t){const n=document.createElement("canvas");n.width=e.width,n.height=e.height+50,n.style.backgroundColor="#fff";const s=n.getContext("2d");if(!s)throw new Error("2d canvas rendering context not available");const{title:r,fileName:a}=this.getTitleAndFileName(t);s.fillStyle="#fff",s.fillRect(0,0,n.width,n.height),s.font="20px bold sans-serif",s.textAlign="center",s.fillStyle="#000";const o=n.width/2;s.fillText(r,o,20),s.drawImage(e,0,50);const c=document.createElement("a");c.setAttribute("download",a+".png");const u=Ls(n);if(!u)throw new Error("Failed to get image data URL");c.href=u,c.click()}async exportMapInPDF(e,t){const{jsPDF:n}=await As(async()=>{const{jsPDF:j}=await import("./hgpOibJb62yE.js");return{jsPDF:j}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url),s=new n({orientation:"landscape",unit:"mm",format:"a4"}),r=s.internal.pageSize.getWidth(),a=s.internal.pageSize.getHeight(),o=15,c=20,u=a-c;s.setFontSize(20);const{title:l,fileName:h}=this.getTitleAndFileName(t);s.text(l,r/2,o,{align:"center"});const g=e.width/e.height;let f=u,y=f*g;y>=r&&(y=r,f=y/g);const v=(r-y)/2,C=c+(u-f)/2;s.addImage(e,"",v,C,y,f),s.save(h+".pdf")}}const Nr=fe("printing"),Ho=i=>{const e=Ir(),{viewPadding:t="auto"}=i,{containerProps:n}=X("printing",i),[s,r]=_.useState("pdf"),[a,o]=_.useState(""),[c,u]=_.useState(!1),l=vn("notifier.NotificationService"),{map:h}=J(i),g=Or(h,e,t);function f(v){(v==="png"||v==="pdf")&&r(v)}function y(){c||!g||(u(!0),g.handleMapExport({title:a,fileFormat:s}).catch(v=>{const C=e.formatMessage({id:"printingFailed"});l.notify({level:"error",message:C}),Nr.error("Failed to print the map",v)}).finally(()=>{u(!1)}))}return d.jsx(k,{...n,children:d.jsxs(k,{as:"form",m:2,alignItems:"center",onSubmit:v=>{v.preventDefault(),y()},children:[d.jsxs(Be,{as:ct,mb:2,children:[d.jsx($e,{minWidth:"82",mb:1,children:e.formatMessage({id:"title"})}),d.jsx(mt,{placeholder:e.formatMessage({id:"input.placeholder"}),value:a,onChange:v=>{o(v.target.value)},autoFocus:!0})]}),d.jsxs(Be,{as:ct,mb:2,children:[d.jsx($e,{minWidth:"82",mb:1,children:e.formatMessage({id:"fileFormat"})}),d.jsxs(pt,{value:s,onChange:v=>f(v.target.value),className:"printing-select",children:[d.jsx("option",{value:"png",children:"PNG"}),d.jsx("option",{value:"pdf",children:"PDF"})]})]}),d.jsx(Kt,{isLoading:c,loadingText:e.formatMessage({id:"printingMap"}),disabled:c,mt:2,p:2,className:"printing-export-button",type:"submit",width:"100%",children:e.formatMessage({id:"export"})})]})})};function Or(i,e,t){const n=vn("printing.PrintingService"),[s,r]=_.useState(void 0);return _.useEffect(()=>{if(!i)return;const a=new Rr(i.olMap,n,{overlayText:e.formatMessage({id:"printingMap"})});return r(a),()=>{a.destroy(),r(void 0)}},[i,e,n]),_.useEffect(()=>{s?.setViewPadding(t)},[s,t]),s}const kr="@open-pioneer/search",Ze=ne.bind(void 0,kr);function jr(i){const e=i.selectProps.inputValue.length>0,t={...i,className:Xe(i.className,{"search-invisible":!e})};return d.jsx(U.Menu,{...t,children:i.children})}function Dr(i){const e=i.data.label,t={...i.innerProps,"aria-label":e,role:"group"};return d.jsx(U.Group,{...i,innerProps:t})}function Gr(i){const t=Ze().formatMessage({id:"noOptionsText"});return d.jsx(U.NoOptionsMessage,{...i,children:d.jsx(z.span,{className:"search-no-match",children:t})})}function Vr(i){const t=Ze().formatMessage({id:"loadingText"});return d.jsx(U.LoadingMessage,{...i,children:d.jsx(z.span,{className:"search-loading-text",children:t})})}function Hr({children:i,...e}){const t={...e,className:Xe(e.className,"search-value-container")};return d.jsxs(U.ValueContainer,{...t,children:[!!i&&d.jsx(tr,{style:{position:"absolute",left:8}}),i]})}function Ur(i){const e={...i,isHidden:!1};return d.jsx(U.Input,{...e})}function Br(i){return null}function $r(i){return d.jsxs(U.IndicatorsContainer,{...i,children:[i.children,!i.selectProps.isLoading&&i.selectProps.inputValue&&d.jsx(Wr,{selectProps:i.selectProps,clearValue:i.clearValue})]})}function Wr(i){const t=Ze().formatMessage({id:"ariaLabel.clearButton"}),n=s=>{s.preventDefault(),s.stopPropagation(),i.clearValue()};return d.jsx(Nn,{role:"button",size:"md",mr:1,"aria-label":t,onClick:n,onTouchEnd:n,onMouseDown:s=>s.preventDefault()})}function zr(i){return null}function Kr(i){const e=i.selectProps.inputValue,t=i.data.label,n={...i,className:Xe(i.className,"search-option")};return d.jsx(U.Option,{...n,children:d.jsx(z.div,{className:"search-option-label",children:e.trim().length>0?qr(t,e):t})})}function qr(i,e){const t=i.toLowerCase().indexOf(e.toLowerCase());return t>=0?d.jsxs(d.Fragment,{children:[i.substring(0,t),d.jsx(z.span,{className:"search-highlighted-match",children:i.substring(t,t+e.length)},"highlighted"),i.substring(t+e.length)]}):i}const Vt=fe("search:SearchController"),Ht=200,Ut=5;var Te,ce,le,ue,H,ze,xn;class Yr{constructor(e,t){b(this,ze);b(this,Te);b(this,ce,[]);b(this,le,Ut);b(this,ue,Ht);b(this,H);M(this,Te,e),M(this,ce,t)}destroy(){p(this,H)?.abort(),M(this,H,void 0)}async search(e){if(p(this,H)?.abort(),M(this,H,void 0),!e)return[];const t=M(this,H,new AbortController);try{return await Xr(t.signal,p(this,ue)),t.signal.aborted&&(Vt.debug(`search canceled with ${e}`),On()),(await Promise.all(p(this,ce).map(s=>Q(this,ze,xn).call(this,s,e,t.signal)))).filter(s=>s!=null)}finally{p(this,H)===t&&M(this,H,void 0)}}get searchTypingDelay(){return p(this,ue)}set searchTypingDelay(e){M(this,ue,e??Ht)}get maxResultsPerSource(){return p(this,le)}set maxResultsPerSource(e){M(this,le,e??Ut)}get sources(){return p(this,ce)}}Te=new WeakMap,ce=new WeakMap,le=new WeakMap,ue=new WeakMap,H=new WeakMap,ze=new WeakSet,xn=async function(e,t,n){const s=e.label,r=p(this,Te).olMap.getView().getProjection();try{const a=p(this,le);let o=await e.search(t,{maxResults:a,signal:n,mapProjection:r});return o.length>a&&(o=o.slice(0,a)),{label:s,source:e,results:o}}catch(a){De(a)||Vt.error(`search for source ${s} failed`,a);return}};async function Xr(i,e){i.aborted||await new Promise(t=>{const n=()=>{i.removeEventListener("abort",n),clearTimeout(s),t()};i.addEventListener("abort",n);const s=setTimeout(n,e)})}const We=fe("search:Search"),Uo=i=>{const{sources:e,searchTypingDelay:t,maxResultsPerGroup:n,onSelect:s,onClear:r}=i,{containerProps:a}=X("search",i),{map:o}=J(i),c=Ze(),u=eo(e,t,n,o),{input:l,search:h,selectedOption:g,onInputChanged:f,onResultConfirmed:y}=to(u),v=Qr(),C=Jr(c),j=Zr(),G=Y((R,Ne)=>{Ne.action==="input-change"&&f(R)}),P=Y((R,Ne)=>{switch(Ne.action){case"select-option":R&&(y(R),s?.({source:R.source,result:R.result}));break;case"clear":f(""),L.current?.blur(),L.current?.focus(),r?.();break;default:We.debug(`Unhandled action type '${Ne.action}'.`);break}}),L=_.useRef(null);return d.jsx(k,{...a,children:d.jsx(tn,{className:"search-component",classNamePrefix:"react-select",ref:L,inputValue:l,onInputChange:G,"aria-label":c.formatMessage({id:"ariaLabel.search"}),ariaLiveMessages:C,tagColorScheme:"trails",selectedOptionStyle:"color",selectedOptionColorScheme:"trails",chakraStyles:v,isClearable:!0,placeholder:i.placeholder??c.formatMessage({id:"searchPlaceholder"}),closeMenuOnSelect:!0,isLoading:h.kind==="loading",options:h.kind==="ready"?h.results:void 0,filterOption:()=>!0,tabSelectsValue:!1,components:j,onChange:P,value:g,menuPosition:"fixed"})})};function Jr(i){return _.useMemo(()=>({onFocus:()=>"",onChange:()=>"",guidance:()=>`${i.formatMessage({id:"ariaLabel.instructions"})}`,onFilter:()=>""}),[i])}function Zr(){return _.useMemo(()=>({Menu:jr,Input:Ur,SingleValue:Br,Option:Kr,NoOptionsMessage:Gr,LoadingMessage:Vr,ValueContainer:Hr,IndicatorsContainer:$r,ClearIndicator:zr,Group:Dr}),[])}function Qr(){const[i,e,t]=qt("colors",["trails.100","trails.50","trails.500"],["#d5e5ec","#eaf2f5","#1A202C"]);return _.useMemo(()=>({inputContainer:s=>({...s,gridTemplateAreas:"'area area area'",display:"grid"}),input:s=>({...s,gridArea:"area"}),groupHeading:s=>({...s,backgroundColor:i,padding:"8px 12px",fontSize:"inherit",fontWeight:"inherit"}),option:s=>({...s,backgroundColor:"inherit",_focus:{backgroundColor:e},_selected:{backgroundColor:t}}),dropdownIndicator:s=>({...s,display:"none"})}),[i,e,t])}function eo(i,e,t,n){const[s,r]=_.useState(void 0);return _.useEffect(()=>{if(!n)return;const a=new Yr(n,i);return r(a),()=>{a.destroy(),r(void 0)}},[n,i]),_.useEffect(()=>{s&&(s.searchTypingDelay=e)},[s,e]),_.useEffect(()=>{s&&(s.maxResultsPerSource=t)},[s,t]),s}function to(i){const[e,t]=_.useReducer((o,c)=>{switch(c.kind){case"input":return{...o,query:c.query,selectedOption:null};case"select-option":return{...o,selectedOption:c.option,query:c.option.label};case"load-results":return{...o,search:{kind:"loading"}};case"accept-results":return{...o,search:{kind:"ready",results:c.results}}}},void 0,()=>({query:"",selectedOption:null,search:{kind:"ready",results:[]}})),n=_.useRef(void 0),s=Y(o=>{if(!i){n.current=void 0,t({kind:"accept-results",results:[]});return}We.isDebug()&&We.debug(`Starting new search for query ${JSON.stringify(o)}.`),t({kind:"load-results"});const c=n.current=no(i,o).then(u=>{n.current===c&&t({kind:"accept-results",results:u})})}),r=_.useCallback(o=>{t({kind:"select-option",option:o})},[]),a=_.useCallback(o=>{t({kind:"input",query:o}),s(o)},[s]);return{input:e.query,search:e.search,selectedOption:e.selectedOption,onResultConfirmed:r,onInputChanged:a}}async function no(i,e){let t;try{t=await i.search(e)}catch(n){De(n)||We.error("Search failed",n),t=[]}return so(t)}function so(i){return i.map((t,n)=>({label:t.label,options:t.results.map(s=>({value:`${n}-${s.id}`,label:s.label,source:t.source,result:s}))}))}const En="@open-pioneer/selection",io=gt.bind(void 0,En),yt=ne.bind(void 0,En),_e="selection-active",je="selection-inactive";class ro{tooltip;interactionResources=[];olMap;isActive=!0;tooltipMessage;tooltipDisabledMessage;constructor(e,t,n,s){const r=this.initViewport(e);this.interactionResources.push(this.createDragBox(e,s,r,this.interactionResources)),this.interactionResources.push(this.createDrag(e,r,this.interactionResources)),this.tooltip=this.createHelpTooltip(e,t),this.olMap=e,this.tooltipMessage=t,this.tooltipDisabledMessage=n}initViewport(e){const t=e.getViewport();return t.classList.add(_e),t.oncontextmenu=n=>(n.preventDefault(),!1),t}destroy(){this.tooltip.destroy(),this.interactionResources.forEach(e=>{e.destroy()})}setActive(e){if(this.isActive===e)return;const t=this.olMap.getViewport();e?(this.interactionResources.forEach(n=>this.olMap.addInteraction(n.interaction)),this.tooltip.setText(this.tooltipMessage),t.classList.remove(je),t.classList.add(_e),this.isActive=!0):(this.interactionResources.forEach(n=>this.olMap.removeInteraction(n.interaction)),this.tooltip.setText(this.tooltipDisabledMessage),t.classList.remove(_e),t.classList.add(je),this.isActive=!1)}createDragBox(e,t,n,s){const r=new Ft({className:"selection-drag-box",condition:Ss});return e.addInteraction(r),r.on("boxend",function(){t(r.getGeometry())}),{interaction:r,destroy(){e.removeInteraction(r),s.splice(s.indexOf(this)),r.dispose(),n.classList.remove(_e),n.classList.remove(je),n.oncontextmenu=null}}}createDrag(e,t,n){const s=function(o){return o.originalEvent.button==2},r=new Lt({condition:s});return e.addInteraction(r),{interaction:r,destroy(){e.removeInteraction(r),n.splice(n.indexOf(this)),r.dispose(),t.classList.remove(_e),t.classList.remove(je),t.oncontextmenu=null}}}createHelpTooltip(e,t){const n=document.createElement("div");n.className="selection-tooltip printing-hide",n.role="tooltip";const s=document.createElement("span");s.textContent=t,n.appendChild(s);const r=new Je({element:n,offset:[15,0],positioning:"center-left"}),a=e.on("pointermove",o=>{r.setPosition(o.coordinate)});return e.addOverlay(r),{overlay:r,element:n,destroy(){e.removeOverlay(r),r.dispose(),W(a)},setText(o){s.textContent=o}}}getDragboxInteraction(){return this.interactionResources.find(e=>e.interaction instanceof Ft)}getDragPanInteraction(){return this.interactionResources.find(e=>e.interaction instanceof Lt)}}const st=fe("selection:SelectionController"),oo=1e4;var Ie,Ae,Re,Ke,bn;class ao{constructor(e){b(this,Ke);b(this,Ie);b(this,Ae);b(this,Re);const{mapModel:t,onError:n,maxResults:s=oo}=e;M(this,Ie,t),M(this,Ae,s),M(this,Re,n)}destroy(){}async select(e,t){if(t)return await Q(this,Ke,bn).call(this,e,t)}}Ie=new WeakMap,Ae=new WeakMap,Re=new WeakMap,Ke=new WeakSet,bn=async function(e,t){const n=p(this,Ie).olMap.getView().getProjection();try{st.debug(`Starting selection on source '${e.label}'`);const s=p(this,Ae);let r=await e.select({type:"extent",extent:t},{maxResults:s,mapProjection:n,signal:new AbortController().signal});return r.length>s&&(r=r.slice(0,s)),st.debug(`Found ${r.length} results on source '${e.label}'`),{source:e,results:r}}catch(s){st.error(`selection from source ${e.label} failed`,s),p(this,Re).call(this);return}};const co={classNamePrefix:"react-select",menuPosition:"fixed",isSearchable:!1,isClearable:!1},Bo=i=>{const e=yt(),{sources:t,onSelectionComplete:n,onSelectionSourceChanged:s}=i,{containerProps:r}=X("selection",i),a=e.formatMessage({id:"sourceNotAvailable"}),[o,c]=ho(t,s),u=Cn(o,a),l=J(i),{onExtentSelected:h}=go(l.map,t,o,n),g=mo(),[f,y]=_.useState(!1);fo(l.map,e,h,u.kind==="available",!!o);const v=_.useMemo(()=>t.map(P=>({label:P.label,value:P})),[t]),C=_.useMemo(()=>v.find(L=>L.value===o)||null,[v,o]),j=Y(P=>{c(P?.value)}),G=Y(P=>{!f&&P.key==="Enter"&&y(!0)});return d.jsx(kn,{...r,spacing:2,children:d.jsxs(Be,{children:[d.jsx($e,{children:e.formatMessage({id:"selectSource"})}),d.jsx(tn,{className:"selection-source react-select",...co,options:v,placeholder:e.formatMessage({id:"selectionPlaceholder"}),value:C,onChange:j,components:{Option:lo,SingleValue:uo},isOptionDisabled:()=>!1,getOptionLabel:P=>{const L=P.label,R=Mn(P.value,a);return R.kind=="available"?L:L+" "+R.reason},ariaLiveMessages:{guidance:()=>"",onChange:P=>P.action=="select-option"||P.action=="initial-input-focus"?P.label+" "+e.formatMessage({id:"selected"}):"",onFilter:()=>"",onFocus:()=>""},chakraStyles:g,onKeyDown:G,menuIsOpen:f,onMenuOpen:()=>y(!0),onMenuClose:()=>y(!1)})]})})};function lo(i){const{value:e}=i.data,{isAvailable:t,content:n}=wn(e,!1);return d.jsx(U.Option,{...i,isDisabled:!t,className:"selection-source-option",children:n})}function uo(i){const{value:e}=i.data,{isAvailable:t,content:n}=wn(e,!0),s=t?"selection-source-value":"selection-source-value selection-source-value--disabled";return d.jsx(U.SingleValue,{...i,isDisabled:!t,className:s,children:n})}function ho(i,e){const[t,n]=_.useState(()=>i[0]);_.useEffect(()=>{t&&!i.includes(t)&&n(void 0)},[i,t]);const s=_.useRef(void 0);return _.useEffect(()=>{t!==s.current&&(s.current=t,e?.({source:t}))},[t,e]),[t,n]}function wn(i,e){const t=yt(),n=i?.label,s=t.formatMessage({id:"sourceNotAvailable"}),r=Cn(i,s);return{isAvailable:r.kind==="available",content:d.jsxs(Tt,{direction:"row",alignItems:"center",grow:1,children:[!e&&d.jsx(Tt,{grow:1,children:n}),r.kind==="unavailable"&&d.jsx(k,{ml:2,children:d.jsx(jn,{label:r.reason,placement:"right",openDelay:500,children:d.jsx(z.span,{children:d.jsx(Dn,{as:Rs,color:"red",className:"warning-icon","aria-label":r.reason})})})}),e&&n]})}}function go(i,e,t,n){const s=io("notifier.NotificationService"),r=yt(),[a,o]=_.useState(void 0);_.useEffect(()=>{if(!i)return;const u=new ao({mapModel:i,onError(){s.notify({level:"error",message:r.formatMessage({id:"selectionFailed"})})}});return o(u),()=>{u.destroy()}},[i,s,e,r]);const c=Y(async u=>{if(!a||!t)return;const l=await a.select(t,u.getExtent());l&&n?.(l)});return{controller:a,onExtentSelected:c}}function Mn(i,e){const t=i.status??"available",n=typeof t=="string"?{kind:t}:t;return n.kind==="available"?n:{kind:"unavailable",reason:n.reason??e}}function Cn(i,e){return Z(()=>i?Mn(i,e):{kind:"unavailable",reason:e},[i,e])}function fo(i,e,t,n,s){_.useEffect(()=>{if(!i)return;const r=s?e.formatMessage({id:"disabledTooltip"}):e.formatMessage({id:"noSourceTooltip"}),a=new ro(i.olMap,e.formatMessage({id:"tooltip"}),r,t);return a.setActive(n),()=>{a?.destroy()}},[i,e,t,n,s])}function mo(){const[i,e]=qt("colors",["background_body","border"],["#ffffff","#ffffff"]);return _.useMemo(()=>({control:n=>({...n,cursor:"pointer"}),indicatorSeparator:n=>({...n,borderColor:e}),dropdownIndicator:n=>({...n,backgroundColor:i})}),[i,e])}export{ko as C,Ro as E,mt as I,Go as L,Vo as M,Oo as N,Je as O,Ho as P,hn as S,No as V,Ao as W,jo as a,Do as b,Uo as c,Bo as d,pt as e};
