import{a_ as Fe,af as F,bR as v,ay as ht,bS as bt,ak as Le,an as Pt,am as xt,bT as vt,bU as jt,bV as wt,bW as Ct,ac as St,bX as I,bY as Ne,bZ as Ot,aZ as Ge,b3 as Ee,u as Mt,k as se,i as Ft,g as xe,h as ve}from"./j0mck_Meu7Xh.js";import{G as Lt,a as Nt,b as Gt,M as Et}from"./BWf1FusGPLsb.js";import{L as Tt}from"./ajAX9OmvUsbZ.js";import{J as kt,r as i,j as a,K as At,L as Te,l as R,k as ke,M as It,N as Rt,O as oe,P as H,Q as O,u as _t,o as Bt,R as Dt,w as Ht,g as A,h as V,D as Jt,T as Vt,U as Ut,q as Ae,b as le,B as J,F as Ie}from"./B60Dx_GOYdnk.js";import{u as Z,B as zt}from"./DSjrbd_eKbZM.js";import{u as Wt}from"./BpQSjk0kyblh.js";import{F as $t,f as Re}from"./2C0geDG_OBHU.js";import{I as Kt,S as _e}from"./BXfBNJYYR7xb.js";import{C as Yt,a as qt,b as Zt,M as je}from"./CMfwYEDRd35m.js";import{c as Qt}from"./BlACKGYldMfy.js";import{T as ae,L as Xt}from"./BKR6R-cAnIXt.js";import{C as er}from"./CG5nmvkyugDn.js";import{u as tr,a as rr,b as or,c as nr,l as sr,i as we,M as ar}from"./C9VJq5Ka7299.js";const ir=t=>{const{condition:e,message:r}=t};function lr(t){return"current"in t}const Be=()=>typeof window<"u";function cr(){return navigator.userAgentData?.platform??navigator.platform}const ur=t=>Be()&&t.test(navigator.vendor),dr=t=>Be()&&t.test(cr()),pr=()=>dr(/mac|iphone|ipad|ipod/i),mr=()=>pr()&&ur(/apple/i);function fr(t){const{ref:e,elements:r,enabled:o}=t,n=()=>e.current?.ownerDocument??document;kt(n,"pointerdown",s=>{if(!mr()||!o)return;const c=s.composedPath?.()?.[0]??s.target,u=(r??[e]).some(l=>{const f=lr(l)?l.current:l;return f?.contains(c)||f===c});n().activeElement!==c&&u&&(s.preventDefault(),c.focus())})}const k={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},ho={enter:{duration:.2,ease:k.easeOut},exit:{duration:.1,ease:k.easeIn}},Ce={enter:(t,e)=>({...t,delay:typeof e=="number"?e:e?.enter}),exit:(t,e)=>({...t,delay:typeof e=="number"?e:e?.exit})},gr=t=>t!=null&&parseInt(t.toString(),10)>0,Se={exit:{height:{duration:.2,ease:k.ease},opacity:{duration:.3,ease:k.ease}},enter:{height:{duration:.3,ease:k.ease},opacity:{duration:.4,ease:k.ease}}},yr={exit:({animateOpacity:t,startingHeight:e,transition:r,transitionEnd:o,delay:n})=>({...t&&{opacity:gr(e)?1:0},height:e,transitionEnd:o?.exit,transition:r?.exit??Ce.exit(Se.exit,n)}),enter:({animateOpacity:t,endingHeight:e,transition:r,transitionEnd:o,delay:n})=>({...t&&{opacity:1},height:e,transitionEnd:o?.enter,transition:r?.enter??Ce.enter(Se.enter,n)})},De=i.forwardRef((t,e)=>{const{in:r,unmountOnExit:o,animateOpacity:n=!0,startingHeight:s=0,endingHeight:c="auto",style:p,className:u,transition:l,transitionEnd:f,animatePresenceProps:P,...y}=t,[C,j]=i.useState(!1);i.useEffect(()=>{const S=setTimeout(()=>{j(!0)});return()=>clearTimeout(S)},[]),ir({condition:Number(s)>0&&!!o,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const M=parseFloat(s.toString())>0,m={startingHeight:s,endingHeight:c,animateOpacity:n,transition:C?l:{enter:{duration:0}},transitionEnd:{enter:f?.enter,exit:o?f?.exit:{...f?.exit,display:M?"block":"none"}}},g=o?r:!0,h=r||o?"enter":"exit";return a.jsx(At,{...P,initial:!1,custom:m,children:g&&a.jsx(Te.div,{ref:e,...y,className:R("chakra-collapse",u),style:{overflow:"hidden",display:"block",...p},custom:m,variants:yr,initial:o?"exit":!1,animate:h,exit:"exit"})})});De.displayName="Collapse";const[hr,G]=ke({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[br,U]=ke({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `}),T={click:"click",hover:"hover"};function Pr(t={}){const{closeOnBlur:e=!0,closeOnEsc:r=!0,initialFocusRef:o,id:n,returnFocusOnClose:s=!0,autoFocus:c=!0,arrowSize:p,arrowShadowColor:u,trigger:l=T.click,openDelay:f=200,closeDelay:P=200,isLazy:y,lazyBehavior:C="unmount",computePositionOnMount:j,...M}=t,{isOpen:m,onClose:g,onOpen:h,onToggle:S}=It(t),[X,_]=i.useState(s);i.useEffect(()=>_(s),[s]);const ee=i.useRef(null),B=i.useRef(null),L=i.useRef(null),D=i.useRef(!1),pe=i.useRef(!1);m&&(pe.current=!0);const[me,rt]=i.useState(!1),[fe,ot]=i.useState(!1),nt=i.useId(),st=n??nt,[ge,z,W,$]=["popover-trigger","popover-content","popover-header","popover-body"].map(d=>`${d}-${st}`),{referenceRef:K,getArrowProps:at,getPopperProps:ye,getArrowInnerProps:it,forceUpdate:lt}=Rt({...M,enabled:m||!!j}),he=tr({isOpen:m,ref:L});fr({enabled:m,ref:B}),rr(L,{focusRef:B,visible:m,shouldFocus:X&&l===T.click}),or(L,{focusRef:o,visible:m,shouldFocus:c&&l===T.click}),nr({enabled:m&&e,ref:L,handler(d){const x=d.composedPath?.()[0]??[d.target];Y(B.current,x)||(x&&_(!we(x)),g())}});const be=sr({wasSelected:pe.current,enabled:y,mode:C,isSelected:he.present}),ct=i.useCallback((d={},x=null)=>{const b={...d,style:{...d.style,transformOrigin:oe.transformOrigin.varRef,[oe.arrowSize.var]:p?`${p}px`:void 0,[oe.arrowShadowColor.var]:u},ref:H(L,x),children:be?d.children:null,id:z,tabIndex:-1,role:"dialog",onKeyDown:O(d.onKeyDown,w=>{w.nativeEvent.isComposing||r&&w.key==="Escape"&&(w.preventDefault(),w.stopPropagation(),g())}),onBlur:O(d.onBlur,w=>{const E=Oe(w),re=Y(L.current,E),gt=Y(B.current,E),yt=!re&&!gt;E&&_(!we(E)),m&&e&&yt&&g()}),"aria-labelledby":me?W:void 0,"aria-describedby":fe?$:void 0};return l===T.hover&&(b.role="tooltip",b.onMouseEnter=O(d.onMouseEnter,()=>{D.current=!0}),b.onMouseLeave=O(d.onMouseLeave,w=>{w.nativeEvent.relatedTarget!==null&&(D.current=!1,setTimeout(()=>g(),P))})),b},[be,z,me,W,fe,$,l,r,g,m,e,P,u,p]),ut=i.useCallback((d={},x=null)=>ye({...d,style:{visibility:m?"visible":"hidden",...d.style}},x),[m,ye]),dt=i.useCallback((d,x=null)=>({...d,ref:H(x,ee,K)}),[ee,K]),N=i.useRef(),te=i.useRef(),Pe=i.useCallback(d=>{ee.current==null&&K(d)},[K]),pt=i.useCallback((d={},x=null)=>{const b={...d,ref:H(B,x,Pe),id:ge,"aria-haspopup":"dialog","aria-expanded":m,"aria-controls":z};return l===T.click&&(b.onClick=O(d.onClick,S)),l===T.hover&&(b.onFocus=O(d.onFocus,()=>{N.current===void 0&&h()}),b.onBlur=O(d.onBlur,w=>{const E=Oe(w),re=!Y(L.current,E);m&&e&&re&&g()}),b.onKeyDown=O(d.onKeyDown,w=>{w.key==="Escape"&&g()}),b.onMouseEnter=O(d.onMouseEnter,()=>{D.current=!0,N.current=window.setTimeout(()=>h(),f)}),b.onMouseLeave=O(d.onMouseLeave,()=>{D.current=!1,N.current&&(clearTimeout(N.current),N.current=void 0),te.current=window.setTimeout(()=>{D.current===!1&&g()},P)})),b},[ge,m,z,l,Pe,S,h,e,g,f,P]);i.useEffect(()=>()=>{N.current&&clearTimeout(N.current),te.current&&clearTimeout(te.current)},[]);const mt=i.useCallback((d={},x=null)=>({...d,id:W,ref:H(x,b=>{rt(!!b)})}),[W]),ft=i.useCallback((d={},x=null)=>({...d,id:$,ref:H(x,b=>{ot(!!b)})}),[$]);return{forceUpdate:lt,isOpen:m,onAnimationComplete:he.onComplete,onClose:g,getAnchorProps:dt,getArrowProps:at,getArrowInnerProps:it,getPopoverPositionerProps:ut,getPopoverProps:ct,getTriggerProps:pt,getHeaderProps:mt,getBodyProps:ft}}function Y(t,e){return t===e||t?.contains(e)}function Oe(t){const e=t.currentTarget.ownerDocument.activeElement;return t.relatedTarget??e}function He(t){const e=_t("Popover",t),{children:r,...o}=Bt(t),n=Dt(),s=Pr({...o,direction:n.direction});return a.jsx(hr,{value:s,children:a.jsx(br,{value:e,children:Ht(r,{isOpen:s.isOpen,onClose:s.onClose,forceUpdate:s.forceUpdate})})})}He.displayName="Popover";const ne=(t,e)=>e?`${t}.${e}, ${e}`:void 0;function Je(t){const{bg:e,bgColor:r,backgroundColor:o,shadow:n,boxShadow:s,shadowColor:c,...p}=t,{getArrowProps:u,getArrowInnerProps:l}=G(),f=U(),P=e??r??o,y=n??s;return a.jsx(A.div,{...u(),className:"chakra-popover__arrow-positioner",children:a.jsx(A.div,{className:R("chakra-popover__arrow",t.className),...l(p),__css:{"--popper-arrow-shadow-color":ne("colors",c),"--popper-arrow-bg":ne("colors",P),"--popper-arrow-shadow":ne("shadows",y),...f.arrow}})})}Je.displayName="PopoverArrow";const Ve=V(function(e,r){const{getBodyProps:o}=G(),n=U();return a.jsx(A.div,{...o(e,r),className:R("chakra-popover__body",e.className),__css:n.body})});Ve.displayName="PopoverBody";const Ue=V(function(e,r){const{onClose:o}=G(),n=U();return a.jsx(Jt,{size:"sm",onClick:o,className:R("chakra-popover__close-btn",e.className),__css:n.closeButton,ref:r,...e})});Ue.displayName="PopoverCloseButton";function xr(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}const vr={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},jr=A(Te.section),ze=V(function(e,r){const{variants:o=vr,...n}=e,{isOpen:s}=G();return a.jsx(jr,{ref:r,variants:xr(o),initial:!1,animate:s?"enter":"exit",...n})});ze.displayName="PopoverTransition";const We=V(function(e,r){const{rootProps:o,motionProps:n,...s}=e,{getPopoverProps:c,getPopoverPositionerProps:p,onAnimationComplete:u}=G(),l=U(),f=Vt({position:"relative",display:"flex",flexDirection:"column",...l.content});return a.jsx(A.div,{...p(o),__css:l.popper,className:"chakra-popover__popper",children:a.jsx(ze,{...n,...c(s,r),onAnimationComplete:Ut(u,s.onAnimationComplete),className:R("chakra-popover__content",e.className),__css:f})})});We.displayName="PopoverContent";const $e=V(function(e,r){const{getHeaderProps:o}=G(),n=U();return a.jsx(A.header,{...o(e,r),className:R("chakra-popover__header",e.className),__css:n.header})});$e.displayName="PopoverHeader";function Ke(t){const e=i.Children.only(t.children),{getTriggerProps:r}=G();return a.jsx(a.Fragment,{children:i.cloneElement(e,r(e.props,e.ref))})}Ke.displayName="PopoverTrigger";function wr(t){return"parentLayer"in t}function bo(t){return"olLayer"in t}class Cr{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Fe,this.supportedMediaTypes=null}getReadOptions(e,r){if(r){let o=r.dataProjection?F(r.dataProjection):this.readProjection(e);r.extent&&o&&o.getUnits()==="tile-pixels"&&(o=F(o),o.setWorldExtent(r.extent)),r={dataProjection:o,featureProjection:r.featureProjection}}return this.adaptOptions(r)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return v()}readFeature(e,r){return v()}readFeatures(e,r){return v()}readGeometry(e,r){return v()}readProjection(e){return v()}writeFeature(e,r){return v()}writeFeatures(e,r){return v()}writeGeometry(e,r){return v()}}function ce(t,e,r){const o=r?F(r.featureProjection):null,n=r?F(r.dataProjection):null;let s=t;if(o&&n&&!ht(o,n)){e&&(s=t.clone());const c=e?o:n,p=e?n:o;c.getUnits()==="tile-pixels"?s.transform(c,p):s.applyTransform(bt(c,p))}if(e&&r&&r.decimals!==void 0){const c=Math.pow(10,r.decimals),p=function(u){for(let l=0,f=u.length;l<f;++l)u[l]=Math.round(u[l]*c)/c;return u};s===t&&(s=t.clone()),s.applyTransform(p)}return s}const Sr={Point:Pt,LineString:Tt,Polygon:xt,MultiPoint:Nt,MultiLineString:Gt,MultiPolygon:Et};function Or(t,e,r){return Array.isArray(e[0])?(vt(t,0,e,r)||(t=t.slice(),jt(t,0,e,r)),t):(wt(t,0,e,r)||(t=t.slice(),Ct(t,0,e,r)),t)}function Ye(t,e){const r=t.geometry;if(!r)return[];if(Array.isArray(r))return r.map(s=>Ye({...t,geometry:s})).flat();const o=r.type==="MultiPolygon"?"Polygon":r.type;if(o==="GeometryCollection"||o==="Circle")throw new Error("Unsupported geometry type: "+o);const n=r.layout.length;return ce(new Le(o,o==="Polygon"?Or(r.flatCoordinates,r.ends,n):r.flatCoordinates,r.ends?.flat(),n,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function ue(t,e){if(!t)return null;if(Array.isArray(t)){const o=t.map(n=>ue(n,e));return new Lt(o)}const r=Sr[t.type];return ce(new r(t.flatCoordinates,t.layout,t.ends),!1,e)}class Mr extends Cr{constructor(){super()}getType(){return"json"}readFeature(e,r){return this.readFeatureFromObject(q(e),this.getReadOptions(e,r))}readFeatures(e,r){return this.readFeaturesFromObject(q(e),this.getReadOptions(e,r))}readFeatureFromObject(e,r){return v()}readFeaturesFromObject(e,r){return v()}readGeometry(e,r){return this.readGeometryFromObject(q(e),this.getReadOptions(e,r))}readGeometryFromObject(e,r){return v()}readProjection(e){return this.readProjectionFromObject(q(e))}readProjectionFromObject(e){return v()}writeFeature(e,r){return JSON.stringify(this.writeFeatureObject(e,r))}writeFeatureObject(e,r){return v()}writeFeatures(e,r){return JSON.stringify(this.writeFeaturesObject(e,r))}writeFeaturesObject(e,r){return v()}writeGeometry(e,r){return JSON.stringify(this.writeGeometryObject(e,r))}writeGeometryObject(e,r){return v()}}function q(t){if(typeof t=="string"){const e=JSON.parse(t);return e||null}return t!==null?t:null}class Po extends Mr{constructor(e){e=e||{},super(),this.dataProjection=F(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=F(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,r){let o=null;e.type==="Feature"?o=e:o={type:"Feature",geometry:e,properties:null};const n=de(o.geometry);if(this.featureClass===Le)return Ye({geometry:n,id:o.id,properties:o.properties},r);const s=new Fe;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&o.geometry_name&&s.setGeometryName(o.geometry_name),s.setGeometry(ue(n,r)),"id"in o&&s.setId(o.id),o.properties&&s.setProperties(o.properties,!0),s}readFeaturesFromObject(e,r){const o=e;let n=null;if(o.type==="FeatureCollection"){const s=e;n=[];const c=s.features;for(let p=0,u=c.length;p<u;++p){const l=this.readFeatureFromObject(c[p],r);l&&n.push(l)}}else n=[this.readFeatureFromObject(e,r)];return n.flat()}readGeometryFromObject(e,r){return Fr(e,r)}readProjectionFromObject(e){const r=e.crs;let o;if(r)if(r.type=="name")o=F(r.properties.name);else if(r.type==="EPSG")o=F("EPSG:"+r.properties.code);else throw new Error("Unknown SRS type");else o=this.dataProjection;return o}writeFeatureObject(e,r){r=this.adaptOptions(r);const o={type:"Feature",geometry:null,properties:null},n=e.getId();if(n!==void 0&&(o.id=n),!e.hasProperties())return o;const s=e.getProperties(),c=e.getGeometry();return c&&(o.geometry=ie(c,r),delete s[e.getGeometryName()]),St(s)||(o.properties=s),o}writeFeaturesObject(e,r){r=this.adaptOptions(r);const o=[];for(let n=0,s=e.length;n<s;++n)o.push(this.writeFeatureObject(e[n],r));return{type:"FeatureCollection",features:o}}writeGeometryObject(e,r){return ie(e,this.adaptOptions(r))}}function de(t,e){if(!t)return null;let r;switch(t.type){case"Point":{r=Nr(t);break}case"LineString":{r=Gr(t);break}case"Polygon":{r=Ar(t);break}case"MultiPoint":{r=Tr(t);break}case"MultiLineString":{r=Er(t);break}case"MultiPolygon":{r=kr(t);break}case"GeometryCollection":{r=Lr(t);break}default:throw new Error("Unsupported GeoJSON type: "+t.type)}return r}function Fr(t,e){const r=de(t);return ue(r,e)}function Lr(t,e){return t.geometries.map(function(o){return de(o)})}function Nr(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:I(e.length)}}function Gr(t){const e=t.coordinates,r=e.flat();return{type:"LineString",flatCoordinates:r,ends:[r.length],layout:I(e[0]?.length||2)}}function Er(t){const e=t.coordinates,r=e[0]?.[0]?.length||2,o=[],n=Ne(o,0,e,r);return{type:"MultiLineString",flatCoordinates:o,ends:n,layout:I(r)}}function Tr(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:I(e[0]?.length||2)}}function kr(t){const e=t.coordinates,r=[],o=e[0]?.[0]?.[0].length||2,n=Ot(r,0,e,o);return{type:"MultiPolygon",flatCoordinates:r,ends:n,layout:I(o)}}function Ar(t){const e=t.coordinates,r=[],o=e[0]?.[0]?.length,n=Ne(r,0,e,o);return{type:"Polygon",flatCoordinates:r,ends:n,layout:I(o)}}function ie(t,e){t=ce(t,!0,e);const r=t.getType();let o;switch(r){case"Point":{o=Hr(t);break}case"LineString":{o=Rr(t);break}case"Polygon":{o=Jr(t,e);break}case"MultiPoint":{o=Br(t);break}case"MultiLineString":{o=_r(t);break}case"MultiPolygon":{o=Dr(t,e);break}case"GeometryCollection":{o=Ir(t,e);break}case"Circle":{o={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+r)}return o}function Ir(t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(o){return ie(o,e)})}}function Rr(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function _r(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function Br(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function Dr(t,e){let r;return e&&(r=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(r)}}function Hr(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function Jr(t,e){let r;return e&&(r=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(r)}}const Vr=Qt({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"}),xo=i.forwardRef(function(e,r){const{label:o,icon:n,onClick:s,isLoading:c,isDisabled:p,isActive:u,tooltipProps:l,buttonProps:f}=e,{containerProps:{className:P,...y}}=Ge("tool-button",e),C=Ee(P,{"tool-button--active":u,"tool-button--loading":c,"tool-button--disabled":p}),j=typeof u=="boolean"?u?"true":"false":void 0,[M,m]=i.useState(!1),g=h=>{m(!1),s?.(h)};return a.jsx(Ae,{label:o,placement:"auto",openDelay:500,...l,isOpen:M,onOpen:()=>m(!0),onClose:()=>m(!1),children:a.jsx(Ur,{className:C,ref:r,"aria-label":o,leftIcon:n,iconSpacing:0,padding:0,isDisabled:p,isLoading:c,isActive:u,"aria-pressed":j,...y,...f,onClick:g})})}),Ur=i.forwardRef(function(e,r){const{"aria-labelledby":o,"aria-describedby":n,...s}=e;return a.jsx(le,{ref:r,...s})}),zr="@open-pioneer/toc",Q=Mt.bind(void 0,zr),qe=i.createContext(void 0),Wr=qe.Provider;function $r(){const t=i.useContext(qe);if(!t)throw new Error("useTocWidgetOptions must be used within a TocWidgetOptionsProvider");return t}const Ze=i.createContext(void 0),Qe=i.forwardRef((t,e)=>{const{map:r,"aria-label":o}=t,n=i.useRef();n.current||(n.current=new Map);const s=i.useMemo(()=>({registerExpandedState(l,f){n.current.set(l,f)},unregisterExpandedState(l){n.current.delete(l)}}),[]),c=Xr(n.current),p=Q(),u=qr(r);return i.useImperativeHandle(e,()=>({listItemsExpandedModel:c})),u.length?a.jsx(Ze.Provider,{value:s,children:Xe(u,{"aria-label":o})}):a.jsx(ae,{className:"toc-missing-layers","aria-label":o,children:p.formatMessage({id:"missingLayers"})})});Qe.displayName="LayerList";function Xe(t,e){const r=t.map(n=>a.jsx(Kr,{layer:n},n.id));return a.jsx(J,{children:a.jsx(Xt,{as:"ul",className:"toc-layer-list",listStyleType:"none",role:"group",...e,children:r})})}function Kr(t){const{layer:e}=t,r=Q(),o=$r(),n=i.useId(),{title:s,description:c,isVisible:p}=Z(()=>({title:e.title,description:e.description,isVisible:e.visible}),[e]),u=Zr(e),l=tt(e)!=="error",f=r.formatMessage({id:"layerNotAvailable"}),P=o?o.isCollapsed:!0,[y,C]=i.useState(!P),j=i.useContext(Ze),M=o?o.collapsibleGroups:!1,m=Wt(h=>{C(h)});i.useEffect(()=>{if(j)return j.registerExpandedState(e.id,{layerId:e.id,isExpanded:y,setExpanded:m}),()=>j.unregisterExpandedState(e.id)},[e,j,m,y]);let g;return u?.length&&(g=Xe(u,{ml:4,"aria-label":r.formatMessage({id:"childgroupLabel"},{title:s})})),a.jsxs(J,{as:"li",className:Ee("toc-layer-item",`layer-${Qr(e.id)}`),children:[a.jsxs(se,{className:"toc-layer-item-content",width:"100%",flexDirection:"row",align:"center",justifyContent:"space-between",gap:2,minHeight:10,children:[a.jsx(Kt,{variant:"ghost",borderRadius:"full",padding:0,className:"toc-layer-item-collapse-button",onClick:()=>C(!y),icon:y?a.jsx(Yt,{}):a.jsx(Vr,{}),"aria-label":y?r.formatMessage({id:"group.collapse"},{title:s}):r.formatMessage({id:"group.expand"},{title:s}),"aria-expanded":y,"aria-controls":n,visibility:g&&M?"visible":"hidden"}),a.jsx(er,{"aria-label":s+(l?"":" "+f),isChecked:p,isDisabled:!l,onChange:h=>et(e,h.target.checked,o.autoShowParents),children:s}),!l&&a.jsx(Ae,{className:"toc-layer-item-content-tooltip",label:f,placement:"right",openDelay:500,children:a.jsx("span",{children:a.jsx($t,{className:"toc-layer-item-content-icon",color:"red","aria-label":f})})}),a.jsx(_e,{}),c&&a.jsx(Yr,{layer:e,title:s,description:c,intl:r})]}),g&&a.jsx(De,{in:y,id:n,className:"toc-collapsible-item",children:g})]})}function et(t,e,r){t.setVisible(e),e&&r&&t.parent&&et(t.parent,!0,!0)}function Yr(t){const{layer:e,title:r,description:o,intl:n}=t,s=n.formatMessage({id:"descriptionLabel"}),c=tt(e)!=="error";return a.jsxs(He,{placement:"bottom-start",children:[a.jsx(Ke,{children:a.jsx(le,{isDisabled:!c,className:"toc-layer-item-details-button","aria-label":s,borderRadius:"full",iconSpacing:0,padding:0,variant:"ghost",leftIcon:a.jsx(Re,{})})}),a.jsx(Ie,{children:a.jsxs(We,{className:"toc-layer-item-details",overflowY:"auto",maxHeight:"400",children:[a.jsx(Je,{}),a.jsx(Ue,{mt:1}),a.jsx($e,{children:r}),a.jsx(Ve,{children:o})]})})]})}function qr(t){return Z(()=>{const e=t.layers.getOperationalLayers({sortByDisplayOrder:!0})??[];return e.reverse(),e},[t])}function Zr(t){return Z(()=>{const e=t.children?.getItems({sortByDisplayOrder:!0});return e?.reverse(),e},[t])}function tt(t){return Z(()=>(wr(t)?t.parentLayer:t).loadState,[t])}function Qr(t){return t.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function Xr(t){return i.useMemo(()=>({isExpanded(r){if(t.has(r))return t.get(r)?.isExpanded},setExpanded(r,o){t.get(r)?.setExpanded(o)},getAllExpandedStates(){return Array.from(t.values())}}),[t])}const eo=t=>{const e=Q(),{map:r,listItemsExpandedModel:o,showHideAllLayers:n=!0,showCollapseAllGroups:s=!0}=t;return!(!n&&!s)&&a.jsx(J,{className:"toc-tools",children:a.jsxs(ar,{placement:"bottom-start",children:[a.jsx(qt,{as:le,className:"toc-tools-button","aria-label":e.formatMessage({id:"toolsLabel"}),borderRadius:"full",iconSpacing:0,padding:3,variant:"ghost",leftIcon:a.jsx(Re,{})}),a.jsx(Ie,{children:a.jsxs(Zt,{className:"tools-menu",children:[n&&a.jsx(je,{"aria-label":e.formatMessage({id:"tools.hideAllLayers"}),onClick:()=>{to(r)},children:e.formatMessage({id:"tools.hideAllLayers"})}),s&&a.jsx(je,{"aria-label":e.formatMessage({id:"tools.collapseAllGroups"}),onClick:()=>{ro(o)},children:e.formatMessage({id:"tools.collapseAllGroups"})})]})})]})})};function to(t){const e=r=>{r.setVisible(!1);const o=r.children?.getItems();if(o)for(const n of o)e(n)};t?.layers.getOperationalLayers().forEach(r=>{e(r)})}function ro(t){t&&t.getAllExpandedStates().forEach(e=>e.setExpanded(!1))}const Me=2,vo=t=>{const e=Q(),[r,o]=i.useState(t.isCollapsed||!1),{showTools:n=!1,toolsConfig:s,showBasemapSwitcher:c=!0,basemapSwitcherProps:p,collapsibleGroups:u=!1,autoShowParents:l=!0}=t,{containerProps:f}=Ge("toc",t),P=i.useId(),y=i.useMemo(()=>({autoShowParents:l,collapsibleGroups:u,isCollapsed:r}),[l,u,r]),C=Ft(t),[j,M]=i.useState(),m=i.useCallback(S=>{S&&M(S.listItemsExpandedModel)},[]),g=s?s.showCollapseAllGroups&&y.collapsibleGroups:y.collapsibleGroups;!y.collapsibleGroups&&r&&o(!1);let h;switch(C.kind){case"loading":h=null;break;case"rejected":h=a.jsx(ae,{className:"toc-error",children:e.formatMessage({id:"error"})});break;case"resolved":{const S=C.map,X=c&&a.jsx(J,{className:"toc-basemap-switcher",children:a.jsx(xe,{title:a.jsx(ve,{id:P,size:"sm",mb:Me,children:e.formatMessage({id:"basemapsLabel"})}),children:a.jsx(zt,{map:S,"aria-labelledby":P,...p})})}),_=a.jsx(J,{className:"toc-operational-layers",children:a.jsx(xe,{title:a.jsx(ve,{size:"sm",mb:2,children:a.jsxs(se,{children:[a.jsx(ae,{my:3,children:e.formatMessage({id:"operationalLayerLabel"})}),a.jsx(_e,{}),n&&a.jsx(eo,{map:S,listItemsExpandedModel:j,showHideAllLayers:s?.showHideAllLayers,showCollapseAllGroups:g})]})}),children:a.jsx(Qe,{map:S,"aria-label":e.formatMessage({id:"operationalLayerLabel"}),ref:m})})});h=a.jsxs(a.Fragment,{children:[X,_]});break}}return a.jsx(se,{...f,direction:"column",gap:Me,children:a.jsx(Wr,{value:y,children:h})})};export{Cr as F,Po as G,He as P,xo as T,Ke as a,We as b,Je as c,Ve as d,vo as e,bo as i,ce as t,G as u};
