import{a_ as Fe,af as F,bR as x,ay as ht,bS as bt,ak as Me,an as Pt,am as xt,bT as vt,bU as wt,bV as jt,bW as Ct,ac as Ot,bX as E,bY as Ne,bZ as St,aZ as Ge,b3 as Le,u as Ft,r as Mt,k as ne,i as Nt,e as Gt,g as Pe,h as xe}from"./j0mck_Meu7Xh.js";import{G as Lt,a as Tt,b as It,M as kt}from"./BWf1FusGPLsb.js";import{L as At}from"./ajAX9OmvUsbZ.js";import{J as Et,r as i,j as s,K as Rt,L as Te,l as R,k as Ie,M as _t,N as Bt,O as re,P as D,Q as S,u as Dt,o as Ht,R as Jt,w as Vt,g as A,h as V,D as Ut,T as zt,U as $t,q as ke,b as ie,B as H,F as Ae}from"./B60Dx_GOYdnk.js";import{u as J,B as Wt}from"./DSjrbd_eKbZM.js";import{F as Kt,f as Ee}from"./2C0geDG_OBHU.js";import{I as Yt,S as Re}from"./BXfBNJYYR7xb.js";import{C as qt,a as Zt,b as Qt,M as ve}from"./CMfwYEDRd35m.js";import{c as Xt}from"./BlACKGYldMfy.js";import{T as se,L as er}from"./BKR6R-cAnIXt.js";import{C as tr}from"./CG5nmvkyugDn.js";import{u as rr,a as or,b as nr,c as sr,l as ar,i as we,M as ir}from"./C9VJq5Ka7299.js";const lr=t=>{const{condition:e,message:r}=t};function cr(t){return"current"in t}const _e=()=>typeof window<"u";function ur(){return navigator.userAgentData?.platform??navigator.platform}const dr=t=>_e()&&t.test(navigator.vendor),pr=t=>_e()&&t.test(ur()),mr=()=>pr(/mac|iphone|ipad|ipod/i),fr=()=>mr()&&dr(/apple/i);function gr(t){const{ref:e,elements:r,enabled:o}=t,n=()=>e.current?.ownerDocument??document;Et(n,"pointerdown",a=>{if(!fr()||!o)return;const c=a.composedPath?.()?.[0]??a.target,f=(r??[e]).some(l=>{const y=cr(l)?l.current:l;return y?.contains(c)||y===c});n().activeElement!==c&&f&&(a.preventDefault(),c.focus())})}const k={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},bo={enter:{duration:.2,ease:k.easeOut},exit:{duration:.1,ease:k.easeIn}},je={enter:(t,e)=>({...t,delay:typeof e=="number"?e:e?.enter}),exit:(t,e)=>({...t,delay:typeof e=="number"?e:e?.exit})},yr=t=>t!=null&&parseInt(t.toString(),10)>0,Ce={exit:{height:{duration:.2,ease:k.ease},opacity:{duration:.3,ease:k.ease}},enter:{height:{duration:.3,ease:k.ease},opacity:{duration:.4,ease:k.ease}}},hr={exit:({animateOpacity:t,startingHeight:e,transition:r,transitionEnd:o,delay:n})=>({...t&&{opacity:yr(e)?1:0},height:e,transitionEnd:o?.exit,transition:r?.exit??je.exit(Ce.exit,n)}),enter:({animateOpacity:t,endingHeight:e,transition:r,transitionEnd:o,delay:n})=>({...t&&{opacity:1},height:e,transitionEnd:o?.enter,transition:r?.enter??je.enter(Ce.enter,n)})},Be=i.forwardRef((t,e)=>{const{in:r,unmountOnExit:o,animateOpacity:n=!0,startingHeight:a=0,endingHeight:c="auto",style:m,className:f,transition:l,transitionEnd:y,animatePresenceProps:b,...v}=t,[O,w]=i.useState(!1);i.useEffect(()=>{const L=setTimeout(()=>{w(!0)});return()=>clearTimeout(L)},[]),lr({condition:Number(a)>0&&!!o,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const j=parseFloat(a.toString())>0,u={startingHeight:a,endingHeight:c,animateOpacity:n,transition:O?l:{enter:{duration:0}},transitionEnd:{enter:y?.enter,exit:o?y?.exit:{...y?.exit,display:j?"block":"none"}}},p=o?r:!0,g=r||o?"enter":"exit";return s.jsx(Rt,{...b,initial:!1,custom:u,children:p&&s.jsx(Te.div,{ref:e,...v,className:R("chakra-collapse",f),style:{overflow:"hidden",display:"block",...m},custom:u,variants:hr,initial:o?"exit":!1,animate:g,exit:"exit"})})});Be.displayName="Collapse";const[br,G]=Ie({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[Pr,U]=Ie({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `}),I={click:"click",hover:"hover"};function xr(t={}){const{closeOnBlur:e=!0,closeOnEsc:r=!0,initialFocusRef:o,id:n,returnFocusOnClose:a=!0,autoFocus:c=!0,arrowSize:m,arrowShadowColor:f,trigger:l=I.click,openDelay:y=200,closeDelay:b=200,isLazy:v,lazyBehavior:O="unmount",computePositionOnMount:w,...j}=t,{isOpen:u,onClose:p,onOpen:g,onToggle:L}=_t(t),[tt,Q]=i.useState(a);i.useEffect(()=>Q(a),[a]);const X=i.useRef(null),_=i.useRef(null),M=i.useRef(null),B=i.useRef(!1),de=i.useRef(!1);u&&(de.current=!0);const[pe,rt]=i.useState(!1),[me,ot]=i.useState(!1),nt=i.useId(),st=n??nt,[fe,z,$,W]=["popover-trigger","popover-content","popover-header","popover-body"].map(d=>`${d}-${st}`),{referenceRef:K,getArrowProps:at,getPopperProps:ge,getArrowInnerProps:it,forceUpdate:lt}=Bt({...j,enabled:u||!!w}),ye=rr({isOpen:u,ref:M});gr({enabled:u,ref:_}),or(M,{focusRef:_,visible:u,shouldFocus:tt&&l===I.click}),nr(M,{focusRef:o,visible:u,shouldFocus:c&&l===I.click}),sr({enabled:u&&e,ref:M,handler(d){const P=d.composedPath?.()[0]??[d.target];Y(_.current,P)||(P&&Q(!we(P)),p())}});const he=ar({wasSelected:de.current,enabled:v,mode:O,isSelected:ye.present}),ct=i.useCallback((d={},P=null)=>{const h={...d,style:{...d.style,transformOrigin:re.transformOrigin.varRef,[re.arrowSize.var]:m?`${m}px`:void 0,[re.arrowShadowColor.var]:f},ref:D(M,P),children:he?d.children:null,id:z,tabIndex:-1,role:"dialog",onKeyDown:S(d.onKeyDown,C=>{C.nativeEvent.isComposing||r&&C.key==="Escape"&&(C.preventDefault(),C.stopPropagation(),p())}),onBlur:S(d.onBlur,C=>{const T=Oe(C),te=Y(M.current,T),gt=Y(_.current,T),yt=!te&&!gt;T&&Q(!we(T)),u&&e&&yt&&p()}),"aria-labelledby":pe?$:void 0,"aria-describedby":me?W:void 0};return l===I.hover&&(h.role="tooltip",h.onMouseEnter=S(d.onMouseEnter,()=>{B.current=!0}),h.onMouseLeave=S(d.onMouseLeave,C=>{C.nativeEvent.relatedTarget!==null&&(B.current=!1,setTimeout(()=>p(),b))})),h},[he,z,pe,$,me,W,l,r,p,u,e,b,f,m]),ut=i.useCallback((d={},P=null)=>ge({...d,style:{visibility:u?"visible":"hidden",...d.style}},P),[u,ge]),dt=i.useCallback((d,P=null)=>({...d,ref:D(P,X,K)}),[X,K]),N=i.useRef(),ee=i.useRef(),be=i.useCallback(d=>{X.current==null&&K(d)},[K]),pt=i.useCallback((d={},P=null)=>{const h={...d,ref:D(_,P,be),id:fe,"aria-haspopup":"dialog","aria-expanded":u,"aria-controls":z};return l===I.click&&(h.onClick=S(d.onClick,L)),l===I.hover&&(h.onFocus=S(d.onFocus,()=>{N.current===void 0&&g()}),h.onBlur=S(d.onBlur,C=>{const T=Oe(C),te=!Y(M.current,T);u&&e&&te&&p()}),h.onKeyDown=S(d.onKeyDown,C=>{C.key==="Escape"&&p()}),h.onMouseEnter=S(d.onMouseEnter,()=>{B.current=!0,N.current=window.setTimeout(()=>g(),y)}),h.onMouseLeave=S(d.onMouseLeave,()=>{B.current=!1,N.current&&(clearTimeout(N.current),N.current=void 0),ee.current=window.setTimeout(()=>{B.current===!1&&p()},b)})),h},[fe,u,z,l,be,L,g,e,p,y,b]);i.useEffect(()=>()=>{N.current&&clearTimeout(N.current),ee.current&&clearTimeout(ee.current)},[]);const mt=i.useCallback((d={},P=null)=>({...d,id:$,ref:D(P,h=>{rt(!!h)})}),[$]),ft=i.useCallback((d={},P=null)=>({...d,id:W,ref:D(P,h=>{ot(!!h)})}),[W]);return{forceUpdate:lt,isOpen:u,onAnimationComplete:ye.onComplete,onClose:p,getAnchorProps:dt,getArrowProps:at,getArrowInnerProps:it,getPopoverPositionerProps:ut,getPopoverProps:ct,getTriggerProps:pt,getHeaderProps:mt,getBodyProps:ft}}function Y(t,e){return t===e||t?.contains(e)}function Oe(t){const e=t.currentTarget.ownerDocument.activeElement;return t.relatedTarget??e}function De(t){const e=Dt("Popover",t),{children:r,...o}=Ht(t),n=Jt(),a=xr({...o,direction:n.direction});return s.jsx(br,{value:a,children:s.jsx(Pr,{value:e,children:Vt(r,{isOpen:a.isOpen,onClose:a.onClose,forceUpdate:a.forceUpdate})})})}De.displayName="Popover";const oe=(t,e)=>e?`${t}.${e}, ${e}`:void 0;function He(t){const{bg:e,bgColor:r,backgroundColor:o,shadow:n,boxShadow:a,shadowColor:c,...m}=t,{getArrowProps:f,getArrowInnerProps:l}=G(),y=U(),b=e??r??o,v=n??a;return s.jsx(A.div,{...f(),className:"chakra-popover__arrow-positioner",children:s.jsx(A.div,{className:R("chakra-popover__arrow",t.className),...l(m),__css:{"--popper-arrow-shadow-color":oe("colors",c),"--popper-arrow-bg":oe("colors",b),"--popper-arrow-shadow":oe("shadows",v),...y.arrow}})})}He.displayName="PopoverArrow";const Je=V(function(e,r){const{getBodyProps:o}=G(),n=U();return s.jsx(A.div,{...o(e,r),className:R("chakra-popover__body",e.className),__css:n.body})});Je.displayName="PopoverBody";const Ve=V(function(e,r){const{onClose:o}=G(),n=U();return s.jsx(Ut,{size:"sm",onClick:o,className:R("chakra-popover__close-btn",e.className),__css:n.closeButton,ref:r,...e})});Ve.displayName="PopoverCloseButton";function vr(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}const wr={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},jr=A(Te.section),Ue=V(function(e,r){const{variants:o=wr,...n}=e,{isOpen:a}=G();return s.jsx(jr,{ref:r,variants:vr(o),initial:!1,animate:a?"enter":"exit",...n})});Ue.displayName="PopoverTransition";const ze=V(function(e,r){const{rootProps:o,motionProps:n,...a}=e,{getPopoverProps:c,getPopoverPositionerProps:m,onAnimationComplete:f}=G(),l=U(),y=zt({position:"relative",display:"flex",flexDirection:"column",...l.content});return s.jsx(A.div,{...m(o),__css:l.popper,className:"chakra-popover__popper",children:s.jsx(Ue,{...n,...c(a,r),onAnimationComplete:$t(f,a.onAnimationComplete),className:R("chakra-popover__content",e.className),__css:y})})});ze.displayName="PopoverContent";const $e=V(function(e,r){const{getHeaderProps:o}=G(),n=U();return s.jsx(A.header,{...o(e,r),className:R("chakra-popover__header",e.className),__css:n.header})});$e.displayName="PopoverHeader";function We(t){const e=i.Children.only(t.children),{getTriggerProps:r}=G();return s.jsx(s.Fragment,{children:i.cloneElement(e,r(e.props,e.ref))})}We.displayName="PopoverTrigger";function Cr(t){return"parentLayer"in t}function Po(t){return"olLayer"in t}class Or{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Fe,this.supportedMediaTypes=null}getReadOptions(e,r){if(r){let o=r.dataProjection?F(r.dataProjection):this.readProjection(e);r.extent&&o&&o.getUnits()==="tile-pixels"&&(o=F(o),o.setWorldExtent(r.extent)),r={dataProjection:o,featureProjection:r.featureProjection}}return this.adaptOptions(r)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return x()}readFeature(e,r){return x()}readFeatures(e,r){return x()}readGeometry(e,r){return x()}readProjection(e){return x()}writeFeature(e,r){return x()}writeFeatures(e,r){return x()}writeGeometry(e,r){return x()}}function le(t,e,r){const o=r?F(r.featureProjection):null,n=r?F(r.dataProjection):null;let a=t;if(o&&n&&!ht(o,n)){e&&(a=t.clone());const c=e?o:n,m=e?n:o;c.getUnits()==="tile-pixels"?a.transform(c,m):a.applyTransform(bt(c,m))}if(e&&r&&r.decimals!==void 0){const c=Math.pow(10,r.decimals),m=function(f){for(let l=0,y=f.length;l<y;++l)f[l]=Math.round(f[l]*c)/c;return f};a===t&&(a=t.clone()),a.applyTransform(m)}return a}const Sr={Point:Pt,LineString:At,Polygon:xt,MultiPoint:Tt,MultiLineString:It,MultiPolygon:kt};function Fr(t,e,r){return Array.isArray(e[0])?(vt(t,0,e,r)||(t=t.slice(),wt(t,0,e,r)),t):(jt(t,0,e,r)||(t=t.slice(),Ct(t,0,e,r)),t)}function Ke(t,e){const r=t.geometry;if(!r)return[];if(Array.isArray(r))return r.map(a=>Ke({...t,geometry:a})).flat();const o=r.type==="MultiPolygon"?"Polygon":r.type;if(o==="GeometryCollection"||o==="Circle")throw new Error("Unsupported geometry type: "+o);const n=r.layout.length;return le(new Me(o,o==="Polygon"?Fr(r.flatCoordinates,r.ends,n):r.flatCoordinates,r.ends?.flat(),n,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function ce(t,e){if(!t)return null;if(Array.isArray(t)){const o=t.map(n=>ce(n,e));return new Lt(o)}const r=Sr[t.type];return le(new r(t.flatCoordinates,t.layout,t.ends),!1,e)}class Mr extends Or{constructor(){super()}getType(){return"json"}readFeature(e,r){return this.readFeatureFromObject(q(e),this.getReadOptions(e,r))}readFeatures(e,r){return this.readFeaturesFromObject(q(e),this.getReadOptions(e,r))}readFeatureFromObject(e,r){return x()}readFeaturesFromObject(e,r){return x()}readGeometry(e,r){return this.readGeometryFromObject(q(e),this.getReadOptions(e,r))}readGeometryFromObject(e,r){return x()}readProjection(e){return this.readProjectionFromObject(q(e))}readProjectionFromObject(e){return x()}writeFeature(e,r){return JSON.stringify(this.writeFeatureObject(e,r))}writeFeatureObject(e,r){return x()}writeFeatures(e,r){return JSON.stringify(this.writeFeaturesObject(e,r))}writeFeaturesObject(e,r){return x()}writeGeometry(e,r){return JSON.stringify(this.writeGeometryObject(e,r))}writeGeometryObject(e,r){return x()}}function q(t){if(typeof t=="string"){const e=JSON.parse(t);return e||null}return t!==null?t:null}class xo extends Mr{constructor(e){e=e||{},super(),this.dataProjection=F(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=F(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,r){let o=null;e.type==="Feature"?o=e:o={type:"Feature",geometry:e,properties:null};const n=ue(o.geometry);if(this.featureClass===Me)return Ke({geometry:n,id:o.id,properties:o.properties},r);const a=new Fe;return this.geometryName_?a.setGeometryName(this.geometryName_):this.extractGeometryName_&&o.geometry_name&&a.setGeometryName(o.geometry_name),a.setGeometry(ce(n,r)),"id"in o&&a.setId(o.id),o.properties&&a.setProperties(o.properties,!0),a}readFeaturesFromObject(e,r){const o=e;let n=null;if(o.type==="FeatureCollection"){const a=e;n=[];const c=a.features;for(let m=0,f=c.length;m<f;++m){const l=this.readFeatureFromObject(c[m],r);l&&n.push(l)}}else n=[this.readFeatureFromObject(e,r)];return n.flat()}readGeometryFromObject(e,r){return Nr(e,r)}readProjectionFromObject(e){const r=e.crs;let o;if(r)if(r.type=="name")o=F(r.properties.name);else if(r.type==="EPSG")o=F("EPSG:"+r.properties.code);else throw new Error("Unknown SRS type");else o=this.dataProjection;return o}writeFeatureObject(e,r){r=this.adaptOptions(r);const o={type:"Feature",geometry:null,properties:null},n=e.getId();if(n!==void 0&&(o.id=n),!e.hasProperties())return o;const a=e.getProperties(),c=e.getGeometry();return c&&(o.geometry=ae(c,r),delete a[e.getGeometryName()]),Ot(a)||(o.properties=a),o}writeFeaturesObject(e,r){r=this.adaptOptions(r);const o=[];for(let n=0,a=e.length;n<a;++n)o.push(this.writeFeatureObject(e[n],r));return{type:"FeatureCollection",features:o}}writeGeometryObject(e,r){return ae(e,this.adaptOptions(r))}}function ue(t,e){if(!t)return null;let r;switch(t.type){case"Point":{r=Lr(t);break}case"LineString":{r=Tr(t);break}case"Polygon":{r=Er(t);break}case"MultiPoint":{r=kr(t);break}case"MultiLineString":{r=Ir(t);break}case"MultiPolygon":{r=Ar(t);break}case"GeometryCollection":{r=Gr(t);break}default:throw new Error("Unsupported GeoJSON type: "+t.type)}return r}function Nr(t,e){const r=ue(t);return ce(r,e)}function Gr(t,e){return t.geometries.map(function(o){return ue(o)})}function Lr(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:E(e.length)}}function Tr(t){const e=t.coordinates,r=e.flat();return{type:"LineString",flatCoordinates:r,ends:[r.length],layout:E(e[0]?.length||2)}}function Ir(t){const e=t.coordinates,r=e[0]?.[0]?.length||2,o=[],n=Ne(o,0,e,r);return{type:"MultiLineString",flatCoordinates:o,ends:n,layout:E(r)}}function kr(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:E(e[0]?.length||2)}}function Ar(t){const e=t.coordinates,r=[],o=e[0]?.[0]?.[0].length||2,n=St(r,0,e,o);return{type:"MultiPolygon",flatCoordinates:r,ends:n,layout:E(o)}}function Er(t){const e=t.coordinates,r=[],o=e[0]?.[0]?.length,n=Ne(r,0,e,o);return{type:"Polygon",flatCoordinates:r,ends:n,layout:E(o)}}function ae(t,e){t=le(t,!0,e);const r=t.getType();let o;switch(r){case"Point":{o=Jr(t);break}case"LineString":{o=_r(t);break}case"Polygon":{o=Vr(t,e);break}case"MultiPoint":{o=Dr(t);break}case"MultiLineString":{o=Br(t);break}case"MultiPolygon":{o=Hr(t,e);break}case"GeometryCollection":{o=Rr(t,e);break}case"Circle":{o={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+r)}return o}function Rr(t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(o){return ae(o,e)})}}function _r(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function Br(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function Dr(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function Hr(t,e){let r;return e&&(r=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(r)}}function Jr(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function Vr(t,e){let r;return e&&(r=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(r)}}const Ur=Xt({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"}),vo=i.forwardRef(function(e,r){const{label:o,icon:n,onClick:a,isLoading:c,isDisabled:m,isActive:f,tooltipProps:l,buttonProps:y}=e,{containerProps:{className:b,...v}}=Ge("tool-button",e),O=Le(b,{"tool-button--active":f,"tool-button--loading":c,"tool-button--disabled":m}),w=typeof f=="boolean"?f?"true":"false":void 0,[j,u]=i.useState(!1),p=g=>{u(!1),a?.(g)};return s.jsx(ke,{label:o,placement:"auto",openDelay:500,...l,isOpen:j,onOpen:()=>u(!0),onClose:()=>u(!1),children:s.jsx(zr,{className:O,ref:r,"aria-label":o,leftIcon:n,iconSpacing:0,padding:0,isDisabled:m,isLoading:c,isActive:f,"aria-pressed":w,...v,...y,onClick:p})})}),zr=i.forwardRef(function(e,r){const{"aria-labelledby":o,"aria-describedby":n,...a}=e;return s.jsx(ie,{ref:r,...a})}),$r="@open-pioneer/toc",Z=Ft.bind(void 0,$r),Ye=i.createContext(void 0),Wr=Ye.Provider;function Kr(){const t=i.useContext(Ye);if(!t)throw new Error("useTocWidgetOptions must be used within a TocWidgetOptionsProvider");return t}const qe=i.createContext(void 0),Yr=qe.Provider;function Ze(){const t=i.useContext(qe);if(!t)throw new Error("Internal error: TocModel not found in context");return t}const qr=i.memo(function(e){const{map:r,"aria-label":o}=e,n=Z(),a=Xr(r);return a.length?Qe(a,{"aria-label":o}):s.jsx(se,{className:"toc-missing-layers","aria-label":o,children:n.formatMessage({id:"missingLayers"})})});function Qe(t,e){const r=t.map(n=>s.jsx(Zr,{layer:n},n.id));return s.jsx(H,{children:s.jsx(er,{as:"ul",className:"toc-layer-list",listStyleType:"none",role:"group",...e,children:r})})}function Zr(t){const{layer:e}=t,r=Z(),o=Kr(),n=Ze(),a=i.useId(),c=eo(e),m=et(e)!=="error",f=r.formatMessage({id:"layerNotAvailable"}),{title:l,description:y,isVisible:b}=J(()=>({title:e.title,description:e.description,isVisible:e.visible}),[e]),v=o?o.collapsibleGroups:!1,O=o?.isCollapsed??!0,w=i.useMemo(()=>{const p=Mt(!O);return{layerId:e.id,get isExpanded(){return p.value},setExpanded(g){p.value=g}}},[e,O]);i.useEffect(()=>(n.registerItem(w),()=>n.unregisterItem(w)),[n,w]);const j=J(()=>w.isExpanded,[w]);let u;return c?.length&&(u=Qe(c,{ml:4,"aria-label":r.formatMessage({id:"childgroupLabel"},{title:l})})),s.jsxs(H,{as:"li",className:Le("toc-layer-item",`layer-${to(e.id)}`),children:[s.jsxs(ne,{className:"toc-layer-item-content",width:"100%",flexDirection:"row",align:"center",justifyContent:"space-between",gap:2,minHeight:10,children:[v&&s.jsx(Yt,{variant:"ghost",borderRadius:"full",padding:0,className:"toc-layer-item-collapse-button",onClick:()=>w.setExpanded(!j),icon:j?s.jsx(qt,{}):s.jsx(Ur,{}),"aria-label":j?r.formatMessage({id:"group.collapse"},{title:l}):r.formatMessage({id:"group.expand"},{title:l}),"aria-expanded":j,"aria-controls":a,visibility:u?"visible":"hidden"}),s.jsx(tr,{"aria-label":l+(m?"":" "+f),isChecked:b,isDisabled:!m,onChange:p=>Xe(e,p.target.checked,o.autoShowParents),children:l}),!m&&s.jsx(ke,{className:"toc-layer-item-content-tooltip",label:f,placement:"right",openDelay:500,children:s.jsx("span",{children:s.jsx(Kt,{className:"toc-layer-item-content-icon",color:"red","aria-label":f})})}),s.jsx(Re,{}),y&&s.jsx(Qr,{layer:e,title:l,description:y,intl:r})]}),u&&s.jsx(Be,{in:j,id:a,className:"toc-collapsible-item",children:u})]})}function Xe(t,e,r){t.setVisible(e),e&&r&&t.parent&&Xe(t.parent,!0,!0)}function Qr(t){const{layer:e,title:r,description:o,intl:n}=t,a=n.formatMessage({id:"descriptionLabel"}),c=et(e)!=="error";return s.jsxs(De,{placement:"bottom-start",children:[s.jsx(We,{children:s.jsx(ie,{isDisabled:!c,className:"toc-layer-item-details-button","aria-label":a,borderRadius:"full",iconSpacing:0,padding:0,variant:"ghost",leftIcon:s.jsx(Ee,{})})}),s.jsx(Ae,{children:s.jsxs(ze,{className:"toc-layer-item-details",overflowY:"auto",maxHeight:"400",children:[s.jsx(He,{}),s.jsx(Ve,{mt:1}),s.jsx($e,{children:r}),s.jsx(Je,{children:o})]})})]})}function Xr(t){return J(()=>{const e=t.layers.getOperationalLayers({sortByDisplayOrder:!0})??[];return e.reverse(),e},[t])}function eo(t){return J(()=>{const e=t.children?.getItems({sortByDisplayOrder:!0});return e?.reverse(),e},[t])}function et(t){return J(()=>(Cr(t)?t.parentLayer:t).loadState,[t])}function to(t){return t.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}const ro=i.memo(function(e){const r=Z(),{map:o,showHideAllLayers:n=!0,showCollapseAllGroups:a=!0}=e,c=Ze();return!(!n&&!a)&&s.jsx(H,{className:"toc-tools",children:s.jsxs(ir,{placement:"bottom-start",children:[s.jsx(Zt,{as:ie,className:"toc-tools-button","aria-label":r.formatMessage({id:"toolsLabel"}),borderRadius:"full",iconSpacing:0,padding:3,variant:"ghost",leftIcon:s.jsx(Ee,{})}),s.jsx(Ae,{children:s.jsxs(Qt,{className:"tools-menu",children:[n&&s.jsx(ve,{"aria-label":r.formatMessage({id:"tools.hideAllLayers"}),onClick:()=>{oo(o)},children:r.formatMessage({id:"tools.hideAllLayers"})}),a&&s.jsx(ve,{"aria-label":r.formatMessage({id:"tools.collapseAllGroups"}),onClick:()=>{no(c)},children:r.formatMessage({id:"tools.collapseAllGroups"})})]})})]})})});function oo(t){const e=r=>{r.setVisible(!1);const o=r.children?.getItems();if(o)for(const n of o)e(n)};t?.layers.getOperationalLayers().forEach(r=>{e(r)})}function no(t){t.getItems().forEach(e=>e.setExpanded(!1))}const Se=2,wo=t=>{const e=Z(),[r,o]=i.useState(t.isCollapsed||!1),{showTools:n=!1,toolsConfig:a,showBasemapSwitcher:c=!0,basemapSwitcherProps:m,collapsibleGroups:f=!1,autoShowParents:l=!0}=t,{containerProps:y}=Ge("toc",t),b=i.useId(),v=i.useMemo(()=>({autoShowParents:l,collapsibleGroups:f,isCollapsed:r}),[l,f,r]),O=Nt(t),w=a?a.showCollapseAllGroups&&v.collapsibleGroups:v.collapsibleGroups;!v.collapsibleGroups&&r&&o(!1);const j=i.useMemo(()=>{const p=Gt();return{getItem(g){return p.get(g)},getItems(){return Array.from(p.values())},registerItem(g){if(p.has(g.layerId))throw new Error(`Item with layerId '${g.layerId}' already registered.`);p.set(g.layerId,g)},unregisterItem(g){if(p.get(g.layerId)!==g)throw new Error(`Item with layerId '${g.layerId}' not registered.`);p.delete(g.layerId)}}},[]);let u;switch(O.kind){case"loading":u=null;break;case"rejected":u=s.jsx(se,{className:"toc-error",children:e.formatMessage({id:"error"})});break;case"resolved":{const p=O.map,g=c&&s.jsx(H,{className:"toc-basemap-switcher",children:s.jsx(Pe,{title:s.jsx(xe,{id:b,size:"sm",mb:Se,children:e.formatMessage({id:"basemapsLabel"})}),children:s.jsx(Wt,{map:p,"aria-labelledby":b,...m})})}),L=s.jsx(Yr,{value:j,children:s.jsx(H,{className:"toc-operational-layers",children:s.jsx(Pe,{title:s.jsx(xe,{size:"sm",mb:2,children:s.jsxs(ne,{children:[s.jsx(se,{my:3,children:e.formatMessage({id:"operationalLayerLabel"})}),s.jsx(Re,{}),n&&s.jsx(ro,{map:p,showHideAllLayers:a?.showHideAllLayers,showCollapseAllGroups:w})]})}),children:s.jsx(qr,{map:p,"aria-label":e.formatMessage({id:"operationalLayerLabel"})})})})});u=s.jsxs(s.Fragment,{children:[g,L]});break}}return s.jsx(ne,{...y,direction:"column",gap:Se,children:s.jsx(Wr,{value:v,children:u})})};export{Or as F,xo as G,De as P,vo as T,We as a,ze as b,He as c,Je as d,wo as e,Po as i,le as t,G as u};
