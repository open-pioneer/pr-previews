import{a_ as Me,af as M,bR as P,ay as ht,bS as bt,ak as Fe,an as Pt,am as xt,bT as vt,bU as jt,bV as wt,bW as Ct,ac as St,bX as I,bY as Le,bZ as Ot,aZ as Ne,b3 as Ge,u as Mt,k as ne,i as Ft,g as Pe,h as xe}from"./j0mck_Meu7Xh.js";import{G as Lt,a as Nt,b as Gt,M as Et}from"./BWf1FusGPLsb.js";import{L as Tt}from"./ajAX9OmvUsbZ.js";import{J as kt,r as i,j as s,K as At,L as Ee,l as R,k as Te,M as It,N as Rt,O as re,P as D,Q as C,u as _t,o as Bt,R as Dt,w as Ht,g as A,h as J,D as Jt,T as Vt,U as Ut,q as ke,b as ie,B as H,F as Ae}from"./B60Dx_GOYdnk.js";import{u as q,B as zt}from"./DSjrbd_eKbZM.js";import{u as Wt}from"./BpQSjk0kyblh.js";import{F as $t,f as Ie}from"./2C0geDG_OBHU.js";import{I as Kt,S as Re}from"./BXfBNJYYR7xb.js";import{C as Yt,a as qt,b as Zt,M as ve}from"./CMfwYEDRd35m.js";import{c as Qt}from"./BlACKGYldMfy.js";import{T as se,L as Xt}from"./BKR6R-cAnIXt.js";import{C as er}from"./CG5nmvkyugDn.js";import{u as tr,a as rr,b as or,c as nr,l as sr,i as je,M as ar}from"./C9VJq5Ka7299.js";const ir=t=>{const{condition:e,message:r}=t};function lr(t){return"current"in t}const _e=()=>typeof window<"u";function cr(){return navigator.userAgentData?.platform??navigator.platform}const ur=t=>_e()&&t.test(navigator.vendor),dr=t=>_e()&&t.test(cr()),pr=()=>dr(/mac|iphone|ipad|ipod/i),mr=()=>pr()&&ur(/apple/i);function fr(t){const{ref:e,elements:r,enabled:o}=t,n=()=>e.current?.ownerDocument??document;kt(n,"pointerdown",a=>{if(!mr()||!o)return;const l=a.composedPath?.()?.[0]??a.target,p=(r??[e]).some(c=>{const f=lr(c)?c.current:c;return f?.contains(l)||f===l});n().activeElement!==l&&p&&(a.preventDefault(),l.focus())})}const k={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},ho={enter:{duration:.2,ease:k.easeOut},exit:{duration:.1,ease:k.easeIn}},we={enter:(t,e)=>({...t,delay:typeof e=="number"?e:e?.enter}),exit:(t,e)=>({...t,delay:typeof e=="number"?e:e?.exit})},gr=t=>t!=null&&parseInt(t.toString(),10)>0,Ce={exit:{height:{duration:.2,ease:k.ease},opacity:{duration:.3,ease:k.ease}},enter:{height:{duration:.3,ease:k.ease},opacity:{duration:.4,ease:k.ease}}},yr={exit:({animateOpacity:t,startingHeight:e,transition:r,transitionEnd:o,delay:n})=>({...t&&{opacity:gr(e)?1:0},height:e,transitionEnd:o?.exit,transition:r?.exit??we.exit(Ce.exit,n)}),enter:({animateOpacity:t,endingHeight:e,transition:r,transitionEnd:o,delay:n})=>({...t&&{opacity:1},height:e,transitionEnd:o?.enter,transition:r?.enter??we.enter(Ce.enter,n)})},Be=i.forwardRef((t,e)=>{const{in:r,unmountOnExit:o,animateOpacity:n=!0,startingHeight:a=0,endingHeight:l="auto",style:m,className:p,transition:c,transitionEnd:f,animatePresenceProps:y,...x}=t,[v,S]=i.useState(!1);i.useEffect(()=>{const G=setTimeout(()=>{S(!0)});return()=>clearTimeout(G)},[]),ir({condition:Number(a)>0&&!!o,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const w=parseFloat(a.toString())>0,u={startingHeight:a,endingHeight:l,animateOpacity:n,transition:v?c:{enter:{duration:0}},transitionEnd:{enter:f?.enter,exit:o?f?.exit:{...f?.exit,display:w?"block":"none"}}},g=o?r:!0,O=r||o?"enter":"exit";return s.jsx(At,{...y,initial:!1,custom:u,children:g&&s.jsx(Ee.div,{ref:e,...x,className:R("chakra-collapse",p),style:{overflow:"hidden",display:"block",...m},custom:u,variants:yr,initial:o?"exit":!1,animate:O,exit:"exit"})})});Be.displayName="Collapse";const[hr,N]=Te({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[br,V]=Te({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `}),T={click:"click",hover:"hover"};function Pr(t={}){const{closeOnBlur:e=!0,closeOnEsc:r=!0,initialFocusRef:o,id:n,returnFocusOnClose:a=!0,autoFocus:l=!0,arrowSize:m,arrowShadowColor:p,trigger:c=T.click,openDelay:f=200,closeDelay:y=200,isLazy:x,lazyBehavior:v="unmount",computePositionOnMount:S,...w}=t,{isOpen:u,onClose:g,onOpen:O,onToggle:G}=It(t),[tt,Q]=i.useState(a);i.useEffect(()=>Q(a),[a]);const X=i.useRef(null),_=i.useRef(null),F=i.useRef(null),B=i.useRef(!1),de=i.useRef(!1);u&&(de.current=!0);const[pe,rt]=i.useState(!1),[me,ot]=i.useState(!1),nt=i.useId(),st=n??nt,[fe,U,z,W]=["popover-trigger","popover-content","popover-header","popover-body"].map(d=>`${d}-${st}`),{referenceRef:$,getArrowProps:at,getPopperProps:ge,getArrowInnerProps:it,forceUpdate:lt}=Rt({...w,enabled:u||!!S}),ye=tr({isOpen:u,ref:F});fr({enabled:u,ref:_}),rr(F,{focusRef:_,visible:u,shouldFocus:tt&&c===T.click}),or(F,{focusRef:o,visible:u,shouldFocus:l&&c===T.click}),nr({enabled:u&&e,ref:F,handler(d){const b=d.composedPath?.()[0]??[d.target];K(_.current,b)||(b&&Q(!je(b)),g())}});const he=sr({wasSelected:de.current,enabled:x,mode:v,isSelected:ye.present}),ct=i.useCallback((d={},b=null)=>{const h={...d,style:{...d.style,transformOrigin:re.transformOrigin.varRef,[re.arrowSize.var]:m?`${m}px`:void 0,[re.arrowShadowColor.var]:p},ref:D(F,b),children:he?d.children:null,id:U,tabIndex:-1,role:"dialog",onKeyDown:C(d.onKeyDown,j=>{j.nativeEvent.isComposing||r&&j.key==="Escape"&&(j.preventDefault(),j.stopPropagation(),g())}),onBlur:C(d.onBlur,j=>{const E=Se(j),te=K(F.current,E),gt=K(_.current,E),yt=!te&&!gt;E&&Q(!je(E)),u&&e&&yt&&g()}),"aria-labelledby":pe?z:void 0,"aria-describedby":me?W:void 0};return c===T.hover&&(h.role="tooltip",h.onMouseEnter=C(d.onMouseEnter,()=>{B.current=!0}),h.onMouseLeave=C(d.onMouseLeave,j=>{j.nativeEvent.relatedTarget!==null&&(B.current=!1,setTimeout(()=>g(),y))})),h},[he,U,pe,z,me,W,c,r,g,u,e,y,p,m]),ut=i.useCallback((d={},b=null)=>ge({...d,style:{visibility:u?"visible":"hidden",...d.style}},b),[u,ge]),dt=i.useCallback((d,b=null)=>({...d,ref:D(b,X,$)}),[X,$]),L=i.useRef(),ee=i.useRef(),be=i.useCallback(d=>{X.current==null&&$(d)},[$]),pt=i.useCallback((d={},b=null)=>{const h={...d,ref:D(_,b,be),id:fe,"aria-haspopup":"dialog","aria-expanded":u,"aria-controls":U};return c===T.click&&(h.onClick=C(d.onClick,G)),c===T.hover&&(h.onFocus=C(d.onFocus,()=>{L.current===void 0&&O()}),h.onBlur=C(d.onBlur,j=>{const E=Se(j),te=!K(F.current,E);u&&e&&te&&g()}),h.onKeyDown=C(d.onKeyDown,j=>{j.key==="Escape"&&g()}),h.onMouseEnter=C(d.onMouseEnter,()=>{B.current=!0,L.current=window.setTimeout(()=>O(),f)}),h.onMouseLeave=C(d.onMouseLeave,()=>{B.current=!1,L.current&&(clearTimeout(L.current),L.current=void 0),ee.current=window.setTimeout(()=>{B.current===!1&&g()},y)})),h},[fe,u,U,c,be,G,O,e,g,f,y]);i.useEffect(()=>()=>{L.current&&clearTimeout(L.current),ee.current&&clearTimeout(ee.current)},[]);const mt=i.useCallback((d={},b=null)=>({...d,id:z,ref:D(b,h=>{rt(!!h)})}),[z]),ft=i.useCallback((d={},b=null)=>({...d,id:W,ref:D(b,h=>{ot(!!h)})}),[W]);return{forceUpdate:lt,isOpen:u,onAnimationComplete:ye.onComplete,onClose:g,getAnchorProps:dt,getArrowProps:at,getArrowInnerProps:it,getPopoverPositionerProps:ut,getPopoverProps:ct,getTriggerProps:pt,getHeaderProps:mt,getBodyProps:ft}}function K(t,e){return t===e||t?.contains(e)}function Se(t){const e=t.currentTarget.ownerDocument.activeElement;return t.relatedTarget??e}function De(t){const e=_t("Popover",t),{children:r,...o}=Bt(t),n=Dt(),a=Pr({...o,direction:n.direction});return s.jsx(hr,{value:a,children:s.jsx(br,{value:e,children:Ht(r,{isOpen:a.isOpen,onClose:a.onClose,forceUpdate:a.forceUpdate})})})}De.displayName="Popover";const oe=(t,e)=>e?`${t}.${e}, ${e}`:void 0;function He(t){const{bg:e,bgColor:r,backgroundColor:o,shadow:n,boxShadow:a,shadowColor:l,...m}=t,{getArrowProps:p,getArrowInnerProps:c}=N(),f=V(),y=e??r??o,x=n??a;return s.jsx(A.div,{...p(),className:"chakra-popover__arrow-positioner",children:s.jsx(A.div,{className:R("chakra-popover__arrow",t.className),...c(m),__css:{"--popper-arrow-shadow-color":oe("colors",l),"--popper-arrow-bg":oe("colors",y),"--popper-arrow-shadow":oe("shadows",x),...f.arrow}})})}He.displayName="PopoverArrow";const Je=J(function(e,r){const{getBodyProps:o}=N(),n=V();return s.jsx(A.div,{...o(e,r),className:R("chakra-popover__body",e.className),__css:n.body})});Je.displayName="PopoverBody";const Ve=J(function(e,r){const{onClose:o}=N(),n=V();return s.jsx(Jt,{size:"sm",onClick:o,className:R("chakra-popover__close-btn",e.className),__css:n.closeButton,ref:r,...e})});Ve.displayName="PopoverCloseButton";function xr(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}const vr={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},jr=A(Ee.section),Ue=J(function(e,r){const{variants:o=vr,...n}=e,{isOpen:a}=N();return s.jsx(jr,{ref:r,variants:xr(o),initial:!1,animate:a?"enter":"exit",...n})});Ue.displayName="PopoverTransition";const ze=J(function(e,r){const{rootProps:o,motionProps:n,...a}=e,{getPopoverProps:l,getPopoverPositionerProps:m,onAnimationComplete:p}=N(),c=V(),f=Vt({position:"relative",display:"flex",flexDirection:"column",...c.content});return s.jsx(A.div,{...m(o),__css:c.popper,className:"chakra-popover__popper",children:s.jsx(Ue,{...n,...l(a,r),onAnimationComplete:Ut(p,a.onAnimationComplete),className:R("chakra-popover__content",e.className),__css:f})})});ze.displayName="PopoverContent";const We=J(function(e,r){const{getHeaderProps:o}=N(),n=V();return s.jsx(A.header,{...o(e,r),className:R("chakra-popover__header",e.className),__css:n.header})});We.displayName="PopoverHeader";function $e(t){const e=i.Children.only(t.children),{getTriggerProps:r}=N();return s.jsx(s.Fragment,{children:i.cloneElement(e,r(e.props,e.ref))})}$e.displayName="PopoverTrigger";function wr(t){return"parentLayer"in t}function bo(t){return"olLayer"in t}class Cr{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Me,this.supportedMediaTypes=null}getReadOptions(e,r){if(r){let o=r.dataProjection?M(r.dataProjection):this.readProjection(e);r.extent&&o&&o.getUnits()==="tile-pixels"&&(o=M(o),o.setWorldExtent(r.extent)),r={dataProjection:o,featureProjection:r.featureProjection}}return this.adaptOptions(r)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return P()}readFeature(e,r){return P()}readFeatures(e,r){return P()}readGeometry(e,r){return P()}readProjection(e){return P()}writeFeature(e,r){return P()}writeFeatures(e,r){return P()}writeGeometry(e,r){return P()}}function le(t,e,r){const o=r?M(r.featureProjection):null,n=r?M(r.dataProjection):null;let a=t;if(o&&n&&!ht(o,n)){e&&(a=t.clone());const l=e?o:n,m=e?n:o;l.getUnits()==="tile-pixels"?a.transform(l,m):a.applyTransform(bt(l,m))}if(e&&r&&r.decimals!==void 0){const l=Math.pow(10,r.decimals),m=function(p){for(let c=0,f=p.length;c<f;++c)p[c]=Math.round(p[c]*l)/l;return p};a===t&&(a=t.clone()),a.applyTransform(m)}return a}const Sr={Point:Pt,LineString:Tt,Polygon:xt,MultiPoint:Nt,MultiLineString:Gt,MultiPolygon:Et};function Or(t,e,r){return Array.isArray(e[0])?(vt(t,0,e,r)||(t=t.slice(),jt(t,0,e,r)),t):(wt(t,0,e,r)||(t=t.slice(),Ct(t,0,e,r)),t)}function Ke(t,e){const r=t.geometry;if(!r)return[];if(Array.isArray(r))return r.map(a=>Ke({...t,geometry:a})).flat();const o=r.type==="MultiPolygon"?"Polygon":r.type;if(o==="GeometryCollection"||o==="Circle")throw new Error("Unsupported geometry type: "+o);const n=r.layout.length;return le(new Fe(o,o==="Polygon"?Or(r.flatCoordinates,r.ends,n):r.flatCoordinates,r.ends?.flat(),n,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function ce(t,e){if(!t)return null;if(Array.isArray(t)){const o=t.map(n=>ce(n,e));return new Lt(o)}const r=Sr[t.type];return le(new r(t.flatCoordinates,t.layout,t.ends),!1,e)}class Mr extends Cr{constructor(){super()}getType(){return"json"}readFeature(e,r){return this.readFeatureFromObject(Y(e),this.getReadOptions(e,r))}readFeatures(e,r){return this.readFeaturesFromObject(Y(e),this.getReadOptions(e,r))}readFeatureFromObject(e,r){return P()}readFeaturesFromObject(e,r){return P()}readGeometry(e,r){return this.readGeometryFromObject(Y(e),this.getReadOptions(e,r))}readGeometryFromObject(e,r){return P()}readProjection(e){return this.readProjectionFromObject(Y(e))}readProjectionFromObject(e){return P()}writeFeature(e,r){return JSON.stringify(this.writeFeatureObject(e,r))}writeFeatureObject(e,r){return P()}writeFeatures(e,r){return JSON.stringify(this.writeFeaturesObject(e,r))}writeFeaturesObject(e,r){return P()}writeGeometry(e,r){return JSON.stringify(this.writeGeometryObject(e,r))}writeGeometryObject(e,r){return P()}}function Y(t){if(typeof t=="string"){const e=JSON.parse(t);return e||null}return t!==null?t:null}class Po extends Mr{constructor(e){e=e||{},super(),this.dataProjection=M(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=M(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,r){let o=null;e.type==="Feature"?o=e:o={type:"Feature",geometry:e,properties:null};const n=ue(o.geometry);if(this.featureClass===Fe)return Ke({geometry:n,id:o.id,properties:o.properties},r);const a=new Me;return this.geometryName_?a.setGeometryName(this.geometryName_):this.extractGeometryName_&&o.geometry_name&&a.setGeometryName(o.geometry_name),a.setGeometry(ce(n,r)),"id"in o&&a.setId(o.id),o.properties&&a.setProperties(o.properties,!0),a}readFeaturesFromObject(e,r){const o=e;let n=null;if(o.type==="FeatureCollection"){const a=e;n=[];const l=a.features;for(let m=0,p=l.length;m<p;++m){const c=this.readFeatureFromObject(l[m],r);c&&n.push(c)}}else n=[this.readFeatureFromObject(e,r)];return n.flat()}readGeometryFromObject(e,r){return Fr(e,r)}readProjectionFromObject(e){const r=e.crs;let o;if(r)if(r.type=="name")o=M(r.properties.name);else if(r.type==="EPSG")o=M("EPSG:"+r.properties.code);else throw new Error("Unknown SRS type");else o=this.dataProjection;return o}writeFeatureObject(e,r){r=this.adaptOptions(r);const o={type:"Feature",geometry:null,properties:null},n=e.getId();if(n!==void 0&&(o.id=n),!e.hasProperties())return o;const a=e.getProperties(),l=e.getGeometry();return l&&(o.geometry=ae(l,r),delete a[e.getGeometryName()]),St(a)||(o.properties=a),o}writeFeaturesObject(e,r){r=this.adaptOptions(r);const o=[];for(let n=0,a=e.length;n<a;++n)o.push(this.writeFeatureObject(e[n],r));return{type:"FeatureCollection",features:o}}writeGeometryObject(e,r){return ae(e,this.adaptOptions(r))}}function ue(t,e){if(!t)return null;let r;switch(t.type){case"Point":{r=Nr(t);break}case"LineString":{r=Gr(t);break}case"Polygon":{r=Ar(t);break}case"MultiPoint":{r=Tr(t);break}case"MultiLineString":{r=Er(t);break}case"MultiPolygon":{r=kr(t);break}case"GeometryCollection":{r=Lr(t);break}default:throw new Error("Unsupported GeoJSON type: "+t.type)}return r}function Fr(t,e){const r=ue(t);return ce(r,e)}function Lr(t,e){return t.geometries.map(function(o){return ue(o)})}function Nr(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:I(e.length)}}function Gr(t){const e=t.coordinates,r=e.flat();return{type:"LineString",flatCoordinates:r,ends:[r.length],layout:I(e[0]?.length||2)}}function Er(t){const e=t.coordinates,r=e[0]?.[0]?.length||2,o=[],n=Le(o,0,e,r);return{type:"MultiLineString",flatCoordinates:o,ends:n,layout:I(r)}}function Tr(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:I(e[0]?.length||2)}}function kr(t){const e=t.coordinates,r=[],o=e[0]?.[0]?.[0].length||2,n=Ot(r,0,e,o);return{type:"MultiPolygon",flatCoordinates:r,ends:n,layout:I(o)}}function Ar(t){const e=t.coordinates,r=[],o=e[0]?.[0]?.length,n=Le(r,0,e,o);return{type:"Polygon",flatCoordinates:r,ends:n,layout:I(o)}}function ae(t,e){t=le(t,!0,e);const r=t.getType();let o;switch(r){case"Point":{o=Hr(t);break}case"LineString":{o=Rr(t);break}case"Polygon":{o=Jr(t,e);break}case"MultiPoint":{o=Br(t);break}case"MultiLineString":{o=_r(t);break}case"MultiPolygon":{o=Dr(t,e);break}case"GeometryCollection":{o=Ir(t,e);break}case"Circle":{o={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+r)}return o}function Ir(t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(o){return ae(o,e)})}}function Rr(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function _r(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function Br(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function Dr(t,e){let r;return e&&(r=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(r)}}function Hr(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function Jr(t,e){let r;return e&&(r=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(r)}}const Vr=Qt({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"}),xo=i.forwardRef(function(e,r){const{label:o,icon:n,onClick:a,isLoading:l,isDisabled:m,isActive:p,tooltipProps:c,buttonProps:f}=e,{containerProps:{className:y,...x}}=Ne("tool-button",e),v=Ge(y,{"tool-button--active":p,"tool-button--loading":l,"tool-button--disabled":m}),S=typeof p=="boolean"?p?"true":"false":void 0,[w,u]=i.useState(!1),g=O=>{u(!1),a?.(O)};return s.jsx(ke,{label:o,placement:"auto",openDelay:500,...c,isOpen:w,onOpen:()=>u(!0),onClose:()=>u(!1),children:s.jsx(Ur,{className:v,ref:r,"aria-label":o,leftIcon:n,iconSpacing:0,padding:0,isDisabled:m,isLoading:l,isActive:p,"aria-pressed":S,...x,...f,onClick:g})})}),Ur=i.forwardRef(function(e,r){const{"aria-labelledby":o,"aria-describedby":n,...a}=e;return s.jsx(ie,{ref:r,...a})}),zr="@open-pioneer/toc",Z=Mt.bind(void 0,zr),Ye=i.createContext(void 0),Wr=Ye.Provider;function $r(){const t=i.useContext(Ye);if(!t)throw new Error("useTocWidgetOptions must be used within a TocWidgetOptionsProvider");return t}const qe=i.createContext(void 0),Ze=i.forwardRef((t,e)=>{const{map:r,"aria-label":o}=t,n=i.useRef();n.current||(n.current=new Map);const a=i.useMemo(()=>({registerExpandedState(c,f){n.current.set(c,f)},unregisterExpandedState(c){n.current.delete(c)}}),[]),l=Xr(n.current),m=Z(),p=qr(r);return i.useImperativeHandle(e,()=>({listItemsExpandedModel:l})),p.length?s.jsx(qe.Provider,{value:a,children:Qe(p,{"aria-label":o})}):s.jsx(se,{className:"toc-missing-layers","aria-label":o,children:m.formatMessage({id:"missingLayers"})})});Ze.displayName="LayerList";function Qe(t,e){const r=t.map(n=>s.jsx(Kr,{layer:n},n.id));return s.jsx(H,{children:s.jsx(Xt,{as:"ul",className:"toc-layer-list",listStyleType:"none",role:"group",...e,children:r})})}function Kr(t){const{layer:e}=t,r=Z(),o=$r(),n=i.useId(),{title:a,description:l,isVisible:m}=q(()=>({title:e.title,description:e.description,isVisible:e.visible}),[e]),p=Zr(e),c=et(e)!=="error",f=r.formatMessage({id:"layerNotAvailable"}),[y,x]=i.useState(!0),v=i.useContext(qe),S=o?o.collapsibleGroups:!1,w=Wt(g=>{x(g)});i.useEffect(()=>{if(v)return v.registerExpandedState(e.id,{layerId:e.id,isExpanded:y,setExpanded:w}),()=>v.unregisterExpandedState(e.id)},[e,v,w,y]);let u;return p?.length&&(u=Qe(p,{ml:4,"aria-label":r.formatMessage({id:"childgroupLabel"},{title:a})})),s.jsxs(H,{as:"li",className:Ge("toc-layer-item",`layer-${Qr(e.id)}`),children:[s.jsxs(ne,{className:"toc-layer-item-content",width:"100%",flexDirection:"row",align:"center",justifyContent:"space-between",gap:2,minHeight:10,children:[s.jsx(Kt,{variant:"ghost",borderRadius:"full",padding:0,className:"toc-layer-item-collapse-button",onClick:()=>x(!y),icon:y?s.jsx(Yt,{}):s.jsx(Vr,{}),"aria-label":y?r.formatMessage({id:"group.collapse"},{title:a}):r.formatMessage({id:"group.expand"},{title:a}),"aria-expanded":y,"aria-controls":n,visibility:u&&S?"visible":"hidden"}),s.jsx(er,{"aria-label":a+(c?"":" "+f),isChecked:m,isDisabled:!c,onChange:g=>Xe(e,g.target.checked,o.autoShowParents),children:a}),!c&&s.jsx(ke,{className:"toc-layer-item-content-tooltip",label:f,placement:"right",openDelay:500,children:s.jsx("span",{children:s.jsx($t,{className:"toc-layer-item-content-icon",color:"red","aria-label":f})})}),s.jsx(Re,{}),l&&s.jsx(Yr,{layer:e,title:a,description:l,intl:r})]}),u&&s.jsx(Be,{in:y,id:n,className:"toc-collapsible-item",children:u})]})}function Xe(t,e,r){t.setVisible(e),e&&r&&t.parent&&Xe(t.parent,!0,!0)}function Yr(t){const{layer:e,title:r,description:o,intl:n}=t,a=n.formatMessage({id:"descriptionLabel"}),l=et(e)!=="error";return s.jsxs(De,{placement:"bottom-start",children:[s.jsx($e,{children:s.jsx(ie,{isDisabled:!l,className:"toc-layer-item-details-button","aria-label":a,borderRadius:"full",iconSpacing:0,padding:0,variant:"ghost",leftIcon:s.jsx(Ie,{})})}),s.jsx(Ae,{children:s.jsxs(ze,{className:"toc-layer-item-details",overflowY:"auto",maxHeight:"400",children:[s.jsx(He,{}),s.jsx(Ve,{mt:1}),s.jsx(We,{children:r}),s.jsx(Je,{children:o})]})})]})}function qr(t){return q(()=>{const e=t.layers.getOperationalLayers({sortByDisplayOrder:!0})??[];return e.reverse(),e},[t])}function Zr(t){return q(()=>{const e=t.children?.getItems({sortByDisplayOrder:!0});return e?.reverse(),e},[t])}function et(t){return q(()=>(wr(t)?t.parentLayer:t).loadState,[t])}function Qr(t){return t.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function Xr(t){return i.useMemo(()=>({isExpanded(r){if(t.has(r))return t.get(r)?.isExpanded},setExpanded(r,o){t.get(r)?.setExpanded(o)},getAllExpandedStates(){return Array.from(t.values())}}),[t])}const eo=t=>{const e=Z(),{map:r,listItemsExpandedModel:o,showHideAllLayers:n=!0,showCollapseAllGroups:a=!0}=t;return!(!n&&!a)&&s.jsx(H,{className:"toc-tools",children:s.jsxs(ar,{placement:"bottom-start",children:[s.jsx(qt,{as:ie,className:"toc-tools-button","aria-label":e.formatMessage({id:"toolsLabel"}),borderRadius:"full",iconSpacing:0,padding:3,variant:"ghost",leftIcon:s.jsx(Ie,{})}),s.jsx(Ae,{children:s.jsxs(Zt,{className:"tools-menu",children:[n&&s.jsx(ve,{"aria-label":e.formatMessage({id:"tools.hideAllLayers"}),onClick:()=>{to(r)},children:e.formatMessage({id:"tools.hideAllLayers"})}),a&&s.jsx(ve,{"aria-label":e.formatMessage({id:"tools.collapseAllGroups"}),onClick:()=>{ro(o)},children:e.formatMessage({id:"tools.collapseAllGroups"})})]})})]})})};function to(t){const e=r=>{r.setVisible(!1);const o=r.children?.getItems();if(o)for(const n of o)e(n)};t?.layers.getOperationalLayers().forEach(r=>{e(r)})}function ro(t){t&&t.getAllExpandedStates().forEach(e=>e.setExpanded(!1))}const Oe=2,vo=t=>{const e=Z(),{showTools:r=!1,toolsConfig:o,showBasemapSwitcher:n=!0,basemapSwitcherProps:a,collapsibleGroups:l=!1,autoShowParents:m=!0}=t,{containerProps:p}=Ne("toc",t),c=i.useId(),f=i.useMemo(()=>({autoShowParents:m,collapsibleGroups:l}),[m,l]),y=Ft(t),[x,v]=i.useState(),S=i.useCallback(g=>{g&&v(g.listItemsExpandedModel)},[]),w=o?o.showCollapseAllGroups&&f.collapsibleGroups:f.collapsibleGroups;let u;switch(y.kind){case"loading":u=null;break;case"rejected":u=s.jsx(se,{className:"toc-error",children:e.formatMessage({id:"error"})});break;case"resolved":{const g=y.map,O=n&&s.jsx(H,{className:"toc-basemap-switcher",children:s.jsx(Pe,{title:s.jsx(xe,{id:c,size:"sm",mb:Oe,children:e.formatMessage({id:"basemapsLabel"})}),children:s.jsx(zt,{map:g,"aria-labelledby":c,...a})})}),G=s.jsx(H,{className:"toc-operational-layers",children:s.jsx(Pe,{title:s.jsx(xe,{size:"sm",mb:2,children:s.jsxs(ne,{children:[s.jsx(se,{my:3,children:e.formatMessage({id:"operationalLayerLabel"})}),s.jsx(Re,{}),r&&s.jsx(eo,{map:g,listItemsExpandedModel:x,showHideAllLayers:o?.showHideAllLayers,showCollapseAllGroups:w})]})}),children:s.jsx(Ze,{map:g,"aria-label":e.formatMessage({id:"operationalLayerLabel"}),ref:S})})});u=s.jsxs(s.Fragment,{children:[O,G]});break}}return s.jsx(ne,{...p,direction:"column",gap:Oe,children:s.jsx(Wr,{value:f,children:u})})};export{Cr as F,Po as G,De as P,xo as T,$e as a,ze as b,He as c,Je as d,vo as e,bo as i,le as t,N as u};
