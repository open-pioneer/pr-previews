import{a as Ki,j as K,B as yn,V as Ji,f as Yi}from"./B60Dx_GOYdnk.js";import{t as Qi}from"./DjS5-7IPlotu.js";import{n as ti,o as eo,p as ye,q as to,s as q,t as ro,v as no,x as je,y as ri,z as lt,A as io,B as Re,E as oo,G as ao,I as so,J as lo,K as uo,L as ni,N as ii,P as er,Q as co,R as po,U as gn,W as fo,X as ho,Y as tr,Z as mo,_ as xn,$ as bn,a0 as yo,a1 as go,a2 as xo,a3 as bo,a4 as vo,a5 as Tt,a6 as wo,a7 as oi,a8 as jr,a9 as Tr,aa as ai,ab as To,ac as ko,ad as zo,ae as So,af as Xe,ag as Fo,ah as Eo,ai as Co,aj as Io,ak as kr,al as _o,am as Po,an as Ro,a as zr,ao as Mo,ap as Mt,aq as Ao,ar as si,as as Do,at as jo,au as Lo,av as $o,aw as Oo,ax as st,F as Ge,ay as qo,b as rr,az as Go,aA as Vo,c as Ee,aB as vn,C as li,aC as No,aD as wn,S as it,T as Uo,O as Bo,H as Zo,M as Ho,u as Xo,k as nr,g as Tn,h as kn,l as Wo,m as ir}from"./j0mck_Meu7Xh.js";import{F as Ko,t as Jo,G as zn,e as Yo}from"./D0_7QMwEwHiI.js";import{L as Qo}from"./ajAX9OmvUsbZ.js";import{M as ea,a as ta,b as ra}from"./BWf1FusGPLsb.js";import{V as na,S as ia,I as oa,Z as aa,a as sa}from"./C-ueymo9cATn.js";import{_ as Sn}from"./CmsKOCeNyeyo.js";import{T as or}from"./BKR6R-cAnIXt.js";import"./DSjrbd_eKbZM.js";import"./BpQSjk0kyblh.js";import"./vepZWq5kkQUw.js";import"./C9VJq5Ka7299.js";import"./2C0geDG_OBHU.js";import"./BXfBNJYYR7xb.js";import"./CMfwYEDRd35m.js";import"./BlACKGYldMfy.js";import"./CG5nmvkyugDn.js";const Fn=[];class la extends ti{constructor(e,t,n,i,o){super(e,t,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=i.bind(void 0,this),this.removeSourceTiles_=o,this.wrappedTileCoord=n}getContext(){return this.context_||(this.context_=eo(1,1,Fn)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(e){const t=ye(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){this.context_&&(to(this.context_),Fn.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}}let ui=class extends ti{constructor(e,t,n,i,o,a){super(e,t,a),this.extent=null,this.format_=i,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=o,this.url_=n,this.key=n}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==q.IDLE&&(this.setState(q.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,t){this.setFeatures(e)}onError(){this.setState(q.ERROR)}setFeatures(e){this.features_=e,this.setState(q.LOADED)}setLoader(e){this.loader_=e}};const ua={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},En={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class ca extends ro{constructor(e,t){super(e,t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=no(),this.tileClipContexts_=null}drawTile(e,t,n,i,o,a,s,l){this.updateExecutorGroup_(e,t.pixelRatio,t.viewState.projection),this.tileImageNeedsRender_(e)&&this.renderTileImage_(e,t),super.drawTile(e,t,n,i,o,a,s,l)}getTile(e,t,n,i){const o=this.getOrCreateTile(e,t,n,i);if(!o)return null;const s=i.viewState.resolution,l=i.viewHints;return(!(l[je.ANIMATING]||l[je.INTERACTING])||!o.wantedResolution)&&(o.wantedResolution=s),o}prepareFrame(e){const t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,n){const i=this.getLayer(),o=i.getRevision(),a=i.getRenderOrder()||null,s=e.wantedResolution,l=e.getReplayState(i);if(!l.dirty&&l.renderedResolution===s&&l.renderedRevision==o&&l.renderedRenderOrder==a)return;const u=i.getSource(),c=!!i.getDeclutter(),d=u.getTileGrid(),h=u.getTileGridForProjection(n).getTileCoordExtent(e.wrappedTileCoord),f=u.getSourceTiles(t,n,e),x=ye(i);delete e.hitDetectionImageData[x],e.executorGroups[x]=[],l.dirty=!1;for(let m=0,D=f.length;m<D;++m){const I=f[m];if(I.getState()!=q.LOADED)continue;const E=I.tileCoord,C=d.getTileCoordExtent(E),z=ri(h,C),A=lt(z,i.getRenderBuffer()*s,this.tempExtent),T=io(C,z)?null:A,F=new go(0,z,s,t),L=xo(s,t),Y=function(k,M){let ge;const gt=k.getStyleFunction()||i.getStyleFunction();if(gt&&(ge=gt(k,s)),ge){const xt=this.renderFeature(k,L,ge,F,c,M);l.dirty=l.dirty||xt}},G=I.getFeatures();a&&a!==l.renderedRenderOrder&&G.sort(a);for(let k=0,M=G.length;k<M;++k){const ge=G[k];(!T||Re(T,ge.getGeometry().getExtent()))&&Y.call(this,ge,k)}const g=F.finish(),J=i.getRenderMode()!=="vector"&&c&&f.length===1?null:z,b=new oo(J,s,t,u.getOverlaps(),g,i.getRenderBuffer(),!0);e.executorGroups[x].push(b)}l.renderedRevision=o,l.renderedRenderOrder=a,l.renderedResolution=s}forEachFeatureAtCoordinate(e,t,n,i,o){const a=t.viewState.resolution,s=t.viewState.rotation;n=n??0;const l=this.getLayer(),c=l.getSource().getTileGridForProjection(t.viewState.projection),d=ao([e]);lt(d,a*n,d);const p={},h=function(E,C,z){let A=E.getId();A===void 0&&(A=ye(E));const T=p[A];if(T){if(T!==!0&&z<T.distanceSq){if(z===0)return p[A]=!0,o.splice(o.lastIndexOf(T),1),i(E,l,C);T.geometry=C,T.distanceSq=z}}else{if(z===0)return p[A]=!0,i(E,l,C);o.push(p[A]={feature:E,layer:l,geometry:C,distanceSq:z,callback:i})}},f=this.renderedTiles,x=ye(l),m=l.getDeclutter(),D=m?t.declutter[m].all().map(E=>E.value):null;let I;e:for(let E=0,C=f.length;E<C;++E){const z=f[E],A=c.getTileCoordExtent(z.wrappedTileCoord);if(!Re(A,d))continue;const T=z.executorGroups[x];for(let F=0,L=T.length;F<L;++F)if(I=T[F].forEachFeatureAtCoordinate(e,a,s,n,h,D),I)break e}return I}getFeatures(e){return this.renderedTiles.length===0?Promise.resolve([]):new Promise((t,n)=>{const i=this.getLayer(),o=i.getSource(),a=this.renderedProjection,s=a.getExtent(),l=this.renderedResolution,u=o.getTileGridForProjection(a),c=so(this.renderedPixelToCoordinateTransform_,e.slice()),d=u.getTileCoordForCoordAndResolution(c,l).toString(),p=this.renderedTiles.find(E=>E.tileCoord.toString()===d&&E.getState()===q.LOADED);if(!p||p.loadingSourceTiles>0){t([]);return}o.getWrapX()&&a.canWrapX()&&!lo(s,u.getTileCoordExtent(p.tileCoord))&&uo(c,a);const h=ye(i),f=u.getTileCoordExtent(p.wrappedTileCoord),x=ni(f),m=[(c[0]-x[0])/l,(x[1]-c[1])/l],D=p.getSourceTiles().reduce((E,C)=>E.concat(C.getFeatures()),[]);let I=p.hitDetectionImageData[h];if(!I){const E=ii(u.getTileSize(u.getZForResolution(l,o.zDirection))),C=this.renderedRotation_,z=[this.getRenderTransform(u.getTileCoordCenter(p.wrappedTileCoord),l,0,er,E[0]*er,E[1]*er,0)];I=co(E,z,D,i.getStyleFunction(),u.getTileCoordExtent(p.wrappedTileCoord),p.getReplayState(i).renderedResolution,C),p.hitDetectionImageData[h]=I}t(po(m,D,I))})}getFeaturesInExtent(e){const t=[],n=this.getTileCache();if(n.getCount()===0)return t;const o=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),a=o.getZForResolution(this.renderedResolution),s={};return n.forEach(l=>{if(l.tileCoord[0]!==a||l.getState()!==q.LOADED)return;const u=l.getSourceTiles();for(let c=0,d=u.length;c<d;++c){const p=u[c],h=p.getKey();if(h in s)continue;s[h]=!0;const f=p.tileCoord;if(Re(e,o.getTileCoordExtent(f))){const x=p.getFeatures();if(x)for(let m=0,D=x.length;m<D;++m){const I=x[m],E=I.getGeometry();Re(e,E.getExtent())&&t.push(I)}}}}),t}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.renderedLayerRevision_!==void 0&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e,t){const n=this.context,i=n.globalAlpha;n.globalAlpha=t.opacity;const o=e.viewHints,a=!(o[je.ANIMATING]||o[je.INTERACTING]),s=[this.context.canvas.width,this.context.canvas.height],l=this.getLayer().getDeclutter(),u=l?e.declutter[l]:void 0,c=ye(this.getLayer()),d=this.renderedTiles;for(let p=0,h=d.length;p<h;++p){const f=d[p],x=f.executorGroups[c];if(x)for(let m=x.length-1;m>=0;--m)x[m].execute(this.context,s,this.getTileRenderTransform(f,e),e.viewState.rotation,a,gn,u)}n.globalAlpha=i}renderDeferredInternal(e){const t=this.renderedTiles,n=ye(this.getLayer()),i=t.reduce((l,u,c)=>(u.executorGroups[n].forEach(d=>l.push({executorGroup:d,index:c})),l),[]),o=i.map(({executorGroup:l})=>l.getDeferredZIndexContexts()),a={};for(let l=0,u=i.length;l<u;++l){const c=i[l].executorGroup.getDeferredZIndexContexts();for(const d in c)a[d]=!0}Object.keys(a).map(Number).sort(fo).forEach(l=>{o.forEach((u,c)=>{u[l]&&(u[l].forEach(d=>{const{executorGroup:p,index:h}=i[c],f=p.getRenderedContext(),x=f.globalAlpha;f.globalAlpha=this.renderedOpacity_;const m=this.tileClipContexts_[h];m&&m.draw(f),d.draw(f),m&&f.restore(),f.globalAlpha=x,d.clear()}),u[l].length=0)})})}getTileRenderTransform(e,t){const n=t.pixelRatio,i=t.viewState,o=i.center,a=i.resolution,s=i.rotation,l=t.size,u=Math.round(l[0]*n),c=Math.round(l[1]*n),p=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),h=e.tileCoord,f=p.getTileCoordExtent(e.wrappedTileCoord),x=p.getTileCoordExtent(h,this.tempExtent)[0]-f[0];return ho(tr(this.inversePixelTransform.slice(),1/n,1/n),this.getRenderTransform(o,a,s,n,u,c,x))}postRender(e,t){const n=t.viewHints,i=!(n[je.ANIMATING]||n[je.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation,this.renderedOpacity_=t.layerStatesArray[t.layerIndex].opacity;const o=this.getLayer(),a=o.getRenderMode(),s=e.globalAlpha;e.globalAlpha=this.renderedOpacity_;const l=o.getDeclutter(),u=l?En[a].filter(z=>!gn.includes(z)):En[a],c=t.viewState,d=c.rotation,p=o.getSource(),f=p.getTileGridForProjection(c.projection).getZForResolution(c.resolution,p.zDirection),x=this.renderedTiles,m=[],D=[],I=[],E=ye(o);let C=!0;for(let z=x.length-1;z>=0;--z){const A=x[z];C=C&&!A.getReplayState(o).dirty;const T=A.executorGroups[E].filter(b=>b.hasExecutors(u));if(T.length===0)continue;const F=this.getTileRenderTransform(A,t),L=A.tileCoord[0];let Y=!1;const G=T[0].getClipCoords(F);let g=e,J;if(G){J=new mo,g=J.getContext();for(let b=0,k=m.length;b<k;++b)if(f!==L&&L<D[b]){const M=m[b];Re([G[0],G[3],G[4],G[7]],[M[0],M[3],M[4],M[7]])&&(Y||(g.save(),Y=!0),g.beginPath(),g.moveTo(G[0],G[1]),g.lineTo(G[2],G[3]),g.lineTo(G[4],G[5]),g.lineTo(G[6],G[7]),g.moveTo(M[6],M[7]),g.lineTo(M[4],M[5]),g.lineTo(M[2],M[3]),g.lineTo(M[0],M[1]),g.clip())}m.push(G),D.push(L)}for(let b=0,k=T.length;b<k;++b)T[b].execute(e,[e.canvas.width,e.canvas.height],F,d,i,u,t.declutter?.[l]);Y&&(g===e?g.restore():I[z]=J)}e.globalAlpha=s,this.ready=C,this.tileClipContexts_=I,t.declutter||this.renderDeferredInternal(t),super.postRender(e,t)}renderFeature(e,t,n,i,o,a){if(!n)return!1;let s=!1;if(Array.isArray(n))for(let l=0,u=n.length;l<u;++l)s=xn(i,e,n[l],t,this.boundHandleStyleImageChange_,void 0,o,a)||s;else s=xn(i,e,n,t,this.boundHandleStyleImageChange_,void 0,o,a);return s}tileImageNeedsRender_(e){const t=this.getLayer();if(t.getRenderMode()==="vector")return!1;const n=e.getReplayState(t),i=t.getRevision(),o=e.wantedResolution;return n.renderedTileResolution!==o||n.renderedTileRevision!==i}renderTileImage_(e,t){const n=this.getLayer(),i=e.getReplayState(n),o=n.getRevision(),a=e.executorGroups[ye(n)];i.renderedTileRevision=o;const s=e.wrappedTileCoord,l=s[0],u=n.getSource();let c=t.pixelRatio;const p=t.viewState.projection,h=u.getTileGridForProjection(p),f=h.getResolution(e.tileCoord[0]),x=t.pixelRatio/e.wantedResolution*f,m=h.getResolution(l),D=e.getContext();c=Math.round(Math.max(c,x/c));const I=u.getTilePixelSize(l,c,p);D.canvas.width=I[0],D.canvas.height=I[1];const E=c/x;if(E!==1){const T=bn(this.tmpTransform_);tr(T,E,E),D.setTransform.apply(D,T)}const C=h.getTileCoordExtent(s,this.tempExtent),z=x/m,A=bn(this.tmpTransform_);tr(A,z,-z),yo(A,-C[0],-C[3]);for(let T=0,F=a.length;T<F;++T)a[T].execute(D,[D.canvas.width*E,D.canvas.height*E],A,0,!0,ua[n.getRenderMode()],null);i.renderedTileResolution=e.wantedResolution}}class ut extends bo{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload;const n=e.cacheSize===void 0?0:e.cacheSize;delete e.cacheSize,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.cacheSize_=n;const i=e.renderMode||"hybrid";vo(i=="hybrid"||i=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=i,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new ca(this,{cacheSize:this.cacheSize_})}getFeatures(e){return super.getFeatures(e)}getFeaturesInExtent(e){return this.getRenderer().getFeaturesInExtent(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(Tt.PRELOAD)}getUseInterimTilesOnError(){return this.get(Tt.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set(Tt.PRELOAD,e)}setUseInterimTilesOnError(e){this.set(Tt.USE_INTERIM_TILES_ON_ERROR,e)}}function pa(r,e,t,n){const i=document.createElement("script"),o="olc_"+ye(e);function a(){delete window[o],i.parentNode.removeChild(i)}i.async=!0,i.src=r+(r.includes("?")?"&":"?")+"callback="+o;const s=setTimeout(function(){a(),t&&t()},1e4);window[o]=function(l){clearTimeout(s),a(),e(l)},document.head.appendChild(i)}class Lr extends wo{constructor(e){const t=e.projection||"EPSG:3857",n=e.extent||oi(t),i=e.tileGrid||jr({extent:n,maxResolution:e.maxResolution,maxZoom:e.maxZoom!==void 0?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,projection:t,state:e.state,tileGrid:i,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:ci,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX===void 0?!0:e.wrapX,transition:e.transition,zDirection:e.zDirection===void 0?1:e.zDirection}),this.format_=e.format?e.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=e.overlaps==null?!0:e.overlaps,this.tileClass=e.tileClass?e.tileClass:ui,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(e,t,n){if(n.getState()===q.IDLE){n.setState(q.LOADING);const i=n.wrappedTileCoord,o=this.getTileGridForProjection(t),a=o.getTileCoordExtent(i),s=i[0],l=o.getResolution(s);lt(a,-l,a);const u=this.tileGrid,c=u.getExtent();c&&ri(a,c,a);const d=u.getZForResolution(l,this.zDirection);u.forEachTileCoord(a,d,p=>{const h=this.tileUrlFunction(p,e,t);this.sourceTiles_[h]||(this.sourceTiles_[h]=new this.tileClass(p,h?q.IDLE:q.EMPTY,h,this.format_,this.tileLoadFunction));const f=this.sourceTiles_[h];n.sourceTiles.push(f),this.tileKeysBySourceTileUrl_[h]||(this.tileKeysBySourceTileUrl_[h]=[]),this.tileKeysBySourceTileUrl_[h].push(n.getKey());const x=f.getState();if(x<q.LOADED){const m=D=>{this.handleTileChange(D);const I=f.getState();if(I===q.LOADED||I===q.ERROR){const E=f.getKey();E in n.errorTileKeys?f.getState()===q.LOADED&&delete n.errorTileKeys[E]:n.loadingSourceTiles--,I===q.ERROR?n.errorTileKeys[E]=!0:f.removeEventListener(Tr.CHANGE,m),n.loadingSourceTiles===0&&n.setState(ko(n.errorTileKeys)?q.LOADED:q.ERROR)}};f.addEventListener(Tr.CHANGE,m),n.loadingSourceTiles++}x===q.IDLE&&(f.extent=u.getTileCoordExtent(p),f.projection=t,f.resolution=u.getResolution(p[0]),f.load())}),n.loadingSourceTiles||n.setState(n.sourceTiles.some(p=>p.getState()===q.ERROR)?q.ERROR:q.LOADED)}return n.sourceTiles}removeSourceTiles(e){const t=e.sourceTiles;for(let n=0,i=t.length;n<i;++n){const o=t[n].getTileUrl(),a=this.getKey();if(!this.tileKeysBySourceTileUrl_[o])return;const s=this.tileKeysBySourceTileUrl_[o][a];s!==-1&&(this.tileKeysBySourceTileUrl_[o].splice(s,1),this.tileKeysBySourceTileUrl_[o].length===0&&(delete this.tileKeysBySourceTileUrl_[o],delete this.sourceTiles_[o]))}}getTile(e,t,n,i,o){const a=[e,t,n];let s=this.getTileCoordForTileUrlFunction(a,o);const l=this.getTileGrid().getExtent(),u=this.getTileGridForProjection(o);if(s&&l){const p=u.getTileCoordExtent(s);lt(p,-u.getResolution(e),p),Re(l,p)||(s=null)}let c=!0;if(s!==null){const p=this.tileGrid,h=u.getResolution(e),f=p.getZForResolution(h,1),x=u.getTileCoordExtent(s);lt(x,-h,x),p.forEachTileCoord(x,f,m=>{c=c&&!this.tileUrlFunction(m,i,o)})}const d=new la(a,c?q.EMPTY:q.IDLE,s,this.getSourceTiles.bind(this,i,o),this.removeSourceTiles.bind(this));return d.key=this.getKey(),d}getTileGridForProjection(e){const t=e.getCode();let n=this.tileGrids_[t];if(!n){const i=this.tileGrid,o=i.getResolutions().slice(),a=o.map(function(u,c){return i.getOrigin(c)}),s=o.map(function(u,c){return i.getTileSize(c)}),l=zo+1;for(let u=o.length;u<l;++u)o.push(o[u-1]/2),a.push(a[u-1]),s.push(s[u-1]);n=new ai({extent:i.getExtent(),origins:a,resolutions:o,tileSizes:s}),this.tileGrids_[t]=n}return n}getTilePixelRatio(e){return e}getTilePixelSize(e,t,n){const i=this.getTileGridForProjection(n),o=ii(i.getTileSize(e),this.tmpSize);return[Math.round(o[0]*t),Math.round(o[1]*t)]}setOverlaps(e){this.overlaps_=e,this.changed()}}function ci(r,e){r.setLoader(function(t,n,i){To(e,r.getFormat(),t,n,i,r.onLoad.bind(r),r.onError.bind(r))})}class da extends So{constructor(e){if(super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:Xe("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.tileJSON_=null,this.tileSize_=e.tileSize,e.url)if(e.jsonp)pa(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",e.url),t.send()}else if(e.tileJSON)this.handleTileJSONResponse(e.tileJSON);else throw new Error("Either `url` or `tileJSON` options must be provided")}onXHRLoad_(e){const t=e.target;if(!t.status||t.status>=200&&t.status<300){let n;try{n=JSON.parse(t.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(n)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(e){const t=Xe("EPSG:4326"),n=this.getProjection();let i;if(e.bounds!==void 0){const u=Fo(t,n);i=Eo(e.bounds,u)}const o=oi(n),a=e.minzoom||0,s=e.maxzoom||22,l=jr({extent:o,maxZoom:s,minZoom:a,tileSize:this.tileSize_});if(this.tileGrid=l,this.tileUrlFunction=Co(e.tiles,l),e.attribution&&!this.getAttributions()){const u=i!==void 0?i:o;this.setAttributions(function(c){return Re(u,c.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}handleTileJSONError(){this.setState("error")}}const Sr=65536*65536,Cn=1/Sr,fa=12,In=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),ar=0,kt=1,ot=2,zt=5;class ha{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,t,n=this.length){for(;this.pos<n;){const i=this.readVarint(),o=i>>3,a=this.pos;this.type=i&7,e(o,t,this),this.pos===a&&this.skip(i)}return t}readMessage(e,t){return this.readFields(e,t,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Sr;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Sr;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const t=this.buf;let n,i;return i=t[this.pos++],n=i&127,i<128||(i=t[this.pos++],n|=(i&127)<<7,i<128)||(i=t[this.pos++],n|=(i&127)<<14,i<128)||(i=t[this.pos++],n|=(i&127)<<21,i<128)?n:(i=t[this.pos],n|=(i&15)<<28,ma(n,e,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2===1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=fa&&In?In.decode(this.buf.subarray(t,e)):Ca(this.buf,t,e)}readBytes(){const e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t}readPackedVarint(e=[],t){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readVarint(t));return e}readPackedSVarint(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const t=this.readPackedEnd();for(;this.pos<t;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===ot?this.readVarint()+this.pos:this.pos+1}skip(e){const t=e&7;if(t===ar)for(;this.buf[this.pos++]>127;);else if(t===ot)this.pos=this.readVarint()+this.pos;else if(t===zt)this.pos+=4;else if(t===kt)this.pos+=8;else throw new Error(`Unimplemented type: ${t}`)}writeTag(e,t){this.writeVarint(e<<3|t)}realloc(e){let t=this.length||16;for(;t<this.pos+e;)t*=2;if(t!==this.length){const n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.dataView=new DataView(n.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Cn),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Cn),!0),this.pos+=8}writeVarint(e){if(e=+e||0,e>268435455||e<0){ya(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))}writeSVarint(e){this.writeVarint(e<0?-e*2-1:e*2)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(e.length*4),this.pos++;const t=this.pos;this.pos=Ia(this.buf,e,this.pos);const n=this.pos-t;n>=128&&_n(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const t=e.length;this.writeVarint(t),this.realloc(t);for(let n=0;n<t;n++)this.buf[this.pos++]=e[n]}writeRawMessage(e,t){this.pos++;const n=this.pos;e(t,this);const i=this.pos-n;i>=128&&_n(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i}writeMessage(e,t,n){this.writeTag(e,ot),this.writeRawMessage(t,n)}writePackedVarint(e,t){t.length&&this.writeMessage(e,ba,t)}writePackedSVarint(e,t){t.length&&this.writeMessage(e,va,t)}writePackedBoolean(e,t){t.length&&this.writeMessage(e,ka,t)}writePackedFloat(e,t){t.length&&this.writeMessage(e,wa,t)}writePackedDouble(e,t){t.length&&this.writeMessage(e,Ta,t)}writePackedFixed32(e,t){t.length&&this.writeMessage(e,za,t)}writePackedSFixed32(e,t){t.length&&this.writeMessage(e,Sa,t)}writePackedFixed64(e,t){t.length&&this.writeMessage(e,Fa,t)}writePackedSFixed64(e,t){t.length&&this.writeMessage(e,Ea,t)}writeBytesField(e,t){this.writeTag(e,ot),this.writeBytes(t)}writeFixed32Field(e,t){this.writeTag(e,zt),this.writeFixed32(t)}writeSFixed32Field(e,t){this.writeTag(e,zt),this.writeSFixed32(t)}writeFixed64Field(e,t){this.writeTag(e,kt),this.writeFixed64(t)}writeSFixed64Field(e,t){this.writeTag(e,kt),this.writeSFixed64(t)}writeVarintField(e,t){this.writeTag(e,ar),this.writeVarint(t)}writeSVarintField(e,t){this.writeTag(e,ar),this.writeSVarint(t)}writeStringField(e,t){this.writeTag(e,ot),this.writeString(t)}writeFloatField(e,t){this.writeTag(e,zt),this.writeFloat(t)}writeDoubleField(e,t){this.writeTag(e,kt),this.writeDouble(t)}writeBooleanField(e,t){this.writeVarintField(e,+t)}}function ma(r,e,t){const n=t.buf;let i,o;if(o=n[t.pos++],i=(o&112)>>4,o<128||(o=n[t.pos++],i|=(o&127)<<3,o<128)||(o=n[t.pos++],i|=(o&127)<<10,o<128)||(o=n[t.pos++],i|=(o&127)<<17,o<128)||(o=n[t.pos++],i|=(o&127)<<24,o<128)||(o=n[t.pos++],i|=(o&1)<<31,o<128))return Le(r,i,e);throw new Error("Expected varint not more than 10 bytes")}function Le(r,e,t){return t?e*4294967296+(r>>>0):(e>>>0)*4294967296+(r>>>0)}function ya(r,e){let t,n;if(r>=0?(t=r%4294967296|0,n=r/4294967296|0):(t=~(-r%4294967296),n=~(-r/4294967296),t^4294967295?t=t+1|0:(t=0,n=n+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),ga(t,n,e),xa(n,e)}function ga(r,e,t){t.buf[t.pos++]=r&127|128,r>>>=7,t.buf[t.pos++]=r&127|128,r>>>=7,t.buf[t.pos++]=r&127|128,r>>>=7,t.buf[t.pos++]=r&127|128,r>>>=7,t.buf[t.pos]=r&127}function xa(r,e){const t=(r&7)<<4;e.buf[e.pos++]|=t|((r>>>=3)?128:0),r&&(e.buf[e.pos++]=r&127|((r>>>=7)?128:0),r&&(e.buf[e.pos++]=r&127|((r>>>=7)?128:0),r&&(e.buf[e.pos++]=r&127|((r>>>=7)?128:0),r&&(e.buf[e.pos++]=r&127|((r>>>=7)?128:0),r&&(e.buf[e.pos++]=r&127)))))}function _n(r,e,t){const n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));t.realloc(n);for(let i=t.pos-1;i>=r;i--)t.buf[i+n]=t.buf[i]}function ba(r,e){for(let t=0;t<r.length;t++)e.writeVarint(r[t])}function va(r,e){for(let t=0;t<r.length;t++)e.writeSVarint(r[t])}function wa(r,e){for(let t=0;t<r.length;t++)e.writeFloat(r[t])}function Ta(r,e){for(let t=0;t<r.length;t++)e.writeDouble(r[t])}function ka(r,e){for(let t=0;t<r.length;t++)e.writeBoolean(r[t])}function za(r,e){for(let t=0;t<r.length;t++)e.writeFixed32(r[t])}function Sa(r,e){for(let t=0;t<r.length;t++)e.writeSFixed32(r[t])}function Fa(r,e){for(let t=0;t<r.length;t++)e.writeFixed64(r[t])}function Ea(r,e){for(let t=0;t<r.length;t++)e.writeSFixed64(r[t])}function Ca(r,e,t){let n="",i=e;for(;i<t;){const o=r[i];let a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s>t)break;let l,u,c;s===1?o<128&&(a=o):s===2?(l=r[i+1],(l&192)===128&&(a=(o&31)<<6|l&63,a<=127&&(a=null))):s===3?(l=r[i+1],u=r[i+2],(l&192)===128&&(u&192)===128&&(a=(o&15)<<12|(l&63)<<6|u&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):s===4&&(l=r[i+1],u=r[i+2],c=r[i+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(a=(o&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,s=1):a>65535&&(a-=65536,n+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),n+=String.fromCharCode(a),i+=s}return n}function Ia(r,e,t){for(let n=0,i,o;n<e.length;n++){if(i=e.charCodeAt(n),i>55295&&i<57344)if(o)if(i<56320){r[t++]=239,r[t++]=191,r[t++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||n+1===e.length?(r[t++]=239,r[t++]=191,r[t++]=189):o=i;continue}else o&&(r[t++]=239,r[t++]=191,r[t++]=189,o=null);i<128?r[t++]=i:(i<2048?r[t++]=i>>6|192:(i<65536?r[t++]=i>>12|224:(r[t++]=i>>18|240,r[t++]=i>>12&63|128),r[t++]=i>>6&63|128),r[t++]=i&63|128)}return t}class $r extends Ko{constructor(e){super(),e=e||{},this.dataProjection=new Io({code:"",units:"tile-pixels"}),this.featureClass=e.featureClass?e.featureClass:kr,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,n,i){e.pos=t.geometry;const o=e.readVarint()+e.pos;let a=1,s=0,l=0,u=0,c=0,d=0;for(;e.pos<o;){if(!s){const p=e.readVarint();a=p&7,s=p>>3}if(s--,a===1||a===2)l+=e.readSVarint(),u+=e.readSVarint(),a===1&&c>d&&(i.push(c),d=c),n.push(l,u),c+=2;else if(a===7)c>d&&(n.push(n[d],n[d+1]),c+=2);else throw new Error("Invalid command found in the PBF")}c>d&&(i.push(c),d=c)}createFeature_(e,t,n){const i=t.type;if(i===0)return null;let o;const a=t.properties;let s;this.idProperty_?(s=a[this.idProperty_],delete a[this.idProperty_]):s=t.id,a[this.layerName_]=t.layer.name;const l=[],u=[];this.readRawGeometry_(e,t,l,u);const c=Aa(i,u.length);if(this.featureClass===kr)o=new this.featureClass(c,l,u,2,a,s),o.transform(n.dataProjection);else{let d;if(c=="Polygon"){const f=_o(l,u);d=f.length>1?new ea(l,"XY",f):new Po(l,"XY",u)}else d=c==="Point"?new Ro(l,"XY"):c==="LineString"?new Qo(l,"XY"):c==="MultiPoint"?new ta(l,"XY"):c==="MultiLineString"?new ra(l,"XY",u):null;const p=this.featureClass;o=new p,this.geometryName_&&o.setGeometryName(this.geometryName_);const h=Jo(d,!1,n);o.setGeometry(h),s!==void 0&&o.setId(s),o.setProperties(a,!0)}return o}getType(){return"arraybuffer"}readFeatures(e,t){const n=this.layers_;t=this.adaptOptions(t);const i=Xe(t.dataProjection);i.setWorldExtent(t.extent),t.dataProjection=i;const o=new ha(e),a=o.readFields(_a,{}),s=[];for(const l in a){if(n&&!n.includes(l))continue;const u=a[l],c=u?[0,0,u.extent,u.extent]:null;i.setExtent(c);for(let d=0,p=u.length;d<p;++d){const h=Ma(o,u,d),f=this.createFeature_(o,h,t);f!==null&&s.push(f)}}return s}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function _a(r,e,t){if(r===3){const n={keys:[],values:[],features:[]},i=t.readVarint()+t.pos;t.readFields(Pa,n,i),n.length=n.features.length,n.length&&(e[n.name]=n)}}function Pa(r,e,t){if(r===15)e.version=t.readVarint();else if(r===1)e.name=t.readString();else if(r===5)e.extent=t.readVarint();else if(r===2)e.features.push(t.pos);else if(r===3)e.keys.push(t.readString());else if(r===4){let n=null;const i=t.readVarint()+t.pos;for(;t.pos<i;)r=t.readVarint()>>3,n=r===1?t.readString():r===2?t.readFloat():r===3?t.readDouble():r===4?t.readVarint64():r===5?t.readVarint():r===6?t.readSVarint():r===7?t.readBoolean():null;e.values.push(n)}}function Ra(r,e,t){if(r==1)e.id=t.readVarint();else if(r==2){const n=t.readVarint()+t.pos;for(;t.pos<n;){const i=e.layer.keys[t.readVarint()],o=e.layer.values[t.readVarint()];e.properties[i]=o}}else r==3?e.type=t.readVarint():r==4&&(e.geometry=t.pos)}function Ma(r,e,t){r.pos=e.features[t];const n=r.readVarint()+r.pos,i={layer:e,type:0,properties:{}};return r.readFields(Ra,i,n),i}function Aa(r,e){let t;return r===1?t=e===1?"Point":"MultiPoint":r===2?t=e===1?"LineString":"MultiLineString":r===3&&(t="Polygon"),t}function pi(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Da={},di,Pn={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ct(r){return r=Math.round(r),r<0?0:r>255?255:r}function Rn(r){return r<0?0:r>1?1:r}function sr(r){return r[r.length-1]==="%"?ct(parseFloat(r)/100*255):ct(parseInt(r))}function St(r){return r[r.length-1]==="%"?Rn(parseFloat(r)/100):Rn(parseFloat(r))}function lr(r,e,t){return t<0?t+=1:t>1&&(t-=1),t*6<1?r+(e-r)*t*6:t*2<1?e:t*3<2?r+(e-r)*(2/3-t)*6:r}function ja(r){var e=r.replace(/ /g,"").toLowerCase();if(e in Pn)return Pn[e].slice();if(e[0]==="#"){if(e.length===4){var t=parseInt(e.substr(1),16);return t>=0&&t<=4095?[(t&3840)>>4|(t&3840)>>8,t&240|(t&240)>>4,t&15|(t&15)<<4,1]:null}else if(e.length===7){var t=parseInt(e.substr(1),16);return t>=0&&t<=16777215?[(t&16711680)>>16,(t&65280)>>8,t&255,1]:null}return null}var n=e.indexOf("("),i=e.indexOf(")");if(n!==-1&&i+1===e.length){var o=e.substr(0,n),a=e.substr(n+1,i-(n+1)).split(","),s=1;switch(o){case"rgba":if(a.length!==4)return null;s=St(a.pop());case"rgb":return a.length!==3?null:[sr(a[0]),sr(a[1]),sr(a[2]),s];case"hsla":if(a.length!==4)return null;s=St(a.pop());case"hsl":if(a.length!==3)return null;var l=(parseFloat(a[0])%360+360)%360/360,u=St(a[1]),c=St(a[2]),d=c<=.5?c*(u+1):c+u-c*u,p=c*2-d;return[ct(lr(p,d,l+1/3)*255),ct(lr(p,d,l)*255),ct(lr(p,d,l-1/3)*255),s];default:return null}}return null}try{di=Da.parseCSSColor=ja}catch{}class ae{constructor(e,t,n,i=1){this.r=e,this.g=t,this.b=n,this.a=i}static parse(e){if(!e)return;if(e instanceof ae)return e;if(typeof e!="string")return;const t=di(e);if(t)return new ae(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}toString(){const[e,t,n,i]=this.toArray();return`rgba(${Math.round(e)},${Math.round(t)},${Math.round(n)},${i})`}toArray(){const{r:e,g:t,b:n,a:i}=this;return i===0?[0,0,0,0]:[e*255/i,t*255/i,n*255/i,i]}toArray01(){const{r:e,g:t,b:n,a:i}=this;return i===0?[0,0,0,0]:[e/i,t/i,n/i,i]}toArray01PremultipliedAlpha(){const{r:e,g:t,b:n,a:i}=this;return[e,t,n,i]}}ae.black=new ae(0,0,0,1);ae.white=new ae(1,1,1,1);ae.transparent=new ae(0,0,0,0);ae.red=new ae(1,0,0,1);ae.blue=new ae(0,0,1,1);var ue=ae;function ft(r){return typeof r=="object"?["literal",r]:r}function La(r,e){let t=r.stops;if(!t)return $a(r,e);const n=t&&typeof t[0][0]=="object",i=n||r.property!==void 0,o=n||!i;return t=t.map(a=>!i&&e.tokens&&typeof a[1]=="string"?[a[0],Va(a[1])]:[a[0],ft(a[1])]),n?Oa(r,e,t):o?Ga(r,e,t):Fr(r,e,t)}function $a(r,e){const t=["get",r.property];if(r.default===void 0)return e.type==="string"?["string",t]:t;if(e.type==="enum")return["match",t,Object.keys(e.values),t,r.default];{const n=[e.type==="color"?"to-color":e.type,t,ft(r.default)];return e.type==="array"&&n.splice(1,0,e.value,e.length||null),n}}function Or(r){switch(r.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function Oa(r,e,t){const n={},i={},o=[];for(let s=0;s<t.length;s++){const l=t[s],u=l[0].zoom;n[u]===void 0&&(n[u]={zoom:u,type:r.type,property:r.property,default:r.default},i[u]=[],o.push(u)),i[u].push([l[0].value,l[1]])}if(Gr({},e)==="exponential"){const s=[Or(r),["linear"],["zoom"]];for(const l of o){const u=Fr(n[l],e,i[l]);Ue(s,l,u,!1)}return s}else{const s=["step",["zoom"]];for(const l of o){const u=Fr(n[l],e,i[l]);Ue(s,l,u,!0)}return qr(s),s}}function qa(r,e){if(r!==void 0)return r;if(e!==void 0)return e}function Mn(r,e){const t=ft(qa(r.default,e.default));return t===void 0&&e.type==="resolvedImage"?"":t}function Fr(r,e,t){const n=Gr(r,e),i=["get",r.property];if(n==="categorical"&&typeof t[0][0]=="boolean"){const o=["case"];for(const a of t)o.push(["==",i,a[0]],a[1]);return o.push(Mn(r,e)),o}else if(n==="categorical"){const o=["match",i];for(const a of t)Ue(o,a[0],a[1],!1);return o.push(Mn(r,e)),o}else if(n==="interval"){const o=["step",["number",i]];for(const a of t)Ue(o,a[0],a[1],!0);return qr(o),r.default===void 0?o:["case",["==",["typeof",i],"number"],o,ft(r.default)]}else if(n==="exponential"){const o=r.base!==void 0?r.base:1,a=[Or(r),o===1?["linear"]:["exponential",o],["number",i]];for(const s of t)Ue(a,s[0],s[1],!1);return r.default===void 0?a:["case",["==",["typeof",i],"number"],a,ft(r.default)]}else throw new Error(`Unknown property function type ${n}`)}function Ga(r,e,t,n=["zoom"]){const i=Gr(r,e);let o,a=!1;if(i==="interval")o=["step",n],a=!0;else if(i==="exponential"){const s=r.base!==void 0?r.base:1;o=[Or(r),s===1?["linear"]:["exponential",s],n]}else throw new Error(`Unknown zoom function type "${i}"`);for(const s of t)Ue(o,s[0],s[1],a);return qr(o),o}function qr(r){r[0]==="step"&&r.length===3&&(r.push(0),r.push(r[3]))}function Ue(r,e,t,n){r.length>3&&e===r[r.length-2]||(n&&r.length===2||r.push(e),r.push(t))}function Gr(r,e){return r.type?r.type:e.expression.interpolated?"exponential":"interval"}function Va(r){const e=["concat"],t=/{([^{}]+)}/g;let n=0;for(let i=t.exec(r);i!==null;i=t.exec(r)){const o=r.slice(n,t.lastIndex-i[0].length);n=t.lastIndex,o.length>0&&e.push(o),e.push(["get",i[1]])}if(e.length===1)return r;if(n<r.length)e.push(r.slice(n));else if(e.length===2)return["to-string",e[1]];return e}class Na extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}var be=Na;class Vr{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[n,i]of t)this.bindings[n]=i}concat(e){return new Vr(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}}var Ua=Vr;const Nt={kind:"null"},y={kind:"number"},R={kind:"string"},_={kind:"boolean"},ze={kind:"color"},Be={kind:"object"},P={kind:"value"},Ba={kind:"error"},Ut={kind:"collator"},Bt={kind:"formatted"},yt={kind:"resolvedImage"};function me(r,e){return{kind:"array",itemType:r,N:e}}function N(r){if(r.kind==="array"){const e=N(r.itemType);return typeof r.N=="number"?`array<${e}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${e}>`}else return r.kind}const Za=[Nt,y,R,_,ze,Bt,Be,me(P),yt];function ht(r,e){if(e.kind==="error")return null;if(r.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!ht(r.itemType,e.itemType))&&(typeof r.N!="number"||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if(r.kind==="value"){for(const t of Za)if(!ht(t,e))return null}}return`Expected ${N(r)} but found ${N(e)} instead.`}function Nr(r,e){return e.some(t=>t.kind===r.kind)}function mt(r,e){return e.some(t=>t==="null"?r===null:t==="array"?Array.isArray(r):t==="object"?r&&!Array.isArray(r)&&typeof r=="object":t===typeof r)}class Ur{constructor(e,t,n){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Er{constructor(e,t,n,i,o){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=n,this.fontStack=i,this.textColor=o}}class ve{constructor(e){this.sections=e}static fromString(e){return new ve([new Er(e,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof ve?e:ve.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const t of this.sections){if(t.image){e.push(["image",t.image.name]);continue}e.push(t.text);const n={};t.fontStack&&(n["text-font"]=["literal",t.fontStack.split(",")]),t.scale&&(n["font-scale"]=t.scale),t.textColor&&(n["text-color"]=["rgba"].concat(t.textColor.toArray())),e.push(n)}return e}}class Ie{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ie({name:e,available:!1}):null}serialize(){return["image",this.name]}}function fi(r,e,t,n){return typeof r=="number"&&r>=0&&r<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255?typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:`Invalid rgba value [${[r,e,t,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof n=="number"?[r,e,t,n]:[r,e,t]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function At(r){if(r===null)return!0;if(typeof r=="string")return!0;if(typeof r=="boolean")return!0;if(typeof r=="number")return!0;if(r instanceof ue)return!0;if(r instanceof Ur)return!0;if(r instanceof ve)return!0;if(r instanceof Ie)return!0;if(Array.isArray(r)){for(const e of r)if(!At(e))return!1;return!0}else if(typeof r=="object"){for(const e in r)if(!At(r[e]))return!1;return!0}else return!1}function Q(r){if(r===null)return Nt;if(typeof r=="string")return R;if(typeof r=="boolean")return _;if(typeof r=="number")return y;if(r instanceof ue)return ze;if(r instanceof Ur)return Ut;if(r instanceof ve)return Bt;if(r instanceof Ie)return yt;if(Array.isArray(r)){const e=r.length;let t;for(const n of r){const i=Q(n);if(!t)t=i;else{if(t===i)continue;t=P;break}}return me(t||P,e)}else return Be}function pt(r){const e=typeof r;return r===null?"":e==="string"||e==="number"||e==="boolean"?String(r):r instanceof ue||r instanceof ve||r instanceof Ie?r.toString():JSON.stringify(r)}class Br{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(e.length!==2)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!At(e[1]))return t.error("invalid value");const n=e[1];let i=Q(n);const o=t.expectedType;return i.kind==="array"&&i.N===0&&o&&o.kind==="array"&&(typeof o.N!="number"||o.N===0)&&(i=o),new Br(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ue?["rgba"].concat(this.value.toArray()):this.value instanceof ve?this.value.serialize():this.value}}var Dt=Br;class Ha{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}var te=Ha;const ur={string:R,number:y,boolean:_,object:Be};class Zr{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let n=1,i;const o=e[0];if(o==="array"){let s;if(e.length>2){const u=e[1];if(typeof u!="string"||!(u in ur)||u==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);s=ur[u],n++}else s=P;let l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);l=e[2],n++}i=me(s,l)}else i=ur[o];const a=[];for(;n<e.length;n++){const s=t.parse(e[n],n,P);if(!s)return null;a.push(s)}return new Zr(i,a)}evaluate(e){for(let t=0;t<this.args.length;t++){const n=this.args[t].evaluate(e);if(ht(this.type,Q(n))){if(t===this.args.length-1)throw new te(`Expected value to be of type ${N(this.type)}, but found ${N(Q(n))} instead.`)}else return n}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,t=[e.kind];if(e.kind==="array"){const n=e.itemType;if(n.kind==="string"||n.kind==="number"||n.kind==="boolean"){t.push(n.kind);const i=e.N;(typeof i=="number"||this.args.length>1)&&t.push(i)}}return t.concat(this.args.map(n=>n.serialize()))}}var ke=Zr;class Zt{constructor(e){this.type=Bt,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[1];if(!Array.isArray(n)&&typeof n=="object")return t.error("First argument must be an image or text section.");const i=[];let o=!1;for(let a=1;a<=e.length-1;++a){const s=e[a];if(o&&typeof s=="object"&&!Array.isArray(s)){o=!1;let l=null;if(s["font-scale"]&&(l=t.parse(s["font-scale"],1,y),!l))return null;let u=null;if(s["text-font"]&&(u=t.parse(s["text-font"],1,me(R)),!u))return null;let c=null;if(s["text-color"]&&(c=t.parse(s["text-color"],1,ze),!c))return null;const d=i[i.length-1];d.scale=l,d.font=u,d.textColor=c}else{const l=t.parse(e[a],1,P);if(!l)return null;const u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");o=!0,i.push({content:l,scale:null,font:null,textColor:null})}}return new Zt(i)}evaluate(e){const t=n=>{const i=n.content.evaluate(e);return Q(i)===yt?new Er("",i,null,null,null):new Er(pt(i),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)};return new ve(this.sections.map(t))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const t of this.sections){e.push(t.content.serialize());const n={};t.scale&&(n["font-scale"]=t.scale.serialize()),t.font&&(n["text-font"]=t.font.serialize()),t.textColor&&(n["text-color"]=t.textColor.serialize()),e.push(n)}return e}}class Ht{constructor(e){this.type=yt,this.input=e}static parse(e,t){if(e.length!==2)return t.error("Expected two arguments.");const n=t.parse(e[1],1,R);return n?new Ht(n):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),n=Ie.fromString(t);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(t)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Xa={"to-boolean":_,"to-color":ze,"to-number":y,"to-string":R};class Hr{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[0];if((n==="to-boolean"||n==="to-string")&&e.length!==2)return t.error("Expected one argument.");const i=Xa[n],o=[];for(let a=1;a<e.length;a++){const s=t.parse(e[a],a,P);if(!s)return null;o.push(s)}return new Hr(i,o)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let t,n;for(const i of this.args){if(t=i.evaluate(e),n=null,t instanceof ue)return t;if(typeof t=="string"){const o=e.parseColor(t);if(o)return o}else if(Array.isArray(t)&&(t.length<3||t.length>4?n=`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:n=fi(t[0],t[1],t[2],t[3]),!n))return new ue(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new te(n||`Could not parse color from value '${typeof t=="string"?t:String(JSON.stringify(t))}'`)}else if(this.type.kind==="number"){let t=null;for(const n of this.args){if(t=n.evaluate(e),t===null)return 0;const i=Number(t);if(!isNaN(i))return i}throw new te(`Could not convert ${JSON.stringify(t)} to number.`)}else return this.type.kind==="formatted"?ve.fromString(pt(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ie.fromString(pt(this.args[0].evaluate(e))):pt(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Zt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ht(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(t=>{e.push(t.serialize())}),e}}var Ve=Hr;const Wa=["Unknown","Point","LineString","Polygon"];class Ka{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Wa[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:n,y:i}=this.featureTileCoord,o=n*t-e[0],a=i*t-e[1],s=this.featureDistanceData.bearing[0],l=this.featureDistanceData.bearing[1];return s*o+l*a}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ue.parse(e)),t}}var hi=Ka;class Ne{constructor(e,t,n,i){this.name=e,this.type=t,this._evaluate=n,this.args=i}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,t){const n=e[0],i=Ne.definitions[n];if(!i)return t.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter(([u])=>!Array.isArray(u)||u.length===e.length-1);let l=null;for(const[u,c]of s){l=new bi(t.registry,t.path,null,t.scope);const d=[];let p=!1;for(let h=1;h<e.length;h++){const f=e[h],x=Array.isArray(u)?u[h-1]:u.type,m=l.parse(f,1+d.length,x);if(!m){p=!0;break}d.push(m)}if(!p){if(Array.isArray(u)&&u.length!==d.length){l.error(`Expected ${u.length} arguments, but found ${d.length} instead.`);continue}for(let h=0;h<d.length;h++){const f=Array.isArray(u)?u[h]:u.type,x=d[h];l.concat(h+1).checkSubtype(f,x.type)}if(l.errors.length===0)return new Ne(n,o,c,d)}}if(s.length===1)t.errors.push(...l.errors);else{const c=(s.length?s:a).map(([p])=>Ja(p)).join(" | "),d=[];for(let p=1;p<e.length;p++){const h=t.parse(e[p],1+d.length);if(!h)return null;d.push(N(h.type))}t.error(`Expected arguments of type ${c}, but found (${d.join(", ")}) instead.`)}return null}static register(e,t){Ne.definitions=t;for(const n in t)e[n]=Ne}}function Ja(r){return Array.isArray(r)?`(${r.map(N).join(", ")})`:`(${N(r.type)}...)`}var Ke=Ne;class Xt{constructor(e,t,n){this.type=Ut,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(e.length!==2)return t.error("Expected one argument.");const n=e[1];if(typeof n!="object"||Array.isArray(n))return t.error("Collator options argument must be an object.");const i=t.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,_);if(!i)return null;const o=t.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,_);if(!o)return null;let a=null;return n.locale&&(a=t.parse(n.locale,1,R),!a)?null:new Xt(i,o,a)}evaluate(e){return new Ur(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Ce=8192;function Xr(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function Ya(r){return(180+r)/360}function Qa(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function jt(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function es(r,e){const t=Ya(r[0]),n=Qa(r[1]),i=Math.pow(2,e.z);return[Math.round(t*i*Ce),Math.round(n*i*Ce)]}function ts(r,e,t){const n=r[0]-e[0],i=r[1]-e[1],o=r[0]-t[0],a=r[1]-t[1];return n*a-o*i===0&&n*o<=0&&i*a<=0}function rs(r,e,t){return e[1]>r[1]!=t[1]>r[1]&&r[0]<(t[0]-e[0])*(r[1]-e[1])/(t[1]-e[1])+e[0]}function Wr(r,e){let t=!1;for(let n=0,i=e.length;n<i;n++){const o=e[n];for(let a=0,s=o.length;a<s-1;a++){if(ts(r,o[a],o[a+1]))return!1;rs(r,o[a],o[a+1])&&(t=!t)}}return t}function ns(r,e){for(let t=0;t<e.length;t++)if(Wr(r,e[t]))return!0;return!1}function is(r,e){return r[0]*e[1]-r[1]*e[0]}function An(r,e,t,n){const i=r[0]-t[0],o=r[1]-t[1],a=e[0]-t[0],s=e[1]-t[1],l=n[0]-t[0],u=n[1]-t[1],c=i*u-l*o,d=a*u-l*s;return c>0&&d<0||c<0&&d>0}function os(r,e,t,n){const i=[e[0]-r[0],e[1]-r[1]],o=[n[0]-t[0],n[1]-t[1]];return is(o,i)===0?!1:!!(An(r,e,t,n)&&An(t,n,r,e))}function as(r,e,t){for(const n of t)for(let i=0;i<n.length-1;++i)if(os(r,e,n[i],n[i+1]))return!0;return!1}function mi(r,e){for(let t=0;t<r.length;++t)if(!Wr(r[t],e))return!1;for(let t=0;t<r.length-1;++t)if(as(r[t],r[t+1],e))return!1;return!0}function ss(r,e){for(let t=0;t<e.length;t++)if(mi(r,e[t]))return!0;return!1}function Kr(r,e,t){const n=[];for(let i=0;i<r.length;i++){const o=[];for(let a=0;a<r[i].length;a++){const s=es(r[i][a],t);Xr(e,s),o.push(s)}n.push(o)}return n}function yi(r,e,t){const n=[];for(let i=0;i<r.length;i++){const o=Kr(r[i],e,t);n.push(o)}return n}function gi(r,e,t,n){if(r[0]<t[0]||r[0]>t[2]){const i=n*.5;let o=r[0]-t[0]>i?-n:t[0]-r[0]>i?n:0;o===0&&(o=r[0]-t[2]>i?-n:t[2]-r[0]>i?n:0),r[0]+=o}Xr(e,r)}function ls(r){r[0]=r[1]=1/0,r[2]=r[3]=-1/0}function Dn(r,e,t,n){const i=Math.pow(2,n.z)*Ce,o=[n.x*Ce,n.y*Ce],a=[];if(!r)return a;for(const s of r)for(const l of s){const u=[l.x+o[0],l.y+o[1]];gi(u,e,t,i),a.push(u)}return a}function jn(r,e,t,n){const i=Math.pow(2,n.z)*Ce,o=[n.x*Ce,n.y*Ce],a=[];if(!r)return a;for(const s of r){const l=[];for(const u of s){const c=[u.x+o[0],u.y+o[1]];Xr(e,c),l.push(c)}a.push(l)}if(e[2]-e[0]<=i/2){ls(e);for(const s of a)for(const l of s)gi(l,e,t,i)}return a}function us(r,e){const t=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=r.canonicalID();if(!i)return!1;if(e.type==="Polygon"){const o=Kr(e.coordinates,n,i),a=Dn(r.geometry(),t,n,i);if(!jt(t,n))return!1;for(const s of a)if(!Wr(s,o))return!1}if(e.type==="MultiPolygon"){const o=yi(e.coordinates,n,i),a=Dn(r.geometry(),t,n,i);if(!jt(t,n))return!1;for(const s of a)if(!ns(s,o))return!1}return!0}function cs(r,e){const t=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=r.canonicalID();if(!i)return!1;if(e.type==="Polygon"){const o=Kr(e.coordinates,n,i),a=jn(r.geometry(),t,n,i);if(!jt(t,n))return!1;for(const s of a)if(!mi(s,o))return!1}if(e.type==="MultiPolygon"){const o=yi(e.coordinates,n,i),a=jn(r.geometry(),t,n,i);if(!jt(t,n))return!1;for(const s of a)if(!ss(s,o))return!1}return!0}class dt{constructor(e,t){this.type=_,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(At(e[1])){const n=e[1];if(n.type==="FeatureCollection")for(let i=0;i<n.features.length;++i){const o=n.features[i].geometry.type;if(o==="Polygon"||o==="MultiPolygon")return new dt(n,n.features[i].geometry)}else if(n.type==="Feature"){const i=n.geometry.type;if(i==="Polygon"||i==="MultiPolygon")return new dt(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new dt(n,n)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return us(e,this.geometries);if(e.geometryType()==="LineString")return cs(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Jr=dt;function Wt(r){if(r instanceof Ke){if(r.name==="get"&&r.args.length===1)return!1;if(r.name==="feature-state")return!1;if(r.name==="has"&&r.args.length===1)return!1;if(r.name==="properties"||r.name==="geometry-type"||r.name==="id")return!1;if(/^filter-/.test(r.name))return!1}if(r instanceof Jr)return!1;let e=!0;return r.eachChild(t=>{e&&!Wt(t)&&(e=!1)}),e}function Yr(r){if(r instanceof Ke&&r.name==="feature-state")return!1;let e=!0;return r.eachChild(t=>{e&&!Yr(t)&&(e=!1)}),e}function Qr(r,e){if(r instanceof Ke&&e.indexOf(r.name)>=0)return!1;let t=!0;return r.eachChild(n=>{t&&!Qr(n,e)&&(t=!1)}),t}class en{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");const n=e[1];return t.scope.has(n)?new en(n,t.scope.get(n)):t.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var xi=en;class tn{constructor(e,t=[],n,i=new Ua,o=[]){this.registry=e,this.path=t,this.key=t.map(a=>`[${a}]`).join(""),this.scope=i,this.errors=o,this.expectedType=n}parse(e,t,n,i,o={}){return t?this.concat(t,n,i)._parse(e,o):this._parse(e,o)}_parse(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function n(i,o,a){return a==="assert"?new ke(o,[i]):a==="coerce"?new Ve(o,[i]):i}if(Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=e[0];if(typeof i!="string")return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const o=this.registry[i];if(o){let a=o.parse(e,this);if(!a)return null;if(this.expectedType){const s=this.expectedType,l=a.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")a=n(a,s,t.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string"))a=n(a,s,t.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(a instanceof Dt)&&a.type.kind!=="resolvedImage"&&Cr(a)){const s=new hi;try{a=new Dt(a.type,a.evaluate(s))}catch(l){return this.error(l.message),null}}return a}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,n){const i=typeof e=="number"?this.path.concat(e):this.path,o=n?this.scope.concat(n):this.scope;return new tn(this.registry,i,t||null,o,this.errors)}error(e,...t){const n=`${this.key}${t.map(i=>`[${i}]`).join("")}`;this.errors.push(new be(n,e))}checkSubtype(e,t){const n=ht(e,t);return n&&this.error(n),n}}var bi=tn;function Cr(r){if(r instanceof xi)return Cr(r.boundExpression);if(r instanceof Ke&&r.name==="error")return!1;if(r instanceof Xt)return!1;if(r instanceof Jr)return!1;const e=r instanceof Ve||r instanceof ke;let t=!0;return r.eachChild(n=>{e?t=t&&Cr(n):t=t&&n instanceof Dt}),t?Wt(r)&&Qr(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]):!1}function vi(r,e){const t=r.length-1;let n=0,i=t,o=0,a,s;for(;n<=i;)if(o=Math.floor((n+i)/2),a=r[o],s=r[o+1],a<=e){if(o===t||e<s)return o;n=o+1}else if(a>e)i=o-1;else throw new te("Input is not a number.");return 0}class rn{constructor(e,t,n){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[i,o]of n)this.labels.push(i),this.outputs.push(o)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");const n=t.parse(e[1],1,y);if(!n)return null;const i=[];let o=null;t.expectedType&&t.expectedType.kind!=="value"&&(o=t.expectedType);for(let a=1;a<e.length;a+=2){const s=a===1?-1/0:e[a],l=e[a+1],u=a,c=a+1;if(typeof s!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);const d=t.parse(l,c,o);if(!d)return null;o=o||d.type,i.push([s,d])}return new rn(o,n,i)}evaluate(e){const t=this.labels,n=this.outputs;if(t.length===1)return n[0].evaluate(e);const i=this.input.evaluate(e);if(i<=t[0])return n[0].evaluate(e);const o=t.length;if(i>=t[o-1])return n[o-1].evaluate(e);const a=vi(t,i);return n[a].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}var wi=rn,ps=Je;function Je(r,e,t,n){this.cx=3*r,this.bx=3*(t-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=n,this.p2x=t,this.p2y=n}Je.prototype.sampleCurveX=function(r){return((this.ax*r+this.bx)*r+this.cx)*r};Je.prototype.sampleCurveY=function(r){return((this.ay*r+this.by)*r+this.cy)*r};Je.prototype.sampleCurveDerivativeX=function(r){return(3*this.ax*r+2*this.bx)*r+this.cx};Je.prototype.solveCurveX=function(r,e){typeof e>"u"&&(e=1e-6);var t,n,i,o,a;for(i=r,a=0;a<8;a++){if(o=this.sampleCurveX(i)-r,Math.abs(o)<e)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i=i-o/s}if(t=0,n=1,i=r,i<t)return t;if(i>n)return n;for(;t<n;){if(o=this.sampleCurveX(i),Math.abs(o-r)<e)return i;r>o?t=i:n=i,i=(n-t)*.5+t}return i};Je.prototype.solve=function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))};var ds=pi(ps);function le(r,e,t){return r*(1-t)+e*t}function fs(r,e,t){return new ue(le(r.r,e.r,t),le(r.g,e.g,t),le(r.b,e.b,t),le(r.a,e.a,t))}function hs(r,e,t){return r.map((n,i)=>le(n,e[i],t))}var ms=Object.freeze({__proto__:null,number:le,color:fs,array:hs});const Ti=.95047,ki=1,zi=1.08883,Si=4/29,Ze=6/29,Fi=3*Ze*Ze,ys=Ze*Ze*Ze,gs=Math.PI/180,xs=180/Math.PI;function cr(r){return r>ys?Math.pow(r,1/3):r/Fi+Si}function pr(r){return r>Ze?r*r*r:Fi*(r-Si)}function dr(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function fr(r){return r/=255,r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Ei(r){const e=fr(r.r),t=fr(r.g),n=fr(r.b),i=cr((.4124564*e+.3575761*t+.1804375*n)/Ti),o=cr((.2126729*e+.7151522*t+.072175*n)/ki),a=cr((.0193339*e+.119192*t+.9503041*n)/zi);return{l:116*o-16,a:500*(i-o),b:200*(o-a),alpha:r.a}}function Ci(r){let e=(r.l+16)/116,t=isNaN(r.a)?e:e+r.a/500,n=isNaN(r.b)?e:e-r.b/200;return e=ki*pr(e),t=Ti*pr(t),n=zi*pr(n),new ue(dr(3.2404542*t-1.5371385*e-.4985314*n),dr(-.969266*t+1.8760108*e+.041556*n),dr(.0556434*t-.2040259*e+1.0572252*n),r.alpha)}function bs(r,e,t){return{l:le(r.l,e.l,t),a:le(r.a,e.a,t),b:le(r.b,e.b,t),alpha:le(r.alpha,e.alpha,t)}}function vs(r){const{l:e,a:t,b:n}=Ei(r),i=Math.atan2(n,t)*xs;return{h:i<0?i+360:i,c:Math.sqrt(t*t+n*n),l:e,alpha:r.a}}function ws(r){const e=r.h*gs,t=r.c,n=r.l;return Ci({l:n,a:Math.cos(e)*t,b:Math.sin(e)*t,alpha:r.alpha})}function Ts(r,e,t){const n=e-r;return r+t*(n>180||n<-180?n-360*Math.round(n/360):n)}function ks(r,e,t){return{h:Ts(r.h,e.h,t),c:le(r.c,e.c,t),l:le(r.l,e.l,t),alpha:le(r.alpha,e.alpha,t)}}const Ft={forward:Ei,reverse:Ci,interpolate:bs},Et={forward:vs,reverse:ws,interpolate:ks};class Lt{constructor(e,t,n,i,o){this.type=e,this.operator=t,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[a,s]of o)this.labels.push(a),this.outputs.push(s)}static interpolationFactor(e,t,n,i){let o=0;if(e.name==="exponential")o=hr(t,e.base,n,i);else if(e.name==="linear")o=hr(t,1,n,i);else if(e.name==="cubic-bezier"){const a=e.controlPoints;o=new ds(a[0],a[1],a[2],a[3]).solve(hr(t,1,n,i))}return o}static parse(e,t){let[n,i,o,...a]=e;if(!Array.isArray(i)||i.length===0)return t.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){const u=i[1];if(typeof u!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:u}}else if(i[0]==="cubic-bezier"){const u=i.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}else return t.error(`Unknown interpolation type ${String(i[0])}`,1,0);if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(o=t.parse(o,2,y),!o)return null;const s=[];let l=null;n==="interpolate-hcl"||n==="interpolate-lab"?l=ze:t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(let u=0;u<a.length;u+=2){const c=a[u],d=a[u+1],p=u+3,h=u+4;if(typeof c!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(s.length&&s[s.length-1][0]>=c)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',p);const f=t.parse(d,h,l);if(!f)return null;l=l||f.type,s.push([c,f])}return l.kind!=="number"&&l.kind!=="color"&&!(l.kind==="array"&&l.itemType.kind==="number"&&typeof l.N=="number")?t.error(`Type ${N(l)} is not interpolatable.`):new Lt(l,n,i,o,s)}evaluate(e){const t=this.labels,n=this.outputs;if(t.length===1)return n[0].evaluate(e);const i=this.input.evaluate(e);if(i<=t[0])return n[0].evaluate(e);const o=t.length;if(i>=t[o-1])return n[o-1].evaluate(e);const a=vi(t,i),s=t[a],l=t[a+1],u=Lt.interpolationFactor(this.interpolation,i,s,l),c=n[a].evaluate(e),d=n[a+1].evaluate(e);return this.operator==="interpolate"?ms[this.type.kind.toLowerCase()](c,d,u):this.operator==="interpolate-hcl"?Et.reverse(Et.interpolate(Et.forward(c),Et.forward(d),u)):Ft.reverse(Ft.interpolate(Ft.forward(c),Ft.forward(d),u))}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;this.interpolation.name==="linear"?e=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?e=["linear"]:e=["exponential",this.interpolation.base]:e=["cubic-bezier"].concat(this.interpolation.controlPoints);const t=[this.operator,e,this.input.serialize()];for(let n=0;n<this.labels.length;n++)t.push(this.labels[n],this.outputs[n].serialize());return t}}function hr(r,e,t,n){const i=n-t,o=r-t;return i===0?0:e===1?o/i:(Math.pow(e,o)-1)/(Math.pow(e,i)-1)}var Me=Lt;class $t{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let n=null;const i=t.expectedType;i&&i.kind!=="value"&&(n=i);const o=[];for(const s of e.slice(1)){const l=t.parse(s,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,o.push(l)}return i&&o.some(s=>ht(i,s.type))?new $t(P,o):new $t(n,o)}evaluate(e){let t=null,n=0,i;for(const o of this.args){if(n++,t=o.evaluate(e),t&&t instanceof Ie&&!t.available&&(i||(i=t),t=null,n===this.args.length))return i;if(t!==null)break}return t}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(t=>{e.push(t.serialize())}),e}}var Ii=$t;class nn{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const n=[];for(let o=1;o<e.length-1;o+=2){const a=e[o];if(typeof a!="string")return t.error(`Expected string, but found ${typeof a} instead.`,o);if(/[^a-zA-Z0-9_]/.test(a))return t.error("Variable names must contain only alphanumeric characters or '_'.",o);const s=t.parse(e[o+1],o+1);if(!s)return null;n.push([a,s])}const i=t.parse(e[e.length-1],e.length-1,t.expectedType,n);return i?new nn(n,i):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[t,n]of this.bindings)e.push(t,n.serialize());return e.push(this.result.serialize()),e}}var _i=nn;class on{constructor(e,t,n){this.type=e,this.index=t,this.input=n}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,y),i=t.parse(e[2],2,me(t.expectedType||P));if(!n||!i)return null;const o=i.type;return new on(o.itemType,n,i)}evaluate(e){const t=this.index.evaluate(e),n=this.input.evaluate(e);if(t<0)throw new te(`Array index out of bounds: ${t} < 0.`);if(t>=n.length)throw new te(`Array index out of bounds: ${t} > ${n.length-1}.`);if(t!==Math.floor(t))throw new te(`Array index must be an integer, but found ${t} instead.`);return n[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var zs=on;class an{constructor(e,t){this.type=_,this.needle=e,this.haystack=t}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,P),i=t.parse(e[2],2,P);return!n||!i?null:Nr(n.type,[_,R,y,Nt,P])?new an(n,i):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${N(n.type)} instead`)}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(n==null)return!1;if(!mt(t,["boolean","string","number","null"]))throw new te(`Expected first argument to be of type boolean, string, number or null, but found ${N(Q(t))} instead.`);if(!mt(n,["string","array"]))throw new te(`Expected second argument to be of type array or string, but found ${N(Q(n))} instead.`);return n.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Ss=an;class Ot{constructor(e,t,n){this.type=y,this.needle=e,this.haystack=t,this.fromIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,P),i=t.parse(e[2],2,P);if(!n||!i)return null;if(!Nr(n.type,[_,R,y,Nt,P]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${N(n.type)} instead`);if(e.length===4){const o=t.parse(e[3],3,y);return o?new Ot(n,i,o):null}else return new Ot(n,i)}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!mt(t,["boolean","string","number","null"]))throw new te(`Expected first argument to be of type boolean, string, number or null, but found ${N(Q(t))} instead.`);if(!mt(n,["string","array"]))throw new te(`Expected second argument to be of type array or string, but found ${N(Q(n))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(e);return n.indexOf(t,i)}return n.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Fs=Ot;class sn{constructor(e,t,n,i,o,a){this.inputType=e,this.type=t,this.input=n,this.cases=i,this.outputs=o,this.otherwise=a}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!==1)return t.error("Expected an even number of arguments.");let n,i;t.expectedType&&t.expectedType.kind!=="value"&&(i=t.expectedType);const o={},a=[];for(let u=2;u<e.length-1;u+=2){let c=e[u];const d=e[u+1];Array.isArray(c)||(c=[c]);const p=t.concat(u);if(c.length===0)return p.error("Expected at least one branch label.");for(const f of c){if(typeof f!="number"&&typeof f!="string")return p.error("Branch labels must be numbers or strings.");if(typeof f=="number"&&Math.abs(f)>Number.MAX_SAFE_INTEGER)return p.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof f=="number"&&Math.floor(f)!==f)return p.error("Numeric branch labels must be integer values.");if(!n)n=Q(f);else if(p.checkSubtype(n,Q(f)))return null;if(typeof o[String(f)]<"u")return p.error("Branch labels must be unique.");o[String(f)]=a.length}const h=t.parse(d,u,i);if(!h)return null;i=i||h.type,a.push(h)}const s=t.parse(e[1],1,P);if(!s)return null;const l=t.parse(e[e.length-1],e.length-1,i);return!l||s.type.kind!=="value"&&t.concat(1).checkSubtype(n,s.type)?null:new sn(n,i,s,o,a,l)}evaluate(e){const t=this.input.evaluate(e);return(Q(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],t=Object.keys(this.cases).sort(),n=[],i={};for(const a of t){const s=i[this.cases[a]];s===void 0?(i[this.cases[a]]=n.length,n.push([this.cases[a],[a]])):n[s][1].push(a)}const o=a=>this.inputType.kind==="number"?Number(a):a;for(const[a,s]of n)s.length===1?e.push(o(s[0])):e.push(s.map(o)),e.push(this.outputs[a].serialize());return e.push(this.otherwise.serialize()),e}}var Es=sn;class ln{constructor(e,t,n){this.type=e,this.branches=t,this.otherwise=n}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!==0)return t.error("Expected an odd number of arguments.");let n;t.expectedType&&t.expectedType.kind!=="value"&&(n=t.expectedType);const i=[];for(let a=1;a<e.length-1;a+=2){const s=t.parse(e[a],a,_);if(!s)return null;const l=t.parse(e[a+1],a+1,n);if(!l)return null;i.push([s,l]),n=n||l.type}const o=t.parse(e[e.length-1],e.length-1,n);return o?new ln(n,i,o):null}evaluate(e){for(const[t,n]of this.branches)if(t.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,n]of this.branches)e(t),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(t=>{e.push(t.serialize())}),e}}var Cs=ln;class qt{constructor(e,t,n,i){this.type=e,this.input=t,this.beginIndex=n,this.endIndex=i}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const n=t.parse(e[1],1,P),i=t.parse(e[2],2,y);if(!n||!i)return null;if(!Nr(n.type,[me(P),R,P]))return t.error(`Expected first argument to be of type array or string, but found ${N(n.type)} instead`);if(e.length===4){const o=t.parse(e[3],3,y);return o?new qt(n.type,n,i,o):null}else return new qt(n.type,n,i)}evaluate(e){const t=this.input.evaluate(e),n=this.beginIndex.evaluate(e);if(!mt(t,["string","array"]))throw new te(`Expected first argument to be of type array or string, but found ${N(Q(t))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(e);return t.slice(n,i)}return t.slice(n)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Is=qt;function Ln(r,e){return r==="=="||r==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function _s(r,e,t){return e===t}function Ps(r,e,t){return e!==t}function Rs(r,e,t){return e<t}function Ms(r,e,t){return e>t}function As(r,e,t){return e<=t}function Ds(r,e,t){return e>=t}function Pi(r,e,t,n){return n.compare(e,t)===0}function js(r,e,t,n){return!Pi(r,e,t,n)}function Ls(r,e,t,n){return n.compare(e,t)<0}function $s(r,e,t,n){return n.compare(e,t)>0}function Os(r,e,t,n){return n.compare(e,t)<=0}function qs(r,e,t,n){return n.compare(e,t)>=0}function Ye(r,e,t){const n=r!=="=="&&r!=="!=";return class Ri{constructor(o,a,s){this.type=_,this.lhs=o,this.rhs=a,this.collator=s,this.hasUntypedArgument=o.type.kind==="value"||a.type.kind==="value"}static parse(o,a){if(o.length!==3&&o.length!==4)return a.error("Expected two or three arguments.");const s=o[0];let l=a.parse(o[1],1,P);if(!l)return null;if(!Ln(s,l.type))return a.concat(1).error(`"${s}" comparisons are not supported for type '${N(l.type)}'.`);let u=a.parse(o[2],2,P);if(!u)return null;if(!Ln(s,u.type))return a.concat(2).error(`"${s}" comparisons are not supported for type '${N(u.type)}'.`);if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error(`Cannot compare types '${N(l.type)}' and '${N(u.type)}'.`);n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new ke(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new ke(l.type,[u])));let c=null;if(o.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot use collator to compare non-string types.");if(c=a.parse(o[3],3,Ut),!c)return null}return new Ri(l,u,c)}evaluate(o){const a=this.lhs.evaluate(o),s=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){const l=Q(a),u=Q(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new te(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${l.kind}, ${u.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const l=Q(a),u=Q(s);if(l.kind!=="string"||u.kind!=="string")return e(o,a,s)}return this.collator?t(o,a,s,this.collator.evaluate(o)):e(o,a,s)}eachChild(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)}outputDefined(){return!0}serialize(){const o=[r];return this.eachChild(a=>{o.push(a.serialize())}),o}}}const Gs=Ye("==",_s,Pi),Vs=Ye("!=",Ps,js),Ns=Ye("<",Rs,Ls),Us=Ye(">",Ms,$s),Bs=Ye("<=",As,Os),Zs=Ye(">=",Ds,qs);class un{constructor(e,t,n,i,o,a){this.type=R,this.number=e,this.locale=t,this.currency=n,this.unit=i,this.minFractionDigits=o,this.maxFractionDigits=a}static parse(e,t){if(e.length!==3)return t.error("Expected two arguments.");const n=t.parse(e[1],1,y);if(!n)return null;const i=e[2];if(typeof i!="object"||Array.isArray(i))return t.error("NumberFormat options argument must be an object.");let o=null;if(i.locale&&(o=t.parse(i.locale,1,R),!o))return null;let a=null;if(i.currency&&(a=t.parse(i.currency,1,R),!a))return null;let s=null;if(i.unit&&(s=t.parse(i.unit,1,R),!s))return null;let l=null;if(i["min-fraction-digits"]&&(l=t.parse(i["min-fraction-digits"],1,y),!l))return null;let u=null;return i["max-fraction-digits"]&&(u=t.parse(i["max-fraction-digits"],1,y),!u)?null:new un(n,o,a,s,l,u)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency&&"currency"||this.unit&&"unit"||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class cn{constructor(e){this.type=y,this.input=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const n=t.parse(e[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?t.error(`Expected argument of type string or array, but found ${N(n.type)} instead.`):new cn(n):null}evaluate(e){const t=this.input.evaluate(e);if(typeof t=="string")return t.length;if(Array.isArray(t))return t.length;throw new te(`Expected value to be of type string or array, but found ${N(Q(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(t=>{e.push(t.serialize())}),e}}var Hs=cn;const Mi={"==":Gs,"!=":Vs,">":Us,"<":Ns,">=":Zs,"<=":Bs,array:ke,at:zs,boolean:ke,case:Cs,coalesce:Ii,collator:Xt,format:Zt,image:Ht,in:Ss,"index-of":Fs,interpolate:Me,"interpolate-hcl":Me,"interpolate-lab":Me,length:Hs,let:_i,literal:Dt,match:Es,number:ke,"number-format":un,object:ke,slice:Is,step:wi,string:ke,"to-boolean":Ve,"to-color":Ve,"to-number":Ve,"to-string":Ve,var:xi,within:Jr};function $n(r,[e,t,n,i]){e=e.evaluate(r),t=t.evaluate(r),n=n.evaluate(r);const o=i?i.evaluate(r):1,a=fi(e,t,n,o);if(a)throw new te(a);return new ue(e/255*o,t/255*o,n/255*o,o)}function On(r,e){return r in e}function mr(r,e){const t=e[r];return typeof t>"u"?null:t}function Xs(r,e,t,n){for(;t<=n;){const i=t+n>>1;if(e[i]===r)return!0;e[i]>r?n=i-1:t=i+1}return!1}function _e(r){return{type:r}}Ke.register(Mi,{error:[Ba,[R],(r,[e])=>{throw new te(e.evaluate(r))}],typeof:[R,[P],(r,[e])=>N(Q(e.evaluate(r)))],"to-rgba":[me(y,4),[ze],(r,[e])=>e.evaluate(r).toArray()],rgb:[ze,[y,y,y],$n],rgba:[ze,[y,y,y,y],$n],has:{type:_,overloads:[[[R],(r,[e])=>On(e.evaluate(r),r.properties())],[[R,Be],(r,[e,t])=>On(e.evaluate(r),t.evaluate(r))]]},get:{type:P,overloads:[[[R],(r,[e])=>mr(e.evaluate(r),r.properties())],[[R,Be],(r,[e,t])=>mr(e.evaluate(r),t.evaluate(r))]]},"feature-state":[P,[R],(r,[e])=>mr(e.evaluate(r),r.featureState||{})],properties:[Be,[],r=>r.properties()],"geometry-type":[R,[],r=>r.geometryType()],id:[P,[],r=>r.id()],zoom:[y,[],r=>r.globals.zoom],pitch:[y,[],r=>r.globals.pitch||0],"distance-from-center":[y,[],r=>r.distanceFromCenter()],"heatmap-density":[y,[],r=>r.globals.heatmapDensity||0],"line-progress":[y,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[y,[],r=>r.globals.skyRadialProgress||0],accumulated:[P,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[y,_e(y),(r,e)=>{let t=0;for(const n of e)t+=n.evaluate(r);return t}],"*":[y,_e(y),(r,e)=>{let t=1;for(const n of e)t*=n.evaluate(r);return t}],"-":{type:y,overloads:[[[y,y],(r,[e,t])=>e.evaluate(r)-t.evaluate(r)],[[y],(r,[e])=>-e.evaluate(r)]]},"/":[y,[y,y],(r,[e,t])=>e.evaluate(r)/t.evaluate(r)],"%":[y,[y,y],(r,[e,t])=>e.evaluate(r)%t.evaluate(r)],ln2:[y,[],()=>Math.LN2],pi:[y,[],()=>Math.PI],e:[y,[],()=>Math.E],"^":[y,[y,y],(r,[e,t])=>Math.pow(e.evaluate(r),t.evaluate(r))],sqrt:[y,[y],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[y,[y],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[y,[y],(r,[e])=>Math.log(e.evaluate(r))],log2:[y,[y],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[y,[y],(r,[e])=>Math.sin(e.evaluate(r))],cos:[y,[y],(r,[e])=>Math.cos(e.evaluate(r))],tan:[y,[y],(r,[e])=>Math.tan(e.evaluate(r))],asin:[y,[y],(r,[e])=>Math.asin(e.evaluate(r))],acos:[y,[y],(r,[e])=>Math.acos(e.evaluate(r))],atan:[y,[y],(r,[e])=>Math.atan(e.evaluate(r))],min:[y,_e(y),(r,e)=>Math.min(...e.map(t=>t.evaluate(r)))],max:[y,_e(y),(r,e)=>Math.max(...e.map(t=>t.evaluate(r)))],abs:[y,[y],(r,[e])=>Math.abs(e.evaluate(r))],round:[y,[y],(r,[e])=>{const t=e.evaluate(r);return t<0?-Math.round(-t):Math.round(t)}],floor:[y,[y],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[y,[y],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[_,[R,P],(r,[e,t])=>r.properties()[e.value]===t.value],"filter-id-==":[_,[P],(r,[e])=>r.id()===e.value],"filter-type-==":[_,[R],(r,[e])=>r.geometryType()===e.value],"filter-<":[_,[R,P],(r,[e,t])=>{const n=r.properties()[e.value],i=t.value;return typeof n==typeof i&&n<i}],"filter-id-<":[_,[P],(r,[e])=>{const t=r.id(),n=e.value;return typeof t==typeof n&&t<n}],"filter->":[_,[R,P],(r,[e,t])=>{const n=r.properties()[e.value],i=t.value;return typeof n==typeof i&&n>i}],"filter-id->":[_,[P],(r,[e])=>{const t=r.id(),n=e.value;return typeof t==typeof n&&t>n}],"filter-<=":[_,[R,P],(r,[e,t])=>{const n=r.properties()[e.value],i=t.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[_,[P],(r,[e])=>{const t=r.id(),n=e.value;return typeof t==typeof n&&t<=n}],"filter->=":[_,[R,P],(r,[e,t])=>{const n=r.properties()[e.value],i=t.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[_,[P],(r,[e])=>{const t=r.id(),n=e.value;return typeof t==typeof n&&t>=n}],"filter-has":[_,[P],(r,[e])=>e.value in r.properties()],"filter-has-id":[_,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[_,[me(R)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[_,[me(P)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[_,[R,me(P)],(r,[e,t])=>t.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[_,[R,me(P)],(r,[e,t])=>Xs(r.properties()[e.value],t.value,0,t.value.length-1)],all:{type:_,overloads:[[[_,_],(r,[e,t])=>e.evaluate(r)&&t.evaluate(r)],[_e(_),(r,e)=>{for(const t of e)if(!t.evaluate(r))return!1;return!0}]]},any:{type:_,overloads:[[[_,_],(r,[e,t])=>e.evaluate(r)||t.evaluate(r)],[_e(_),(r,e)=>{for(const t of e)if(t.evaluate(r))return!0;return!1}]]},"!":[_,[_],(r,[e])=>!e.evaluate(r)],"is-supported-script":[_,[R],(r,[e])=>{const t=r.globals&&r.globals.isSupportedScript;return t?t(e.evaluate(r)):!0}],upcase:[R,[R],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[R,[R],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[R,_e(P),(r,e)=>e.map(t=>pt(t.evaluate(r))).join("")],"resolved-locale":[R,[Ut],(r,[e])=>e.evaluate(r).resolvedLocale()]});var Ai=Mi;function Ir(r){return{result:"success",value:r}}function Oe(r){return{result:"error",value:r}}function Ws(r){return r["property-type"]==="data-driven"}function Ks(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function Js(r){return!!r.expression&&r.expression.interpolated}function Di(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}class Ys{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new hi,this._defaultValue=t?rl(t):null,this._enumValues=t&&t.type==="enum"?t.values:null}evaluateWithoutErrorHandling(e,t,n,i,o,a,s,l){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=n,this._evaluator.canonical=i||null,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=l||null,this.expression.evaluate(this._evaluator)}evaluate(e,t,n,i,o,a,s,l){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i||null,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a||null,this._evaluator.featureTileCoord=s||null,this._evaluator.featureDistanceData=l||null;try{const u=this.expression.evaluate(this._evaluator);if(u==null||typeof u=="number"&&u!==u)return this._defaultValue;if(this._enumValues&&!(u in this._enumValues))throw new te(`Expected value to be one of ${Object.keys(this._enumValues).map(c=>JSON.stringify(c)).join(", ")}, but found ${JSON.stringify(u)} instead.`);return u}catch(u){return this._warningHistory[u.message]||(this._warningHistory[u.message]=!0,typeof console<"u"&&console.warn(u.message)),this._defaultValue}}}function Qs(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Ai}function _r(r,e){const t=new bi(Ai,[],e?tl(e):void 0),n=t.parse(r,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?Ir(new Ys(n,e)):Oe(t.errors)}class qn{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!Yr(t.expression)}evaluateWithoutErrorHandling(e,t,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,o,a)}evaluate(e,t,n,i,o,a){return this._styleExpression.evaluate(e,t,n,i,o,a)}}class Gn{constructor(e,t,n,i){this.kind=e,this.zoomStops=n,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!Yr(t.expression),this.interpolationType=i}evaluateWithoutErrorHandling(e,t,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,i,o,a)}evaluate(e,t,n,i,o,a){return this._styleExpression.evaluate(e,t,n,i,o,a)}interpolationFactor(e,t,n){return this.interpolationType?Me.interpolationFactor(this.interpolationType,e,t,n):0}}function el(r,e){if(r=_r(r,e),r.result==="error")return r;const t=r.value.expression,n=Wt(t);if(!n&&!Ws(e))return Oe([new be("","data expressions not supported")]);const i=Qr(t,["zoom","pitch","distance-from-center"]);if(!i&&!Ks(e))return Oe([new be("","zoom expressions not supported")]);const o=Pt(t);if(!o&&!i)return Oe([new be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof be)return Oe([o]);if(o instanceof Me&&!Js(e))return Oe([new be("",'"interpolate" expressions cannot be used with this property')]);if(!o)return Ir(n?new qn("constant",r.value):new qn("source",r.value));const a=o instanceof Me?o.interpolation:void 0;return Ir(n?new Gn("camera",r.value,o.labels,a):new Gn("composite",r.value,o.labels,a))}function Pt(r){let e=null;if(r instanceof _i)e=Pt(r.result);else if(r instanceof Ii){for(const t of r.args)if(e=Pt(t),e)break}else(r instanceof wi||r instanceof Me)&&r.input instanceof Ke&&r.input.name==="zoom"&&(e=r);return e instanceof be||r.eachChild(t=>{const n=Pt(t);n instanceof be?e=n:!e&&n?e=new be("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new be("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function tl(r){const e={color:ze,string:R,number:y,enum:R,boolean:_,formatted:Bt,resolvedImage:yt};return r.type==="array"?me(e[r.value]||P,r.length):e[r.type]}function rl(r){return r.type==="color"&&(Di(r.default)||Array.isArray(r.default))?new ue(0,0,0,0):r.type==="color"?ue.parse(r.default)||null:r.default===void 0?null:r.default}function nl(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Pr(r){if(Array.isArray(r))return r.map(Pr);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const t in r)e[t]=Pr(r[t]);return e}return nl(r)}var ji={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"},"fill-extrusion-edge-radius":{type:"number",private:!0,default:0,minimum:0,maximum:1,"property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"high-color":{type:"color","property-type":"data-constant",default:"#245cdf",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"space-color":{type:"color","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],4,.2,7,.1],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"star-intensity":{type:"number","property-type":"data-constant",default:["interpolate",["linear"],["zoom"],5,.35,6,0],minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{},globe:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-180,-90],maximum:[180,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",minimum:[-90,-90],maximum:[90,90],transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["source"]}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant",type:"number",private:!0,default:0,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant",type:"number",private:!0,default:3,minimum:0,expression:{interpolated:!0,parameters:["zoom"]},transition:!0,requires:["fill-extrusion-edge-radius"]}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!1,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{type:"array",value:"number",length:2,default:[0,0],minimum:[0,0],maximum:[1,1],transition:!1,requires:[{source:"geojson",has:{lineMetrics:!0}}],"property-type":"constant"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};function Li(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!Li(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function il(r,e="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Li(r)||(r=Gt(r));const t=r;let n=!0;try{n=ol(t)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(t,null,2)}
        `)}const i=ji[`filter_${e}`],o=_r(n,i);let a=null;if(o.result==="error")throw new Error(o.value.map(c=>`${c.key}: ${c.message}`).join(", "));a=(c,d,p)=>o.value.evaluate(c,d,{},p);let s=null,l=null;if(n!==t){const c=_r(t,i);if(c.result==="error")throw new Error(c.value.map(d=>`${d.key}: ${d.message}`).join(", "));s=(d,p,h,f,x)=>c.value.evaluate(d,p,{},h,void 0,void 0,f,x),l=!Wt(c.value.expression)}a=a;const u=qi(n);return{filter:a,dynamicFilter:s||void 0,needGeometry:u,needFeature:!!l}}function ol(r){if(!He(r))return r;let e=Pr(r);return Oi(e),e=$i(e),e}function $i(r){if(!Array.isArray(r))return r;const e=ll(r);return e===!0?e:e.map(t=>$i(t))}function Oi(r){let e=!1;const t=[];if(r[0]==="case"){for(let n=1;n<r.length-1;n+=2)e=e||He(r[n]),t.push(r[n+1]);t.push(r[r.length-1])}else if(r[0]==="match"){e=e||He(r[1]);for(let n=2;n<r.length-1;n+=2)t.push(r[n+1]);t.push(r[r.length-1])}else if(r[0]==="step"){e=e||He(r[1]);for(let n=1;n<r.length-1;n+=2)t.push(r[n+1])}e&&(r.length=0,r.push("any",...t));for(let n=1;n<r.length;n++)Oi(r[n])}function He(r){if(!Array.isArray(r))return!1;if(al(r[0]))return!0;for(let e=1;e<r.length;e++){const t=r[e];if(He(t))return!0}return!1}function al(r){return r==="pitch"||r==="distance-from-center"}const sl=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ll(r){if(sl.has(r[0]))for(let e=1;e<r.length;e++){const t=r[e];if(He(t))return!0}return r}function ul(r,e){return r<e?-1:r>e?1:0}function qi(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let e=1;e<r.length;e++)if(qi(r[e]))return!0;return!1}function Gt(r){if(!r)return!0;const e=r[0];return r.length<=1?e!=="any":e==="=="?yr(r[1],r[2],"=="):e==="!="?Ct(yr(r[1],r[2],"==")):e==="<"||e===">"||e==="<="||e===">="?yr(r[1],r[2],e):e==="any"?cl(r.slice(1)):e==="all"?["all"].concat(r.slice(1).map(Gt)):e==="none"?["all"].concat(r.slice(1).map(Gt).map(Ct)):e==="in"?Vn(r[1],r.slice(2)):e==="!in"?Ct(Vn(r[1],r.slice(2))):e==="has"?Nn(r[1]):e==="!has"?Ct(Nn(r[1])):e==="within"?r:!0}function yr(r,e,t){switch(r){case"$type":return[`filter-type-${t}`,e];case"$id":return[`filter-id-${t}`,e];default:return[`filter-${t}`,r,e]}}function cl(r){return["any"].concat(r.map(Gt))}function Vn(r,e){if(e.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",r,["literal",e.sort(ul)]]:["filter-in-small",r,["literal",e]]}}function Nn(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Ct(r){return["!",r]}var pl=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function dl(r,e){const t={};for(const n in r)n!=="ref"&&(t[n]=r[n]);return pl.forEach(n=>{n in e&&(t[n]=e[n])}),t}function fl(r){r=r.slice();const e=Object.create(null);for(let t=0;t<r.length;t++)e[r[t].id]=r[t];for(let t=0;t<r.length;t++)"ref"in r[t]&&(r[t]=dl(r[t],e[r[t].ref]));return r}var Un={thin:100,hairline:100,"ultra-light":200,"extra-light":200,light:300,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,"extra-bold":800,"ultra-bold":800,heavy:900,black:900,"heavy-black":900,fat:900,poster:900,"ultra-black":950,"extra-black":950},at=" ",Bn=/(italic|oblique)$/i,Zn={},hl=function(r,e,t){var n=Zn[r];if(!n){Array.isArray(r)||(r=[r]);for(var i=400,o="normal",a=[],s,l,u=0,c=r.length;u<c;++u){var d=r[u],p=d.split(" "),h=p[p.length-1].toLowerCase();h=="normal"||h=="italic"||h=="oblique"?(o=l?o:h,l=!0,p.pop(),h=p[p.length-1].toLowerCase()):Bn.test(h)&&(h=h.replace(Bn,""),o=l?o:p[p.length-1].replace(h,""),l=!0);for(var f in Un){var x=p.length>1?p[p.length-2].toLowerCase():"";if(h==f||h==f.replace("-","")||x+"-"+h==f){i=s?i:Un[f],p.pop(),x&&f.startsWith(x)&&p.pop();break}}!s&&typeof h=="number"&&(i=h,s=!0);var m=p.join(at).replace("Klokantech Noto Sans","Noto Sans");m.indexOf(at)!==-1&&(m='"'+m+'"'),a.push(m)}n=Zn[r]=[o,i,a]}return n[0]+at+n[1]+at+e+"px"+(t?"/"+t:"")+at+n[2]},Rr=pi(hl);const Gi="https://api.mapbox.com";function pn(r){const e="mapbox://";return r.indexOf(e)!==0?"":r.slice(e.length)}function ml(r,e,t){const n=pn(r);if(!n)return decodeURI(new URL(r,t).href);const i="sprites/";if(n.indexOf(i)!==0)throw new Error(`unexpected sprites url: ${r}`);const o=n.slice(i.length);return`${Gi}/styles/v1/${o}/sprite?access_token=${e}`}function Vi(r,e){const t=pn(r);if(!t)return decodeURI(new URL(r,location.href).href);const n="styles/";if(t.indexOf(n)!==0)throw new Error(`unexpected style url: ${r}`);const i=t.slice(n.length);return`${Gi}/styles/v1/${i}?&access_token=${e}`}function Rt(r,e,t,n){const i=new URL(r,n),o=pn(r);if(!o)return e&&(i.searchParams.has(t)||i.searchParams.set(t,e)),decodeURI(i.href);if(o==="mapbox.satellite"){const a=window.devicePixelRatio>=1.5?"@2x":"";return`https://api.mapbox.com/v4/${o}/{z}/{x}/{y}${a}.webp?access_token=${e}`}return`https://{a-d}.tiles.mapbox.com/v4/${o}/{z}/{x}/{y}.vector.pbf?access_token=${e}`}const Hn={},Xn={};let yl=0;function dn(r){return r.id||(r.id=yl++),r.id}function gl(r,e){return dn(r)+"."+ye(e)}function xl(r){let e=Hn[r.id];return e||(e={},Hn[dn(r)]=e),e}function bl(r){let e=Xn[r.id];return e||(e={},Xn[dn(r)]=e),e}function gr(r){return r*Math.PI/180}const Kt=function(){const r=[];for(let e=78271.51696402048;r.length<=24;e/=2)r.push(e);return r}();function Jt(r,e){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof OffscreenCanvas<"u")return new OffscreenCanvas(r,e);const t=document.createElement("canvas");return t.width=r,t.height=e,t}function Ni(r,e){let t=0;const n=e.length;for(;t<n;++t)if(e[t]<r&&t+1<n){const o=e[t]/e[t+1];return t+Math.log(e[t]/r)/Math.log(o)}return n-1}function vl(r,e){const t=Math.floor(r),n=Math.pow(2,r-t);return e[t]/n}const $e={};function We(r,e,t={},n){if(e in $e)return n&&(n.request=$e[e][0]),$e[e][1];const i=t.transformRequest&&t.transformRequest(e,r)||e,o=Mt(()=>i).then(a=>(a instanceof Request||(a=new Request(a)),a.headers.get("Accept")||a.headers.set("Accept","application/json"),n&&(n.request=a),fetch(a).then(function(s){return delete $e[e],s.ok?s.json():Promise.reject(new Error("Error fetching source "+e))}).catch(function(s){return delete $e[e],Promise.reject(new Error("Error fetching source "+e))})));return $e[e]=[i,o],o}function Ui(r,e){if(typeof r=="string")if(r.trim().startsWith("{"))try{const t=JSON.parse(r);return Promise.resolve(t)}catch(t){return Promise.reject(t)}else return r=Vi(r,e.accessToken),We("Style",r,e);else return Promise.resolve(r)}const Wn={};function wl(r,e,t={}){const n=[e,JSON.stringify(r)].toString();let i=Wn[n];if(!i||t.transformRequest){let o;t.transformRequest&&(o=(s,l)=>{const u=t.transformRequest&&t.transformRequest(l,"Tiles")||l;if(s instanceof ui)s.setLoader((c,d,p)=>{Mt(()=>u).then(h=>{fetch(h).then(f=>f.arrayBuffer()).then(f=>{const m=s.getFormat().readFeatures(f,{extent:c,featureProjection:p});s.setFeatures(m)}).catch(f=>s.setState(q.ERROR))})});else{const c=s.getImage();Mt(()=>u).then(d=>{d instanceof Request?fetch(d).then(p=>p.blob()).then(p=>{const h=URL.createObjectURL(p);c.addEventListener("load",()=>URL.revokeObjectURL(h)),c.addEventListener("error",()=>URL.revokeObjectURL(h)),c.src=h}).catch(p=>s.setState(q.ERROR)):c.src=d})}});const a=r.url;if(a&&!r.tiles){const s=Rt(a,t.accessToken,t.accessTokenParam||"access_token",e||location.href);if(a.startsWith("mapbox://"))i=Promise.resolve({tileJson:Object.assign({},r,{url:void 0,tiles:Vo(s)}),tileLoadFunction:o});else{const l={};i=We("Source",s,t,l).then(function(u){return u.tiles=u.tiles.map(function(c){return u.scheme==="tms"&&(c=c.replace("{y}","{-y}")),Rt(c,t.accessToken,t.accessTokenParam||"access_token",l.request.url)}),Promise.resolve({tileJson:u,tileLoadFunction:o})})}}else r=Object.assign({},r,{tiles:r.tiles.map(function(s){return r.scheme==="tms"&&(s=s.replace("{y}","{-y}")),Rt(s,t.accessToken,t.accessTokenParam||"access_token",e||location.href)})}),i=Promise.resolve({tileJson:Object.assign({},r),tileLoadFunction:o});Wn[n]=i}return i}function Kn(r,e,t,n){const i=[2*t*e.pixelRatio+e.width,2*t*e.pixelRatio+e.height],o=Jt(i[0],i[1]),a=o.getContext("2d");a.drawImage(r,e.x,e.y,e.width,e.height,t*e.pixelRatio,t*e.pixelRatio,e.width,e.height);const s=a.getImageData(0,0,i[0],i[1]);a.globalCompositeOperation="destination-over",a.fillStyle=`rgba(${n.r*255},${n.g*255},${n.b*255},${n.a})`;const l=s.data;for(let u=0,c=s.width;u<c;++u)for(let d=0,p=s.height;d<p;++d){const h=(d*c+u)*4;l[h+3]>0&&a.arc(u,d,t*e.pixelRatio,0,2*Math.PI)}return a.fill(),o}function Tl(r,e,t){const n=Math.max(0,Math.min(1,(t-r)/(e-r)));return n*n*(3-2*n)}function Jn(r,e,t){const n=Jt(e.width,e.height),i=n.getContext("2d");i.drawImage(r,e.x,e.y,e.width,e.height,0,0,e.width,e.height);const o=i.getImageData(0,0,e.width,e.height),a=o.data;for(let s=0,l=o.width;s<l;++s)for(let u=0,c=o.height;u<c;++u){const d=(u*l+s)*4,p=a[d+3]/255,h=.75,f=.1,x=Tl(h-f,h+f,p);x>0?(a[d+0]=Math.round(255*t.r*x),a[d+1]=Math.round(255*t.g*x),a[d+2]=Math.round(255*t.b*x),a[d+3]=Math.round(255*x)):a[d+3]=0}return i.putImageData(o,0,0),n}const kl=Array(256).join(" ");function Mr(r,e){if(e>=.05){let t="";const n=r.split(`
`),i=kl.slice(0,Math.round(e/.1));for(let o=0,a=n.length;o<a;++o)o>0&&(t+=`
`),t+=n[o].split("").join(i);return t}return r}let xr;function Bi(){return xr||(xr=Jt(1,1).getContext("2d")),xr}function Pe(r,e){return Bi().measureText(r).width+(r.length-1)*e}const Yn={};function Ar(r,e,t,n){if(r.indexOf(`
`)!==-1){const a=r.split(`
`),s=[];for(let l=0,u=a.length;l<u;++l)s.push(Ar(a[l],e,t,n));return s.join(`
`)}const i=t+","+e+","+r+","+n;let o=Yn[i];if(!o){const a=r.split(" ");if(a.length>1){const s=Bi();s.font=e;const u=s.measureText("M").width*t;let c="";const d=[];for(let p=0,h=a.length;p<h;++p){const f=a[p],x=c+(c?" ":"")+f;Pe(x,n)<=u?c=x:(c&&d.push(c),c=f)}c&&d.push(c);for(let p=0,h=d.length;p<h&&h>1;++p){const f=d[p];if(Pe(f,n)<u*.35){const x=p>0?Pe(d[p-1],n):1/0,m=p<h-1?Pe(d[p+1],n):1/0;d.splice(p,1),h-=1,x<m?(d[p-1]+=" "+f,p-=1):d[p]=f+" "+d[p]}}for(let p=0,h=d.length-1;p<h;++p){const f=d[p],x=d[p+1];if(Pe(f,n)>u*.7&&Pe(x,n)<u*.6){const m=f.split(" "),D=m.pop();Pe(D,n)<u*.2&&(d[p]=m.join(" "),d[p+1]=D+" "+x),h-=1}}o=d.join(`
`)}else o=r;o=Mr(o,n),Yn[i]=o}return o}const zl=/font-family: ?([^;]*);/,Sl=/("|')/g;let It;function Fl(r){if(!It){It={};const e=document.styleSheets;for(let t=0,n=e.length;t<n;++t){const i=e[t];try{const o=i.rules||i.cssRules;if(o)for(let a=0,s=o.length;a<s;++a){const l=o[a];if(l.type==5){const u=l.cssText.match(zl);It[u[1].replace(Sl,"")]=!0}}}catch{}}}return r in It}const br={};function El(r,e="https://cdn.jsdelivr.net/npm/@fontsource/{font-family}/{fontweight}{-fontstyle}.css"){const t=r.toString();if(t in br)return br[t];const n=[];for(let i=0,o=r.length;i<o;++i){r[i]=r[i].replace("Arial Unicode MS","Arial");const a=r[i],s=Rr(a,1);$o(s);const l=s.split(" ");n.push([l.slice(3).join(" ").replace(/"/g,""),l[1],l[0]])}for(let i=0,o=n.length;i<o;++i){const a=n[i],s=a[0];if(!Fl(s)&&Oo.get(`${a[2]}
${a[1]} 
${s}`)!==100){const l=e.replace("{font-family}",s.replace(/ /g,"-").toLowerCase()).replace("{Font+Family}",s.replace(/ /g,"+")).replace("{fontweight}",a[1]).replace("{-fontstyle}",a[2].replace("normal","").replace(/(.+)/,"-$1")).replace("{fontstyle}",a[2]);if(!document.querySelector('link[href="'+l+'"]')){const u=document.createElement("link");u.href=l,u.rel="stylesheet",document.head.appendChild(u)}}}return br[t]=r,r}const Cl={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},Il={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},_l=function(r,e){const t=el(r,e);if(t.result==="error")throw new Error(t.value.map(n=>`${n.key}: ${n.message}`).join(", "));return t.value},Dr={},Vt={zoom:0};let _t,vr;function S(r,e,t,n,i,o,a){const s=r.id;o||(o={},console.warn("No functionCache provided to getValue()")),o[s]||(o[s]={});const l=o[s];if(!l[t]){let u=(r[e]||Dr)[t];const c=ji[`${e}_${r.type}`][t];u===void 0&&(u=c.default);let d=Qs(u);if(!d&&Di(u)&&(u=La(u,c),d=!0),d){const p=_l(u,c);l[t]=p.evaluate.bind(p)}else c.type=="color"&&(u=ue.parse(u)),l[t]=function(){return u}}return Vt.zoom=n,l[t](Vt,i,a)}function Qn(r,e,t,n,i){return S(r,"layout",`${n}-allow-overlap`,e,t,i)?S(r,"layout",`${n}-ignore-placement`,e,t,i)?"none":"obstacle":"declutter"}function Pl(r,e,t,n,i){return i||console.warn("No filterCache provided to evaluateFilter()"),r in i||(i[r]=il(e).filter),Vt.zoom=n,i[r](Vt,t)}function Fe(r,e){if(r){if(r.a===0||e===0)return;const t=r.a;return e=e===void 0?1:e,t===0?"transparent":"rgba("+Math.round(r.r*255/t)+","+Math.round(r.g*255/t)+","+Math.round(r.b*255/t)+","+t*e+")"}return r}const Rl=/\{[^{}}]*\}/g;function wr(r,e){return r.replace(Rl,function(t){return e[t.slice(1,-1)]||""})}const Ml={};function Al(r,e,t,n=Kt,i=void 0,o=void 0,a=void 0,s=void 0){if(typeof e=="string"&&(e=JSON.parse(e)),e.version!=8)throw new Error("glStyle version 8 required.");Ml[gl(e,r)]=Array.from(arguments);let l,u,c;if(o){if(typeof Image<"u"){const T=new Image;let F;Mt(()=>o).then(L=>{L instanceof Request?fetch(L).then(Y=>Y.blob()).then(Y=>{F=URL.createObjectURL(Y),T.src=F}).catch(()=>{}):(T.crossOrigin="anonymous",T.src=L,F&&URL.revokeObjectURL(F))}),T.onload=function(){l=T,u=[T.width,T.height],r.changed(),T.onload=null}}else if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){const T=self;T.postMessage({action:"loadImage",src:o}),T.addEventListener("message",function(L){L.data.action==="imageLoaded"&&L.data.src===o&&(l=L.data.image,u=[l.width,l.height])})}}const d=fl(e.layers),p={},h=[],f={},x={},m=xl(e),D=bl(e);let I;for(let T=0,F=d.length;T<F;++T){const L=d[T],Y=L.id;if(typeof t=="string"&&L.source==t||Array.isArray(t)&&t.indexOf(Y)!==-1){const G=L["source-layer"];if(I){if(L.source!==I)throw new Error(`Layer "${Y}" does not use source "${I}`)}else{I=L.source;const J=e.sources[I];if(!J)throw new Error(`Source "${I}" is not defined`);const b=J.type;if(b!=="vector"&&b!=="geojson")throw new Error(`Source "${I}" is not of type "vector" or "geojson", but "${b}"`)}let g=p[G];g||(g=[],p[G]=g),g.push({layer:L,index:T}),h.push(Y)}}const E=new st,C=new Ge,z=[],A=function(T,F,L){const Y=T.getProperties(),G=p[Y.layer];if(!G)return;let g=n.indexOf(F);g==-1&&(g=Ni(F,n));const J=Cl[T.getGeometry().getType()],b={id:T.getId(),properties:Y,type:J},k=r.get("mapbox-featurestate")[T.getId()];let M=-1;for(let ge=0,gt=G.length;ge<gt;++ge){const xt=G[ge],v=xt.layer,fn=v.id;if(L!==void 0&&L!==fn)continue;const bt=v.layout||Dr,Ae=v.paint||Dr;if(bt.visibility==="none"||"minzoom"in v&&g<v.minzoom||"maxzoom"in v&&g>=v.maxzoom)continue;const hn=v.filter;if(!hn||Pl(fn,hn,b,g,D)){let ce,we,vt,xe,Te,w;const De=xt.index;if(J==3&&(v.type=="fill"||v.type=="fill-extrusion"))if(we=S(v,"paint",v.type+"-opacity",g,b,m,k),v.type+"-pattern"in Ae){const U=S(v,"paint",v.type+"-pattern",g,b,m,k);if(U){const B=typeof U=="string"?wr(U,Y):U.toString();if(l&&i&&i[B]){++M,w=z[M],(!w||!w.getFill()||w.getStroke()||w.getText())&&(w=new Ee({fill:new Ge}),z[M]=w),vt=w.getFill(),w.setZIndex(De);const V=B+"."+we;let Z=x[V];if(!Z){const j=i[B],$=Jt(j.width,j.height),X=$.getContext("2d");X.globalAlpha=we,X.drawImage(l,j.x,j.y,j.width,j.height,0,0,j.width,j.height),Z=X.createPattern($,"repeat"),x[V]=Z}vt.setColor(Z)}}}else ce=Fe(S(v,"paint",v.type+"-color",g,b,m,k),we),v.type+"-outline-color"in Ae&&(Te=Fe(S(v,"paint",v.type+"-outline-color",g,b,m,k),we)),Te||(Te=ce),(ce||Te)&&(++M,w=z[M],(!w||ce&&!w.getFill()||!ce&&w.getFill()||Te&&!w.getStroke()||!Te&&w.getStroke()||w.getText())&&(w=new Ee({fill:ce?new Ge:void 0,stroke:Te?new st:void 0}),z[M]=w),ce&&(vt=w.getFill(),vt.setColor(ce)),Te&&(xe=w.getStroke(),xe.setColor(Te),xe.setWidth(.5)),w.setZIndex(De));if(J!=1&&v.type=="line"){"line-pattern"in Ae?ce=void 0:ce=Fe(S(v,"paint","line-color",g,b,m,k),S(v,"paint","line-opacity",g,b,m,k));const U=S(v,"paint","line-width",g,b,m,k);ce&&U>0&&(++M,w=z[M],(!w||!w.getStroke()||w.getFill()||w.getText())&&(w=new Ee({stroke:new st}),z[M]=w),xe=w.getStroke(),xe.setLineCap(S(v,"layout","line-cap",g,b,m,k)),xe.setLineJoin(S(v,"layout","line-join",g,b,m,k)),xe.setMiterLimit(S(v,"layout","line-miter-limit",g,b,m,k)),xe.setColor(ce),xe.setWidth(U),xe.setLineDash(Ae["line-dasharray"]?S(v,"paint","line-dasharray",g,b,m,k).map(function(B){return B*U}):null),w.setZIndex(De))}let wt=!1,O=null,mn=0,Qe,ne,Yt;if((J==1||J==2)&&"icon-image"in bt){const U=S(v,"layout","icon-image",g,b,m,k);if(U){Qe=typeof U=="string"?wr(U,Y):U.toString();let B;const V=s?s(r,Qe):void 0;if(l&&i&&i[Qe]||V){const Z=S(v,"layout","icon-rotation-alignment",g,b,m,k);if(J==2){const j=T.getGeometry();if(j.getFlatMidpoint||j.getFlatMidpoints){const $=j.getExtent();if(Math.sqrt(Math.max(Math.pow(($[2]-$[0])/F,2),Math.pow(($[3]-$[1])/F,2)))>150){const W=j.getType()==="MultiLineString"?j.getFlatMidpoints():j.getFlatMidpoint();if(vr||(_t=[NaN,NaN],vr=new kr("Point",_t,[],2,{},void 0)),B=vr,_t[0]=W[0],_t[1]=W[1],S(v,"layout","symbol-placement",g,b,m,k)==="line"&&Z==="map"){const se=j.getStride(),ie=j.getFlatCoordinates();for(let oe=0,H=ie.length-se;oe<H;oe+=se){const de=ie[oe],fe=ie[oe+1],he=ie[oe+se],re=ie[oe+se+1],nt=Math.min(de,he),Hi=Math.min(fe,re),Xi=Math.max(de,he),Wi=Math.max(fe,re);if(W[0]>=nt&&W[0]<=Xi&&W[1]>=Hi&&W[1]<=Wi){mn=Math.atan2(fe-re,he-de);break}}}}}}if(J!==2||B){const j=S(v,"layout","icon-size",g,b,m,k),$=Ae["icon-color"]!==void 0?S(v,"paint","icon-color",g,b,m,k):null;if(!$||$.a!==0){const X=S(v,"paint","icon-halo-color",g,b,m,k),W=S(v,"paint","icon-halo-width",g,b,m,k);let pe=`${Qe}.${j}.${W}.${X}`;if($!==null&&(pe+=`.${$}`),ne=f[pe],!ne){const se=Qn(v,g,b,"icon",m);let ie;"icon-offset"in bt&&(ie=S(v,"layout","icon-offset",g,b,m,k).slice(0),ie[0]*=j,ie[1]*=-j);let oe=$?[$.r*255,$.g*255,$.b*255,$.a]:void 0;if(V){const H={color:oe,rotateWithView:Z==="map",displacement:ie,declutterMode:se,scale:j};typeof V=="string"?H.src=V:(H.img=V,H.imgSize=[V.width,V.height]),ne=new vn(H)}else{const H=i[Qe];let de,fe,he;W?H.sdf?(de=Kn(Jn(l,H,$||[0,0,0,1]),{x:0,y:0,width:H.width,height:H.height,pixelRatio:H.pixelRatio},W,X),oe=void 0):de=Kn(l,H,W,X):(H.sdf?(c||(c=Jn(l,{x:0,y:0,width:u[0],height:u[1]},{r:1,g:1,b:1,a:1})),de=c):de=l,fe=[H.width,H.height],he=[H.x,H.y]),ne=new vn({color:oe,img:de,imgSize:u,size:fe,offset:he,rotateWithView:Z==="map",scale:j/H.pixelRatio,displacement:ie,declutterMode:se})}f[pe]=ne}}ne&&(++M,w=z[M],(!w||!w.getImage()||w.getFill()||w.getStroke())&&(w=new Ee,z[M]=w),w.setGeometry(B),ne.setRotation(mn+gr(S(v,"layout","icon-rotate",g,b,m,k))),ne.setOpacity(S(v,"paint","icon-opacity",g,b,m,k)),ne.setAnchor(Il[S(v,"layout","icon-anchor",g,b,m,k)]),w.setImage(ne),O=w.getText(),w.setText(void 0),w.setZIndex(De),wt=!0,Yt=!1)}else Yt=!0}}}if(J==1&&v.type==="circle"){++M,w=z[M],(!w||!w.getImage()||w.getFill()||w.getStroke())&&(w=new Ee,z[M]=w);const U="circle-radius"in Ae?S(v,"paint","circle-radius",g,b,m,k):5,B=Fe(S(v,"paint","circle-stroke-color",g,b,m,k),S(v,"paint","circle-stroke-opacity",g,b,m,k)),V=S(v,"paint","circle-translate",g,b,m,k),Z=Fe(S(v,"paint","circle-color",g,b,m,k),S(v,"paint","circle-opacity",g,b,m,k)),j=S(v,"paint","circle-stroke-width",g,b,m,k),$=U+"."+B+"."+Z+"."+j+"."+V[0]+"."+V[1];ne=f[$],ne||(ne=new li({radius:U,displacement:[V[0],-V[1]],stroke:B&&j>0?new st({width:j,color:B}):void 0,fill:Z?new Ge({color:Z}):void 0,declutterMode:"none"}),f[$]=ne),w.setImage(ne),O=w.getText(),w.setText(void 0),w.setGeometry(void 0),w.setZIndex(De),wt=!0}let ee,et,tt,Se,rt,Qt;if("text-field"in bt){Se=Math.round(S(v,"layout","text-size",g,b,m,k));const U=S(v,"layout","text-font",g,b,m,k);tt=S(v,"layout","text-line-height",g,b,m,k),et=Rr(a?a(U,e.metadata?e.metadata["ol:webfonts"]:void 0):U,Se,tt),et.includes("sans-serif")||(et+=",sans-serif"),rt=S(v,"layout","text-letter-spacing",g,b,m,k),Qt=S(v,"layout","text-max-width",g,b,m,k);const B=S(v,"layout","text-field",g,b,m,k);typeof B=="object"&&B.sections?B.sections.length===1?ee=B.toString():ee=B.sections.reduce((V,Z,j)=>{const $=Z.fontStack?Z.fontStack.split(","):U,X=Rr(a?a($):$,Se*(Z.scale||1),tt);let W=Z.text;if(W===`
`)return V.push(`
`,""),V;if(J==2){V.push(Mr(W,rt),X);return}W=Ar(W,X,Qt,rt).split(`
`);for(let pe=0,se=W.length;pe<se;++pe)pe>0&&V.push(`
`,""),V.push(W[pe],X);return V},[]):ee=wr(B,Y).trim(),we=S(v,"paint","text-opacity",g,b,m,k)}if(ee&&we&&!Yt){wt||(++M,w=z[M],(!w||!w.getText()||w.getFill()||w.getStroke())&&(w=new Ee,z[M]=w),w.setImage(void 0),w.setGeometry(void 0));const U=Qn(v,g,b,"text",m);w.getText()||w.setText(O),O=w.getText(),(!O||"getDeclutterMode"in O&&O.getDeclutterMode()!==U)&&(O=new No({padding:[2,2,2,2],declutterMode:U}),w.setText(O));const B=S(v,"layout","text-transform",g,b,m,k);B=="uppercase"?ee=Array.isArray(ee)?ee.map((re,nt)=>nt%2?re:re.toUpperCase()):ee.toUpperCase():B=="lowercase"&&(ee=Array.isArray(ee)?ee.map((re,nt)=>nt%2?re:re.toLowerCase()):ee.toLowerCase());const V=Array.isArray(ee)?ee:J==2?Mr(ee,rt):Ar(ee,et,Qt,rt);O.setText(V),O.setFont(et),O.setRotation(gr(S(v,"layout","text-rotate",g,b,m,k)));const Z=S(v,"layout","text-anchor",g,b,m,k),j=wt||J==1?"point":S(v,"layout","symbol-placement",g,b,m,k);let $;if(j==="line-center"?(O.setPlacement("line"),$="center"):O.setPlacement(j),j==="line"&&typeof O.setRepeat=="function"){const re=S(v,"layout","symbol-spacing",g,b,m,k);O.setRepeat(re*2)}O.setOverflow(j==="point");let X=S(v,"paint","text-halo-width",g,b,m,k);const W=S(v,"layout","text-offset",g,b,m,k),pe=S(v,"paint","text-translate",g,b,m,k);let se=0,ie=0;if(j=="point"){$="center",Z.indexOf("left")!==-1?($="left",ie=X):Z.indexOf("right")!==-1&&($="right",ie=-X);const re=S(v,"layout","text-rotation-alignment",g,b,m,k);O.setRotateWithView(re=="map")}else O.setMaxAngle(gr(S(v,"layout","text-max-angle",g,b,m,k))*ee.length/V.length),O.setRotateWithView(!1);O.setTextAlign($);let oe="middle";Z.indexOf("bottom")==0?(oe="bottom",se=-X-.5*(tt-1)*Se):Z.indexOf("top")==0&&(oe="top",se=X+.5*(tt-1)*Se),O.setTextBaseline(oe);const H=S(v,"layout","text-justify",g,b,m,k);O.setJustify(H==="auto"?void 0:H),O.setOffsetX(W[0]*Se+ie+pe[0]),O.setOffsetY(W[1]*Se+se+pe[1]),C.setColor(Fe(S(v,"paint","text-color",g,b,m,k),we)),O.setFill(C);const de=Fe(S(v,"paint","text-halo-color",g,b,m,k),we);if(de&&X>0){E.setColor(de),X*=2;const re=.5*Se;E.setWidth(X<=re?X:re),O.setStroke(E)}else O.setStroke(void 0);const fe=S(v,"layout","text-padding",g,b,m,k),he=O.getPadding();fe!==he[0]&&(he[0]=fe,he[1]=fe,he[2]=fe,he[3]=fe),w.setZIndex(De)}}}if(M>-1)return z.length=M+1,z};return r.setStyle(A),r.set("mapbox-source",I),r.set("mapbox-layers",h),r.set("mapbox-featurestate",r.get("mapbox-featurestate")||{}),A}function Dl(r,e=512){return r.getExtent()?jr({extent:r.getExtent(),tileSize:e,maxZoom:22}).getResolutions():Kt}function jl(r,e){return e.accessToken||(e=Object.assign({},e),new URL(r).searchParams.forEach((n,i)=>{e.accessToken=n,e.accessTokenParam=i})),e}function Ll(r,e,t="",n={},i=void 0){let o,a,s,l,u=!0;return typeof t!="string"&&!Array.isArray(t)?(s=t,l=s.source||s.layers,n=s):l=t,typeof n=="string"?(o=n,s={}):(o=n.styleUrl,s=n),s.updateSource===!1&&(u=!1),i||(i=s.resolutions),!o&&typeof e=="string"&&!e.trim().startsWith("{")&&(o=e),o&&(o=o.startsWith("data:")?location.href:Vi(o,s.accessToken),s=jl(o,s)),new Promise(function(c,d){Ui(e,s).then(function(p){if(p.version!=8)return d(new Error("glStyle version 8 required."));if(!(r instanceof zr||r instanceof ut))return d(new Error("Can only apply to VectorLayer or VectorTileLayer"));const h=r instanceof ut?"vector":"geojson";if(l?Array.isArray(l)?a=p.layers.find(function(C){return C.id===l[0]}).source:a=l:(a=Object.keys(p.sources).find(function(C){return p.sources[C].type===h}),l=a),!a)return d(new Error(`No ${h} source found in the glStyle.`));function f(){if(!u)return Promise.resolve();if(r instanceof ut)return Nl(p.sources[a],o,s).then(function(T){const F=r.getSource();F?T!==F&&(F.setTileUrlFunction(T.getTileUrlFunction()),typeof F.setUrls=="function"&&typeof T.getUrls=="function"&&F.setUrls(T.getUrls()),F.format_||(F.format_=T.format_),F.getAttributions()||F.setAttributions(T.getAttributions()),F.getTileLoadFunction()===ci&&F.setTileLoadFunction(T.getTileLoadFunction()),qo(F.getProjection(),T.getProjection())&&(F.tileGrid=T.getTileGrid())):r.setSource(T);const L=r.getSource().getTileGrid();!isFinite(r.getMaxResolution())&&!isFinite(r.getMinZoom())&&L.getMinZoom()>0&&r.setMaxResolution(vl(Math.max(0,L.getMinZoom()-1e-12),L.getResolutions()))});const C=p.sources[a];let z=r.getSource();(!z||z.get("mapbox-source")!==C)&&(z=Bl(C,o,s));const A=r.getSource();return A?z!==A&&(A.getAttributions()||A.setAttributions(z.getAttributions()),A.format_||(A.format_=z.getFormat()),A.url_=z.getUrl()):r.setSource(z),Promise.resolve()}let x,m,D,I;function E(){if(!I&&(!p.sprite||m)){if(s.projection&&!i){const z=Xe(s.projection).getUnits();z!=="m"&&(i=Kt.map(A=>A/Ao[z]))}I=Al(r,p,l,i,m,D,(C,z=s.webfonts)=>El(C,z),s.getImage),r.getStyle()?f().then(c).catch(d):d(new Error(`Nothing to show for source [${a}]`))}else I?(r.setStyle(I),f().then(c).catch(d)):d(new Error("Something went wrong trying to apply style."))}if(p.sprite){const C=new URL(ml(p.sprite,s.accessToken,o||location.href));x=window.devicePixelRatio>=1.5?.5:1;const z=x==.5?"@2x":"";let A=C.origin+C.pathname+z+".json"+C.search;new Promise(function(T,F){We("Sprite",A,s).then(T).catch(function(L){A=C.origin+C.pathname+".json"+C.search,We("Sprite",A,s).then(T).catch(F)})}).then(function(T){if(T===void 0&&d(new Error("No sprites found.")),m=T,D=C.origin+C.pathname+z+".png"+C.search,s.transformRequest){const F=s.transformRequest(D,"SpriteImage")||D;(F instanceof Request||F instanceof Promise)&&(D=F)}E()}).catch(function(T){d(new Error(`Sprites cannot be loaded: ${A}: ${T.message}`))})}else E()}).catch(d)})}const ei={};function $l(r,e,t){e.layers.some(function(n){if(n.type==="background"){if(r instanceof si)return r.setBackground(function(i){return Zi(n,i,t,{})}),!0;if(r instanceof Do||r instanceof jo)return r.getLayers().insertAt(0,Vl(n,t,{})),!0}})}function Ol(r,e,t={}){return Ui(e,t).then(function(n){$l(r,n,t)})}function ql(r,e){const t=r.bounds;if(t){const n=wn([t[0],t[1]],e),i=wn([t[2],t[3]],e);return[n[0],n[1],i[0],i[1]]}return Xe(e).getExtent()}function Gl(r,e,t){const n=new da({tileJSON:e,tileSize:r.tileSize||e.tileSize||512}),i=n.getTileJSON(),o=n.getTileGrid(),a=Xe(t.projection||"EPSG:3857"),s=ql(i,a),l=a.getExtent(),u=i.minzoom||0,c=i.maxzoom||22,d={attributions:n.getAttributions(),projection:a,tileGrid:new ai({origin:l?ni(l):o.getOrigin(0),extent:s||o.getExtent(),minZoom:u,resolutions:Dl(a,e.tileSize).slice(0,c+1),tileSize:o.getTileSize(0)})};return Array.isArray(i.tiles)?d.urls=i.tiles:d.url=i.tiles,d}function Zi(r,e,t,n){const i={id:r.id,type:r.type},o=r.layout||{},a=r.paint||{};i.paint=a;const s=Ni(e,t.resolutions||Kt);let l;const u=S(i,"paint","background-color",s,ei,n);return a["background-opacity"]!==void 0&&(l=S(i,"paint","background-opacity",s,ei,n)),o.visibility=="none"?void 0:Fe(u,l)}function Vl(r,e,t){const n=document.createElement("div");return n.className="ol-mapbox-style-background",n.style.position="absolute",n.style.width="100%",n.style.height="100%",new si({source:new Lo({}),render(i){const o=Zi(r,i.viewState.resolution,e,t);return n.style.backgroundColor=o,n}})}function Nl(r,e,t){return new Promise(function(n,i){wl(r,e,t).then(function({tileJson:o,tileLoadFunction:a}){const s=Gl(r,o,t);s.tileLoadFunction=a,s.format=new $r,n(new Lr(s))}).catch(i)})}function Ul(r){return`{bbox-${(r?r.getCode():"EPSG:3857").toLowerCase().replace(/[^a-z0-9]/g,"-")}}`}function Bl(r,e,t){const n=t.projection?new zn({dataProjection:t.projection}):new zn,i=r.data,o={};if(typeof i=="string"){const s=Rt(i,t.accessToken,t.accessTokenParam||"access_token",e||location.href);if(/\{bbox-[0-9a-z-]+\}/.test(s)){const u=(d,p,h)=>{const f=Ul(h);return s.replace(f,`${d.join(",")}`)},c=new rr({attributions:r.attribution,format:n,loader:(d,p,h,f,x)=>{const m=typeof u=="function"?u(d,p,h):u;We("GeoJSON",m,t).then(D=>{const I=c.getFormat().readFeatures(D,{featureProjection:h});c.addFeatures(I),f(I)}).catch(D=>{c.removeLoadedExtent(d),x()})},strategy:Go});return c.set("mapbox-source",r),c}const l=new rr({attributions:r.attribution,format:n,url:s,loader:(u,c,d,p,h)=>{We("GeoJSON",s,t).then(f=>{const x=l.getFormat().readFeatures(f,{featureProjection:d});l.addFeatures(x),p(x)}).catch(f=>{l.removeLoadedExtent(u),h()})}});return l}o.features=n.readFeatures(i,{featureProjection:"EPSG:3857"});const a=new rr(Object.assign({attributions:r.attribution,format:n},o));return a.set("mapbox-source",r),a}class Zl extends Mo{constructor(e){super(Tr.ERROR),this.error=e}}class Hl extends ut{constructor(e){const t="declutter"in e?e.declutter:!0,n=new Lr({state:"loading",format:new $r});super({source:n,background:e.background===!1?null:e.background,declutter:t,className:e.className,opacity:e.opacity,visible:e.visible,zIndex:e.zIndex,minResolution:e.minResolution,maxResolution:e.maxResolution,minZoom:e.minZoom,maxZoom:e.maxZoom,renderOrder:e.renderOrder,renderBuffer:e.renderBuffer,renderMode:e.renderMode,map:e.map,updateWhileAnimating:e.updateWhileAnimating,updateWhileInteracting:e.updateWhileInteracting,preload:e.preload,useInterimTilesOnError:e.useInterimTilesOnError,properties:e.properties}),e.accessToken&&(this.accessToken=e.accessToken);const i=e.styleUrl,o=[Ll(this,i,e.layers||e.source,{accessToken:this.accessToken})];this.getBackground()===void 0&&o.push(Ol(this,e.styleUrl,{accessToken:this.accessToken})),Promise.all(o).then(()=>{n.setState("ready")}).catch(a=>{this.dispatchEvent(new Zl(a)),this.getSource().setState("error")})}}const qe="main";class Xl{mapId=qe;vectorSourceFactory;constructor({references:e}){this.vectorSourceFactory=e.vectorSourceFactory}async getMapConfig(){return{projection:"EPSG:3857",initialView:{kind:"position",center:{x:848890,y:6793350},zoom:13},layers:[new it({title:"OSM",visible:!0,isBaseLayer:!0,olLayer:new Uo({source:new Bo})}),new it({id:"inspire-us-kindergarten",title:"Kindertageseinrichtungen in NRW",visible:!0,olLayer:new zr({style:new Ee({image:new li({fill:new Ge({color:"blue"}),radius:5})}),source:this.vectorSourceFactory.createVectorSource({baseUrl:"https://ogc-api.nrw.de/inspire-us-kindergarten/v1",collectionId:"governmentalservice",crs:"http://www.opengis.net/def/crs/EPSG/0/3857",attributions:"<a href='https://www.govdata.de/dl-de/by-2-0'>Datenlizenz Deutschland - Namensnennung - Version 2.0</a>"})})}),new it({id:"ogc_katasterbezirk",title:"Liegenschaftskatasterbezirke in NRW (viele Daten)",visible:!1,olLayer:new zr({source:this.vectorSourceFactory.createVectorSource({baseUrl:"https://ogc-api.nrw.de/lika/v1",collectionId:"katasterbezirk",limit:1e3,crs:"http://www.opengis.net/def/crs/EPSG/0/3857",attributions:"<a href='https://www.govdata.de/dl-de/by-2-0'>Datenlizenz Deutschland - Namensnennung - Version 2.0</a>"})})}),new it({title:"Abschnitte / Äste mit Unfällen (Mapbox Style)",visible:!1,olLayer:new Hl({styleUrl:"https://demo.ldproxy.net/strassen/styles/default?f=mbs"})}),new it({title:"Pendleratlas",visible:!0,olLayer:new ut({source:new Lr({url:"https://pendleratlas.statistikportal.de/_vector_tiles/2022/vg250/{z}/{x}/{y}.pbf",format:new $r,projection:"EPSG:3857",attributions:`&copy; Statistische Ämter der Länder ${new Date().getFullYear()} | GeoBasis-DE/BKG ${new Date().getFullYear()}`}),style:new Ee({fill:new Ge({color:"rgba(173, 209, 158, 0.6)"}),stroke:new st({color:"#2d7d9f",width:3})})})})]}}}class Wl{beforeRequest({target:e,options:t}){e.protocol==="https:"&&e.hostname==="ogc-api.nrw.de"&&t.headers.set("Authorization","Bearer 12345")}}const Kl={"ogc-api-app":{name:"ogc-api-app",services:{MapConfigProviderImpl:{name:"MapConfigProviderImpl",clazz:Xl,provides:[{name:"map.MapConfigProvider",qualifier:void 0}],references:{vectorSourceFactory:{name:"ogc-features.VectorSourceFactory",qualifier:void 0,all:!1}}},SampleTokenInterceptor:{name:"SampleTokenInterceptor",clazz:Wl,provides:[{name:"http.Interceptor",qualifier:void 0}],references:{}}},ui:{references:[]},properties:{}},"@open-pioneer/chakra-integration":{name:"@open-pioneer/chakra-integration",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime":{name:"@open-pioneer/runtime",services:{},ui:{references:[]},properties:{}},"@open-pioneer/react-utils":{name:"@open-pioneer/react-utils",services:{},ui:{references:[]},properties:{}},"@open-pioneer/http":{name:"@open-pioneer/http",services:{HttpServiceImpl:{name:"HttpServiceImpl",clazz:Zo,provides:[{name:"http.HttpService",qualifier:"http.HttpService"}],references:{interceptors:{name:"http.Interceptor",qualifier:void 0,all:!0}}}},ui:{references:[]},properties:{}},"@open-pioneer/map":{name:"@open-pioneer/map",services:{MapRegistryImpl:{name:"MapRegistryImpl",clazz:Ho,provides:[{name:"map.MapRegistry",qualifier:void 0}],references:{providers:{name:"map.MapConfigProvider",qualifier:void 0,all:!0},httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[{name:"map.MapRegistry",qualifier:void 0,all:!1}]},properties:{}},"@open-pioneer/theme":{name:"@open-pioneer/theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/ogc-features":{name:"@open-pioneer/ogc-features",services:{VectorSourceFactory:{name:"VectorSourceFactory",clazz:na,provides:[{name:"ogc-features.VectorSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}},SearchSourceFactory:{name:"SearchSourceFactory",clazz:ia,provides:[{name:"ogc-features.SearchSourceFactory",qualifier:void 0}],references:{httpService:{name:"http.HttpService",qualifier:void 0,all:!1}}}},ui:{references:[]},properties:{}},"@open-pioneer/basemap-switcher":{name:"@open-pioneer/basemap-switcher",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map-navigation":{name:"@open-pioneer/map-navigation",services:{},ui:{references:[]},properties:{}},"@open-pioneer/toc":{name:"@open-pioneer/toc",services:{},ui:{references:[]},properties:{}},"@open-pioneer/base-theme":{name:"@open-pioneer/base-theme",services:{},ui:{references:[]},properties:{}},"@open-pioneer/runtime-react-support":{name:"@open-pioneer/runtime-react-support",services:{},ui:{references:[]},properties:{}},"@open-pioneer/core":{name:"@open-pioneer/core",services:{},ui:{references:[]},properties:{}},"@open-pioneer/reactivity":{name:"@open-pioneer/reactivity",services:{},ui:{references:[]},properties:{}},"@open-pioneer/map-ui-components":{name:"@open-pioneer/map-ui-components",services:{},ui:{references:[]},properties:{}}},Jl=':root,:host{--ol-background-color: white;--ol-accent-background-color: #F5F5F5;--ol-subtle-background-color: rgba(128, 128, 128, .25);--ol-partial-background-color: rgba(255, 255, 255, .75);--ol-foreground-color: #333333;--ol-subtle-foreground-color: #666666;--ol-brand-color: #00AAFF}.ol-box{box-sizing:border-box;border-radius:2px;border:1.5px solid var(--ol-background-color);background-color:var(--ol-partial-background-color)}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:var(--ol-partial-background-color);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid var(--ol-subtle-foreground-color);border-top:none;color:var(--ol-foreground-color);font-size:10px;text-align:center;margin:1px;will-change:contents,width;transition:all .25s}.ol-scale-bar{position:absolute;bottom:8px;left:8px}.ol-scale-bar-inner{display:flex}.ol-scale-step-marker{width:1px;height:15px;background-color:var(--ol-foreground-color);float:right;z-index:10}.ol-scale-step-text{position:absolute;bottom:-5px;font-size:10px;z-index:11;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-text{position:absolute;font-size:12px;text-align:center;bottom:25px;color:var(--ol-foreground-color);text-shadow:-1.5px 0 var(--ol-partial-background-color),0 1.5px var(--ol-partial-background-color),1.5px 0 var(--ol-partial-background-color),0 -1.5px var(--ol-partial-background-color)}.ol-scale-singlebar{position:relative;height:10px;z-index:9;box-sizing:border-box;border:1px solid var(--ol-foreground-color)}.ol-scale-singlebar-even{background-color:var(--ol-subtle-foreground-color)}.ol-scale-singlebar-odd{background-color:var(--ol-background-color)}.ol-unsupported{display:none}.ol-viewport,.ol-unselectable{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.ol-viewport canvas{all:unset;overflow:hidden}.ol-viewport{touch-action:pan-x pan-y}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:-moz-grab;cursor:grab}.ol-control{position:absolute;background-color:var(--ol-subtle-background-color);border-radius:4px}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}.ol-control button{display:block;margin:1px;padding:0;color:var(--ol-subtle-foreground-color);font-weight:700;text-decoration:none;font-size:inherit;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:var(--ol-background-color);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:hover,.ol-control button:focus{text-decoration:none;outline:1px solid var(--ol-subtle-foreground-color);color:var(--ol-foreground-color)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em);display:flex;flex-flow:row-reverse;align-items:center}.ol-attribution a{color:var(--ol-subtle-foreground-color);text-decoration:none}.ol-attribution ul{margin:0;padding:1px .5em;color:var(--ol-foreground-color);text-shadow:0 0 2px var(--ol-background-color);font-size:12px}.ol-attribution li{display:inline;list-style:none}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button{flex-shrink:0}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:var(--ol-partial-background-color)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:block}.ol-overviewmap .ol-overviewmap-map{border:1px solid var(--ol-subtle-foreground-color);height:150px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:0;left:0;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:var(--ol-subtle-background-color)}.ol-overviewmap-box{border:1.5px dotted var(--ol-subtle-foreground-color)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}.ol-overviewmap .ol-viewport:hover{cursor:pointer}.map-container .ol-viewport .ol-attribution{bottom:var(--map-padding-bottom);right:var(--map-padding-right)}',Yl=["en","de"];function Ql(r){switch(r){case"en":return Sn(()=>import("./CQRU2o-rqIdt.js"),[],import.meta.url).then(e=>e.default);case"de":return Sn(()=>import("./XAsebEBvbSkT.js"),[],import.meta.url).then(e=>e.default)}throw new Error(`Unsupported locale: '${r}'`)}const eu=Ki(Jl),tu=Object.freeze(Object.defineProperty({__proto__:null,loadMessages:Ql,locales:Yl,packages:Kl,styles:eu},Symbol.toStringTag,{value:"Module"})),ru="ogc-api-app",nu=Xo.bind(void 0,ru);function iu(){const r=nu();return K.jsx(nr,{height:"100%",direction:"column",overflow:"hidden",children:K.jsx(Tn,{title:K.jsx(yn,{textAlign:"center",py:1,children:K.jsx(kn,{size:"md",children:"Open Pioneer - OGC API Features and OGC API Tiles Sample"})}),children:K.jsx(nr,{flex:"1",direction:"column",position:"relative",children:K.jsxs(Wo,{mapId:qe,children:[K.jsx(ir,{position:"top-left",horizontalGap:20,verticalGap:20,children:K.jsx(yn,{backgroundColor:"white",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",children:K.jsx(Tn,{title:K.jsx(kn,{size:"md",children:r.formatMessage({id:"tocTitle"})}),children:K.jsx(Yo,{mapId:qe,basemapSwitcherProps:{allowSelectingEmptyBasemap:!0}})})})}),K.jsx(ir,{position:"top-right",horizontalGap:10,verticalGap:10,children:K.jsxs(Ji,{backgroundColor:"whiteAlpha.900",borderWidth:"1px",borderRadius:"lg",padding:2,boxShadow:"lg",maxWidth:"400px",children:[K.jsx(or,{as:"b",children:"Description"}),K.jsx(or,{children:"This application can be used to test OGC API Features and OGC API Tiles."}),K.jsx(or,{children:"Vector Tiles cannot be reprojected and require the map to use the same projection. Currently all known MVT vector tile sets are using WebMercator, making them unusable in the Default Sample App which uses ETRS89/UTM zone 32N. This Sample App uses WebMercator."})]})}),K.jsx(ir,{position:"bottom-right",horizontalGap:10,verticalGap:30,children:K.jsxs(nr,{direction:"column",gap:1,padding:1,children:[K.jsx(oa,{mapId:qe}),K.jsx(aa,{mapId:qe}),K.jsx(sa,{mapId:qe})]})})]})})})})}const ou=Yi({component:iu,theme:Qi,appMetadata:tu,async resolveConfig(r){const e=r.getAttribute("forced-locale");if(e)return{locale:e}}});customElements.define("ogc-api-app",ou);const au=document.getElementsByTagName("body")[0];su();function su(){const r=window.location.search,t=new URLSearchParams(r).get("lang"),n=document.createElement("ogc-api-app");n.classList.add("full-height"),n.setAttribute("id","test"),t&&n.setAttribute("forced-locale",t),au.appendChild(n)}
