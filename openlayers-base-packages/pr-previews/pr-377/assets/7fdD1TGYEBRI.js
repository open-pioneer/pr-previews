import{a_ as Se,af as S,bR as x,ay as ht,bS as bt,ak as Me,an as Pt,am as xt,bT as vt,bU as wt,bV as jt,bW as Ct,ac as Ot,bX as A,bY as Fe,bZ as St,aZ as Ne,b3 as Le,u as Mt,k as se,r as Ft,i as Nt,g as Pe,h as xe,e as Lt}from"./j0mck_Meu7Xh.js";import{G as Tt,a as It,b as Gt,M as kt}from"./BWf1FusGPLsb.js";import{L as At}from"./ajAX9OmvUsbZ.js";import{J as Et,r as l,j as a,K as Rt,L as Te,l as E,k as Ie,M as _t,N as Bt,O as re,P as D,Q as j,u as Dt,o as Ht,R as Jt,w as Vt,g as k,h as V,D as Ut,T as zt,U as $t,q as Ge,b as ae,F as ke,B as H}from"./B60Dx_GOYdnk.js";import{u as J,B as Wt}from"./DSjrbd_eKbZM.js";import{f as Ae,F as Kt}from"./2C0geDG_OBHU.js";import{u as Yt,a as qt,b as Zt,c as Qt,l as Xt,i as ve,M as er}from"./C9VJq5Ka7299.js";import{S as Ee,I as tr}from"./BXfBNJYYR7xb.js";import{C as rr,a as or,b as nr,M as we}from"./CMfwYEDRd35m.js";import{c as sr}from"./BlACKGYldMfy.js";import{C as ar}from"./CG5nmvkyugDn.js";import{T as ie,L as ir}from"./BKR6R-cAnIXt.js";const lr=r=>{const{condition:e,message:t}=r};function cr(r){return"current"in r}const Re=()=>typeof window<"u";function ur(){return navigator.userAgentData?.platform??navigator.platform}const dr=r=>Re()&&r.test(navigator.vendor),pr=r=>Re()&&r.test(ur()),mr=()=>pr(/mac|iphone|ipad|ipod/i),fr=()=>mr()&&dr(/apple/i);function gr(r){const{ref:e,elements:t,enabled:o}=r,n=()=>e.current?.ownerDocument??document;Et(n,"pointerdown",s=>{if(!fr()||!o)return;const i=s.composedPath?.()?.[0]??s.target,m=(t??[e]).some(c=>{const f=cr(c)?c.current:c;return f?.contains(i)||f===i});n().activeElement!==i&&m&&(s.preventDefault(),i.focus())})}const G={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},wo={enter:{duration:.2,ease:G.easeOut},exit:{duration:.1,ease:G.easeIn}},je={enter:(r,e)=>({...r,delay:typeof e=="number"?e:e?.enter}),exit:(r,e)=>({...r,delay:typeof e=="number"?e:e?.exit})},yr=r=>r!=null&&parseInt(r.toString(),10)>0,Ce={exit:{height:{duration:.2,ease:G.ease},opacity:{duration:.3,ease:G.ease}},enter:{height:{duration:.3,ease:G.ease},opacity:{duration:.4,ease:G.ease}}},hr={exit:({animateOpacity:r,startingHeight:e,transition:t,transitionEnd:o,delay:n})=>({...r&&{opacity:yr(e)?1:0},height:e,transitionEnd:o?.exit,transition:t?.exit??je.exit(Ce.exit,n)}),enter:({animateOpacity:r,endingHeight:e,transition:t,transitionEnd:o,delay:n})=>({...r&&{opacity:1},height:e,transitionEnd:o?.enter,transition:t?.enter??je.enter(Ce.enter,n)})},_e=l.forwardRef((r,e)=>{const{in:t,unmountOnExit:o,animateOpacity:n=!0,startingHeight:s=0,endingHeight:i="auto",style:u,className:m,transition:c,transitionEnd:f,animatePresenceProps:g,...v}=r,[y,C]=l.useState(!1);l.useEffect(()=>{const z=setTimeout(()=>{C(!0)});return()=>clearTimeout(z)},[]),lr({condition:Number(s)>0&&!!o,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const O=parseFloat(s.toString())>0,p={startingHeight:s,endingHeight:i,animateOpacity:n,transition:y?c:{enter:{duration:0}},transitionEnd:{enter:f?.enter,exit:o?f?.exit:{...f?.exit,display:O?"block":"none"}}},h=o?t:!0,M=t||o?"enter":"exit";return a.jsx(Rt,{...g,initial:!1,custom:p,children:h&&a.jsx(Te.div,{ref:e,...v,className:E("chakra-collapse",m),style:{overflow:"hidden",display:"block",...u},custom:p,variants:hr,initial:o?"exit":!1,animate:M,exit:"exit"})})});_e.displayName="Collapse";const[br,L]=Ie({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[Pr,U]=Ie({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `}),I={click:"click",hover:"hover"};function xr(r={}){const{closeOnBlur:e=!0,closeOnEsc:t=!0,initialFocusRef:o,id:n,returnFocusOnClose:s=!0,autoFocus:i=!0,arrowSize:u,arrowShadowColor:m,trigger:c=I.click,openDelay:f=200,closeDelay:g=200,isLazy:v,lazyBehavior:y="unmount",computePositionOnMount:C,...O}=r,{isOpen:p,onClose:h,onOpen:M,onToggle:z}=_t(r),[tt,Q]=l.useState(s);l.useEffect(()=>Q(s),[s]);const X=l.useRef(null),_=l.useRef(null),F=l.useRef(null),B=l.useRef(!1),de=l.useRef(!1);p&&(de.current=!0);const[pe,rt]=l.useState(!1),[me,ot]=l.useState(!1),nt=l.useId(),st=n??nt,[fe,$,W,K]=["popover-trigger","popover-content","popover-header","popover-body"].map(d=>`${d}-${st}`),{referenceRef:Y,getArrowProps:at,getPopperProps:ge,getArrowInnerProps:it,forceUpdate:lt}=Bt({...O,enabled:p||!!C}),ye=Yt({isOpen:p,ref:F});gr({enabled:p,ref:_}),qt(F,{focusRef:_,visible:p,shouldFocus:tt&&c===I.click}),Zt(F,{focusRef:o,visible:p,shouldFocus:i&&c===I.click}),Qt({enabled:p&&e,ref:F,handler(d){const P=d.composedPath?.()[0]??[d.target];q(_.current,P)||(P&&Q(!ve(P)),h())}});const he=Xt({wasSelected:de.current,enabled:v,mode:y,isSelected:ye.present}),ct=l.useCallback((d={},P=null)=>{const b={...d,style:{...d.style,transformOrigin:re.transformOrigin.varRef,[re.arrowSize.var]:u?`${u}px`:void 0,[re.arrowShadowColor.var]:m},ref:D(F,P),children:he?d.children:null,id:$,tabIndex:-1,role:"dialog",onKeyDown:j(d.onKeyDown,w=>{w.nativeEvent.isComposing||t&&w.key==="Escape"&&(w.preventDefault(),w.stopPropagation(),h())}),onBlur:j(d.onBlur,w=>{const T=Oe(w),te=q(F.current,T),gt=q(_.current,T),yt=!te&&!gt;T&&Q(!ve(T)),p&&e&&yt&&h()}),"aria-labelledby":pe?W:void 0,"aria-describedby":me?K:void 0};return c===I.hover&&(b.role="tooltip",b.onMouseEnter=j(d.onMouseEnter,()=>{B.current=!0}),b.onMouseLeave=j(d.onMouseLeave,w=>{w.nativeEvent.relatedTarget!==null&&(B.current=!1,setTimeout(()=>h(),g))})),b},[he,$,pe,W,me,K,c,t,h,p,e,g,m,u]),ut=l.useCallback((d={},P=null)=>ge({...d,style:{visibility:p?"visible":"hidden",...d.style}},P),[p,ge]),dt=l.useCallback((d,P=null)=>({...d,ref:D(P,X,Y)}),[X,Y]),N=l.useRef(),ee=l.useRef(),be=l.useCallback(d=>{X.current==null&&Y(d)},[Y]),pt=l.useCallback((d={},P=null)=>{const b={...d,ref:D(_,P,be),id:fe,"aria-haspopup":"dialog","aria-expanded":p,"aria-controls":$};return c===I.click&&(b.onClick=j(d.onClick,z)),c===I.hover&&(b.onFocus=j(d.onFocus,()=>{N.current===void 0&&M()}),b.onBlur=j(d.onBlur,w=>{const T=Oe(w),te=!q(F.current,T);p&&e&&te&&h()}),b.onKeyDown=j(d.onKeyDown,w=>{w.key==="Escape"&&h()}),b.onMouseEnter=j(d.onMouseEnter,()=>{B.current=!0,N.current=window.setTimeout(()=>M(),f)}),b.onMouseLeave=j(d.onMouseLeave,()=>{B.current=!1,N.current&&(clearTimeout(N.current),N.current=void 0),ee.current=window.setTimeout(()=>{B.current===!1&&h()},g)})),b},[fe,p,$,c,be,z,M,e,h,f,g]);l.useEffect(()=>()=>{N.current&&clearTimeout(N.current),ee.current&&clearTimeout(ee.current)},[]);const mt=l.useCallback((d={},P=null)=>({...d,id:W,ref:D(P,b=>{rt(!!b)})}),[W]),ft=l.useCallback((d={},P=null)=>({...d,id:K,ref:D(P,b=>{ot(!!b)})}),[K]);return{forceUpdate:lt,isOpen:p,onAnimationComplete:ye.onComplete,onClose:h,getAnchorProps:dt,getArrowProps:at,getArrowInnerProps:it,getPopoverPositionerProps:ut,getPopoverProps:ct,getTriggerProps:pt,getHeaderProps:mt,getBodyProps:ft}}function q(r,e){return r===e||r?.contains(e)}function Oe(r){const e=r.currentTarget.ownerDocument.activeElement;return r.relatedTarget??e}function Be(r){const e=Dt("Popover",r),{children:t,...o}=Ht(r),n=Jt(),s=xr({...o,direction:n.direction});return a.jsx(br,{value:s,children:a.jsx(Pr,{value:e,children:Vt(t,{isOpen:s.isOpen,onClose:s.onClose,forceUpdate:s.forceUpdate})})})}Be.displayName="Popover";const oe=(r,e)=>e?`${r}.${e}, ${e}`:void 0;function De(r){const{bg:e,bgColor:t,backgroundColor:o,shadow:n,boxShadow:s,shadowColor:i,...u}=r,{getArrowProps:m,getArrowInnerProps:c}=L(),f=U(),g=e??t??o,v=n??s;return a.jsx(k.div,{...m(),className:"chakra-popover__arrow-positioner",children:a.jsx(k.div,{className:E("chakra-popover__arrow",r.className),...c(u),__css:{"--popper-arrow-shadow-color":oe("colors",i),"--popper-arrow-bg":oe("colors",g),"--popper-arrow-shadow":oe("shadows",v),...f.arrow}})})}De.displayName="PopoverArrow";const He=V(function(e,t){const{getBodyProps:o}=L(),n=U();return a.jsx(k.div,{...o(e,t),className:E("chakra-popover__body",e.className),__css:n.body})});He.displayName="PopoverBody";const Je=V(function(e,t){const{onClose:o}=L(),n=U();return a.jsx(Ut,{size:"sm",onClick:o,className:E("chakra-popover__close-btn",e.className),__css:n.closeButton,ref:t,...e})});Je.displayName="PopoverCloseButton";function vr(r){if(r)return{enter:{...r.enter,visibility:"visible"},exit:{...r.exit,transitionEnd:{visibility:"hidden"}}}}const wr={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},jr=k(Te.section),Ve=V(function(e,t){const{variants:o=wr,...n}=e,{isOpen:s}=L();return a.jsx(jr,{ref:t,variants:vr(o),initial:!1,animate:s?"enter":"exit",...n})});Ve.displayName="PopoverTransition";const Ue=V(function(e,t){const{rootProps:o,motionProps:n,...s}=e,{getPopoverProps:i,getPopoverPositionerProps:u,onAnimationComplete:m}=L(),c=U(),f=zt({position:"relative",display:"flex",flexDirection:"column",...c.content});return a.jsx(k.div,{...u(o),__css:c.popper,className:"chakra-popover__popper",children:a.jsx(Ve,{...n,...i(s,t),onAnimationComplete:$t(m,s.onAnimationComplete),className:E("chakra-popover__content",e.className),__css:f})})});Ue.displayName="PopoverContent";const ze=V(function(e,t){const{getHeaderProps:o}=L(),n=U();return a.jsx(k.header,{...o(e,t),className:E("chakra-popover__header",e.className),__css:n.header})});ze.displayName="PopoverHeader";function $e(r){const e=l.Children.only(r.children),{getTriggerProps:t}=L();return a.jsx(a.Fragment,{children:l.cloneElement(e,t(e.props,e.ref))})}$e.displayName="PopoverTrigger";function Cr(r){return"parentLayer"in r}function jo(r){return"olLayer"in r}class Or{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Se,this.supportedMediaTypes=null}getReadOptions(e,t){if(t){let o=t.dataProjection?S(t.dataProjection):this.readProjection(e);t.extent&&o&&o.getUnits()==="tile-pixels"&&(o=S(o),o.setWorldExtent(t.extent)),t={dataProjection:o,featureProjection:t.featureProjection}}return this.adaptOptions(t)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return x()}readFeature(e,t){return x()}readFeatures(e,t){return x()}readGeometry(e,t){return x()}readProjection(e){return x()}writeFeature(e,t){return x()}writeFeatures(e,t){return x()}writeGeometry(e,t){return x()}}function le(r,e,t){const o=t?S(t.featureProjection):null,n=t?S(t.dataProjection):null;let s=r;if(o&&n&&!ht(o,n)){e&&(s=r.clone());const i=e?o:n,u=e?n:o;i.getUnits()==="tile-pixels"?s.transform(i,u):s.applyTransform(bt(i,u))}if(e&&t&&t.decimals!==void 0){const i=Math.pow(10,t.decimals),u=function(m){for(let c=0,f=m.length;c<f;++c)m[c]=Math.round(m[c]*i)/i;return m};s===r&&(s=r.clone()),s.applyTransform(u)}return s}const Sr={Point:Pt,LineString:At,Polygon:xt,MultiPoint:It,MultiLineString:Gt,MultiPolygon:kt};function Mr(r,e,t){return Array.isArray(e[0])?(vt(r,0,e,t)||(r=r.slice(),wt(r,0,e,t)),r):(jt(r,0,e,t)||(r=r.slice(),Ct(r,0,e,t)),r)}function We(r,e){const t=r.geometry;if(!t)return[];if(Array.isArray(t))return t.map(s=>We({...r,geometry:s})).flat();const o=t.type==="MultiPolygon"?"Polygon":t.type;if(o==="GeometryCollection"||o==="Circle")throw new Error("Unsupported geometry type: "+o);const n=t.layout.length;return le(new Me(o,o==="Polygon"?Mr(t.flatCoordinates,t.ends,n):t.flatCoordinates,t.ends?.flat(),n,r.properties||{},r.id).enableSimplifyTransformed(),!1,e)}function ce(r,e){if(!r)return null;if(Array.isArray(r)){const o=r.map(n=>ce(n,e));return new Tt(o)}const t=Sr[r.type];return le(new t(r.flatCoordinates,r.layout,r.ends),!1,e)}class Fr extends Or{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(Z(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(Z(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return x()}readFeaturesFromObject(e,t){return x()}readGeometry(e,t){return this.readGeometryFromObject(Z(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return x()}readProjection(e){return this.readProjectionFromObject(Z(e))}readProjectionFromObject(e){return x()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return x()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return x()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return x()}}function Z(r){if(typeof r=="string"){const e=JSON.parse(r);return e||null}return r!==null?r:null}class Co extends Fr{constructor(e){e=e||{},super(),this.dataProjection=S(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=S(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let o=null;e.type==="Feature"?o=e:o={type:"Feature",geometry:e,properties:null};const n=ue(o.geometry);if(this.featureClass===Me)return We({geometry:n,id:o.id,properties:o.properties},t);const s=new Se;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&o.geometry_name&&s.setGeometryName(o.geometry_name),s.setGeometry(ce(n,t)),"id"in o&&s.setId(o.id),o.properties&&s.setProperties(o.properties,!0),s}readFeaturesFromObject(e,t){const o=e;let n=null;if(o.type==="FeatureCollection"){const s=e;n=[];const i=s.features;for(let u=0,m=i.length;u<m;++u){const c=this.readFeatureFromObject(i[u],t);c&&n.push(c)}}else n=[this.readFeatureFromObject(e,t)];return n.flat()}readGeometryFromObject(e,t){return Nr(e,t)}readProjectionFromObject(e){const t=e.crs;let o;if(t)if(t.type=="name")o=S(t.properties.name);else if(t.type==="EPSG")o=S("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else o=this.dataProjection;return o}writeFeatureObject(e,t){t=this.adaptOptions(t);const o={type:"Feature",geometry:null,properties:null},n=e.getId();if(n!==void 0&&(o.id=n),!e.hasProperties())return o;const s=e.getProperties(),i=e.getGeometry();return i&&(o.geometry=ne(i,t),delete s[e.getGeometryName()]),Ot(s)||(o.properties=s),o}writeFeaturesObject(e,t){t=this.adaptOptions(t);const o=[];for(let n=0,s=e.length;n<s;++n)o.push(this.writeFeatureObject(e[n],t));return{type:"FeatureCollection",features:o}}writeGeometryObject(e,t){return ne(e,this.adaptOptions(t))}}function ue(r,e){if(!r)return null;let t;switch(r.type){case"Point":{t=Tr(r);break}case"LineString":{t=Ir(r);break}case"Polygon":{t=Er(r);break}case"MultiPoint":{t=kr(r);break}case"MultiLineString":{t=Gr(r);break}case"MultiPolygon":{t=Ar(r);break}case"GeometryCollection":{t=Lr(r);break}default:throw new Error("Unsupported GeoJSON type: "+r.type)}return t}function Nr(r,e){const t=ue(r);return ce(t,e)}function Lr(r,e){return r.geometries.map(function(o){return ue(o)})}function Tr(r){const e=r.coordinates;return{type:"Point",flatCoordinates:e,layout:A(e.length)}}function Ir(r){const e=r.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:A(e[0]?.length||2)}}function Gr(r){const e=r.coordinates,t=e[0]?.[0]?.length||2,o=[],n=Fe(o,0,e,t);return{type:"MultiLineString",flatCoordinates:o,ends:n,layout:A(t)}}function kr(r){const e=r.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:A(e[0]?.length||2)}}function Ar(r){const e=r.coordinates,t=[],o=e[0]?.[0]?.[0].length||2,n=St(t,0,e,o);return{type:"MultiPolygon",flatCoordinates:t,ends:n,layout:A(o)}}function Er(r){const e=r.coordinates,t=[],o=e[0]?.[0]?.length,n=Fe(t,0,e,o);return{type:"Polygon",flatCoordinates:t,ends:n,layout:A(o)}}function ne(r,e){r=le(r,!0,e);const t=r.getType();let o;switch(t){case"Point":{o=Jr(r);break}case"LineString":{o=_r(r);break}case"Polygon":{o=Vr(r,e);break}case"MultiPoint":{o=Dr(r);break}case"MultiLineString":{o=Br(r);break}case"MultiPolygon":{o=Hr(r,e);break}case"GeometryCollection":{o=Rr(r,e);break}case"Circle":{o={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return o}function Rr(r,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:r.getGeometriesArray().map(function(o){return ne(o,e)})}}function _r(r,e){return{type:"LineString",coordinates:r.getCoordinates()}}function Br(r,e){return{type:"MultiLineString",coordinates:r.getCoordinates()}}function Dr(r,e){return{type:"MultiPoint",coordinates:r.getCoordinates()}}function Hr(r,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:r.getCoordinates(t)}}function Jr(r,e){return{type:"Point",coordinates:r.getCoordinates()}}function Vr(r,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:r.getCoordinates(t)}}const Ur=sr({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"}),Oo=l.forwardRef(function(e,t){const{label:o,icon:n,onClick:s,isLoading:i,isDisabled:u,isActive:m,tooltipProps:c,buttonProps:f}=e,{containerProps:{className:g,...v}}=Ne("tool-button",e),y=Le(g,{"tool-button--active":m,"tool-button--loading":i,"tool-button--disabled":u}),C=typeof m=="boolean"?m?"true":"false":void 0,[O,p]=l.useState(!1),h=M=>{p(!1),s?.(M)};return a.jsx(Ge,{label:o,placement:"auto",openDelay:500,...c,isOpen:O,onOpen:()=>p(!0),onClose:()=>p(!1),children:a.jsx(zr,{className:y,ref:t,"aria-label":o,leftIcon:n,iconSpacing:0,padding:0,isDisabled:u,isLoading:i,isActive:m,"aria-pressed":C,...v,...f,onClick:h})})}),zr=l.forwardRef(function(e,t){const{"aria-labelledby":o,"aria-describedby":n,...s}=e;return a.jsx(ae,{ref:t,...s})}),$r="@open-pioneer/toc",R=Mt.bind(void 0,$r),Ke=l.createContext(void 0),Wr=Ke.Provider;function Kr(){const r=l.useContext(Ke);if(!r)throw new Error("useTocWidgetOptions must be used within a TocWidgetOptionsProvider");return r}const Ye=l.createContext(void 0),Yr=Ye.Provider;function qe(){const r=l.useContext(Ye);if(!r)throw new Error("Internal error: TocModel not found in context");return r}function qr(r){return r.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function Zr(r){return J(()=>{const e=r.layers.getOperationalLayers({sortByDisplayOrder:!0})??[];return e.reverse(),e},[r])}function Qr(r){return J(()=>{const e=r.children?.getItems({sortByDisplayOrder:!0});return e?.reverse(),e},[r])}function Ze(r){return J(()=>(Cr(r)?r.parentLayer:r).loadState,[r])}function Xr(r){const{layer:e,title:t,description:o,intl:n}=r,s=!!o,i=n.formatMessage({id:"descriptionLabel"}),u=Ze(e)!=="error";return s&&a.jsxs(Be,{placement:"bottom-start",children:[a.jsx($e,{children:a.jsx(ae,{isDisabled:!u,className:"toc-layer-item-details-button","aria-label":i,borderRadius:"full",iconSpacing:0,padding:0,variant:"ghost",leftIcon:a.jsx(Ae,{})})}),a.jsx(ke,{children:a.jsxs(Ue,{className:"toc-layer-item-details",overflowY:"auto",maxHeight:"400",children:[a.jsx(De,{}),a.jsx(Je,{mt:1}),a.jsx(ze,{children:t}),a.jsx(He,{children:o})]})})]})}const eo=l.memo(function(e){const{layer:t}=e,o=R(),[n,s,i]=ro(t),u=J(()=>n.isExpanded,[n]),m=i?i.collapsibleGroups:!1,c=l.useId(),f=Qr(t),g=Ze(t)!=="error",v=o.formatMessage({id:"layerNotAvailable"}),{title:y,description:C,isVisible:O}=J(()=>({title:t.title,description:t.description,isVisible:t.visible}),[t]);let p;return f?.length&&(p=a.jsx(Xe,{layers:f,ml:4,"aria-label":o.formatMessage({id:"childgroupLabel"},{title:y})})),a.jsxs(H,{as:"li",className:Le("toc-layer-item",`layer-${qr(t.id)}`),children:[a.jsxs(se,{className:"toc-layer-item-content",width:"100%",flexDirection:"row",align:"center",justifyContent:"space-between",gap:2,minHeight:10,children:[m&&a.jsx(to,{layerTitle:y,layerGroupId:c,expanded:u,onClick:()=>n.setExpanded(!u),hasNestedChildren:!!p}),a.jsx(ar,{"aria-label":y+(g?"":" "+v),isChecked:O,isDisabled:!g,onChange:h=>Qe(t,h.target.checked,i.autoShowParents),children:y}),!g&&a.jsx(Ge,{className:"toc-layer-item-content-tooltip",label:v,placement:"right",openDelay:500,children:a.jsx("span",{children:a.jsx(Kt,{className:"toc-layer-item-content-icon",color:"red","aria-label":v})})}),a.jsx(Ee,{}),a.jsx(Xr,{layer:t,title:y,description:C,intl:o})]}),p&&a.jsx(_e,{in:u,id:c,className:"toc-collapsible-item",children:p})]})});function to(r){const{layerTitle:e,layerGroupId:t,expanded:o,onClick:n,hasNestedChildren:s}=r,i=R();return a.jsx(tr,{variant:"ghost",borderRadius:"full",padding:0,className:"toc-layer-item-collapse-button",onClick:n,icon:o?a.jsx(rr,{}):a.jsx(Ur,{}),"aria-label":o?i.formatMessage({id:"group.collapse"},{title:e}):i.formatMessage({id:"group.expand"},{title:e}),"aria-expanded":o,"aria-controls":t,visibility:s?"visible":"hidden"})}function ro(r){const e=qe(),t=Kr(),o=t.isCollapsed,n=l.useMemo(()=>{const s=Ft(!o);return{layerId:r.id,get isExpanded(){return s.value},setExpanded(i){s.value=i}}},[r,o]);return l.useEffect(()=>(e.registerItem(n),()=>e.unregisterItem(n)),[e,n]),[n,e,t]}function Qe(r,e,t){r.setVisible(e),e&&t&&r.parent&&Qe(r.parent,!0,!0)}const oo=l.memo(function(e){const{map:t,"aria-label":o}=e,n=R(),s=Zr(t);return s.length?a.jsx(Xe,{layers:s,"aria-label":o}):a.jsx(ie,{className:"toc-missing-layers","aria-label":o,children:n.formatMessage({id:"missingLayers"})})}),Xe=l.memo(function(e){const{layers:t,...o}=e,n=l.useMemo(()=>t.map(s=>a.jsx(eo,{layer:s},s.id)),[t]);return a.jsx(H,{children:a.jsx(ir,{as:"ul",className:"toc-layer-list",listStyleType:"none",role:"group",...o,children:n})})}),no=l.memo(function(e){const t=R(),{map:o,showHideAllLayers:n=!0,showCollapseAllGroups:s=!0}=e,i=qe();return!(!n&&!s)&&a.jsx(H,{className:"toc-tools",children:a.jsxs(er,{placement:"bottom-start",children:[a.jsx(or,{as:ae,className:"toc-tools-button","aria-label":t.formatMessage({id:"toolsLabel"}),borderRadius:"full",iconSpacing:0,padding:3,variant:"ghost",leftIcon:a.jsx(Ae,{})}),a.jsx(ke,{children:a.jsxs(nr,{className:"tools-menu",children:[n&&a.jsx(we,{"aria-label":t.formatMessage({id:"tools.hideAllLayers"}),onClick:()=>{so(o)},children:t.formatMessage({id:"tools.hideAllLayers"})}),s&&a.jsx(we,{"aria-label":t.formatMessage({id:"tools.collapseAllGroups"}),onClick:()=>{ao(i)},children:t.formatMessage({id:"tools.collapseAllGroups"})})]})})]})})});function so(r){const e=t=>{t.setVisible(!1);const o=t.children?.getItems();if(o)for(const n of o)e(n)};r?.layers.getOperationalLayers().forEach(t=>{e(t)})}function ao(r){r.getItems().forEach(e=>e.setExpanded(!1))}const et=2,So=r=>{const e=R(),{containerProps:t}=Ne("toc",r),o=Nt(r);let n;switch(o.kind){case"loading":n=null;break;case"rejected":n=a.jsx(ie,{className:"toc-error",children:e.formatMessage({id:"error"})});break;case"resolved":{const s=o.map;n=a.jsx(io,{...r,map:s});break}}return a.jsx(se,{...t,direction:"column",gap:et,children:n})};function io(r){const{map:e,showTools:t=!1,toolsConfig:o,showBasemapSwitcher:n=!0,basemapSwitcherProps:s,collapsibleGroups:i=!1,autoShowParents:u=!0}=r,m=R(),[c,f]=l.useState(r.isCollapsed||!1),g=lo(),v=l.useId(),y=l.useMemo(()=>({autoShowParents:u,collapsibleGroups:i,isCollapsed:c}),[u,i,c]),C=o?o.showCollapseAllGroups&&y.collapsibleGroups:y.collapsibleGroups;!y.collapsibleGroups&&c&&f(!1);const O=n&&a.jsx(H,{className:"toc-basemap-switcher",children:a.jsx(Pe,{title:a.jsx(xe,{id:v,size:"sm",mb:et,children:m.formatMessage({id:"basemapsLabel"})}),children:a.jsx(Wt,{map:e,"aria-labelledby":v,...s})})}),p=a.jsx(Yr,{value:g,children:a.jsx(H,{className:"toc-operational-layers",children:a.jsx(Pe,{title:a.jsx(xe,{size:"sm",mb:2,children:a.jsxs(se,{children:[a.jsx(ie,{my:3,children:m.formatMessage({id:"operationalLayerLabel"})}),a.jsx(Ee,{}),t&&a.jsx(no,{map:e,showHideAllLayers:o?.showHideAllLayers,showCollapseAllGroups:C})]})}),children:a.jsx(oo,{map:e,"aria-label":m.formatMessage({id:"operationalLayerLabel"})})})})});return a.jsxs(Wr,{value:y,children:[O,p]})}function lo(){return l.useMemo(()=>{const e=Lt();return{getItem(t){return e.get(t)},getItems(){return Array.from(e.values())},registerItem(t){if(e.has(t.layerId))throw new Error(`Item with layerId '${t.layerId}' already registered.`);e.set(t.layerId,t)},unregisterItem(t){if(e.get(t.layerId)!==t)throw new Error(`Item with layerId '${t.layerId}' not registered.`);e.delete(t.layerId)}}},[])}export{Or as F,Co as G,Be as P,Oo as T,$e as a,Ue as b,De as c,He as d,So as e,jo as i,le as t,L as u};
