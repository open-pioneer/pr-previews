import{a_ as Me,af as C,bS as P,ay as Pt,bT as bt,ak as Fe,an as xt,am as vt,bU as jt,bV as wt,bW as Ct,bX as St,ac as Ot,bY as E,bZ as Ne,b_ as Mt,aZ as Le,b3 as Ge,u as Ft,k as se,r as Te,i as Nt,g as be,h as xe,e as Lt}from"./CJOMUzuXHJII.js";import{G as Gt,a as Tt,b as It,M as kt}from"./Bu_43mKGnCOG.js";import{L as At}from"./Cn3HZBIwEo9W.js";import{J as Et,r as c,j as a,K as Rt,L as Ie,l as R,k as ke,M as _t,N as Bt,O as oe,P as H,Q as w,u as Dt,o as Ht,R as Jt,w as Vt,g as A,h as V,D as Ut,T as zt,U as $t,q as Ae,b as ae,F as Ee,B as J}from"./B60Dx_GOYdnk.js";import{u as L,B as Kt}from"./54MY6-8UO51Y.js";import{f as Re,F as Wt}from"./2C0geDG_OBHU.js";import{u as Yt,a as qt,b as Zt,c as Qt,l as Xt,i as ve,M as eo}from"./C9VJq5Ka7299.js";import{S as _e,I as to}from"./BXfBNJYYR7xb.js";import{C as oo,a as ro,b as no,M as je}from"./CMfwYEDRd35m.js";import{c as so}from"./BlACKGYldMfy.js";import{C as ao}from"./CG5nmvkyugDn.js";import{T as ie,L as io}from"./BKR6R-cAnIXt.js";const lo=t=>{const{condition:e,message:o}=t};function co(t){return"current"in t}const Be=()=>typeof window<"u";function uo(){return navigator.userAgentData?.platform??navigator.platform}const po=t=>Be()&&t.test(navigator.vendor),mo=t=>Be()&&t.test(uo()),fo=()=>mo(/mac|iphone|ipad|ipod/i),yo=()=>fo()&&po(/apple/i);function go(t){const{ref:e,elements:o,enabled:r}=t,n=()=>e.current?.ownerDocument??document;Et(n,"pointerdown",s=>{if(!yo()||!r)return;const i=s.composedPath?.()?.[0]??s.target,p=(o??[e]).some(u=>{const f=co(u)?u.current:u;return f?.contains(i)||f===i});n().activeElement!==i&&p&&(s.preventDefault(),i.focus())})}const k={ease:[.25,.1,.25,1],easeIn:[.4,0,1,1],easeOut:[0,0,.2,1],easeInOut:[.4,0,.2,1]},xr={enter:{duration:.2,ease:k.easeOut},exit:{duration:.1,ease:k.easeIn}},we={enter:(t,e)=>({...t,delay:typeof e=="number"?e:e?.enter}),exit:(t,e)=>({...t,delay:typeof e=="number"?e:e?.exit})},ho=t=>t!=null&&parseInt(t.toString(),10)>0,Ce={exit:{height:{duration:.2,ease:k.ease},opacity:{duration:.3,ease:k.ease}},enter:{height:{duration:.3,ease:k.ease},opacity:{duration:.4,ease:k.ease}}},Po={exit:({animateOpacity:t,startingHeight:e,transition:o,transitionEnd:r,delay:n})=>({...t&&{opacity:ho(e)?1:0},height:e,transitionEnd:r?.exit,transition:o?.exit??we.exit(Ce.exit,n)}),enter:({animateOpacity:t,endingHeight:e,transition:o,transitionEnd:r,delay:n})=>({...t&&{opacity:1},height:e,transitionEnd:r?.enter,transition:o?.enter??we.enter(Ce.enter,n)})},De=c.forwardRef((t,e)=>{const{in:o,unmountOnExit:r,animateOpacity:n=!0,startingHeight:s=0,endingHeight:i="auto",style:l,className:p,transition:u,transitionEnd:f,animatePresenceProps:b,...v}=t,[j,S]=c.useState(!1);c.useEffect(()=>{const z=setTimeout(()=>{S(!0)});return()=>clearTimeout(z)},[]),lo({condition:Number(s)>0&&!!r,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const O=parseFloat(s.toString())>0,m={startingHeight:s,endingHeight:i,animateOpacity:n,transition:j?u:{enter:{duration:0}},transitionEnd:{enter:f?.enter,exit:r?f?.exit:{...f?.exit,display:O?"block":"none"}}},y=r?o:!0,M=o||r?"enter":"exit";return a.jsx(Rt,{...b,initial:!1,custom:m,children:y&&a.jsx(Ie.div,{ref:e,...v,className:R("chakra-collapse",p),style:{overflow:"hidden",display:"block",...l},custom:m,variants:Po,initial:r?"exit":!1,animate:M,exit:"exit"})})});De.displayName="Collapse";const[bo,G]=ke({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[xo,U]=ke({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `}),I={click:"click",hover:"hover"};function vo(t={}){const{closeOnBlur:e=!0,closeOnEsc:o=!0,initialFocusRef:r,id:n,returnFocusOnClose:s=!0,autoFocus:i=!0,arrowSize:l,arrowShadowColor:p,trigger:u=I.click,openDelay:f=200,closeDelay:b=200,isLazy:v,lazyBehavior:j="unmount",computePositionOnMount:S,...O}=t,{isOpen:m,onClose:y,onOpen:M,onToggle:z}=_t(t),[ot,Q]=c.useState(s);c.useEffect(()=>Q(s),[s]);const X=c.useRef(null),B=c.useRef(null),F=c.useRef(null),D=c.useRef(!1),de=c.useRef(!1);m&&(de.current=!0);const[pe,rt]=c.useState(!1),[me,nt]=c.useState(!1),st=c.useId(),at=n??st,[fe,$,K,W]=["popover-trigger","popover-content","popover-header","popover-body"].map(d=>`${d}-${at}`),{referenceRef:Y,getArrowProps:it,getPopperProps:ye,getArrowInnerProps:lt,forceUpdate:ct}=Bt({...O,enabled:m||!!S}),ge=Yt({isOpen:m,ref:F});go({enabled:m,ref:B}),qt(F,{focusRef:B,visible:m,shouldFocus:ot&&u===I.click}),Zt(F,{focusRef:r,visible:m,shouldFocus:i&&u===I.click}),Qt({enabled:m&&e,ref:F,handler(d){const h=d.composedPath?.()[0]??[d.target];q(B.current,h)||(h&&Q(!ve(h)),y())}});const he=Xt({wasSelected:de.current,enabled:v,mode:j,isSelected:ge.present}),ut=c.useCallback((d={},h=null)=>{const g={...d,style:{...d.style,transformOrigin:oe.transformOrigin.varRef,[oe.arrowSize.var]:l?`${l}px`:void 0,[oe.arrowShadowColor.var]:p},ref:H(F,h),children:he?d.children:null,id:$,tabIndex:-1,role:"dialog",onKeyDown:w(d.onKeyDown,x=>{x.nativeEvent.isComposing||o&&x.key==="Escape"&&(x.preventDefault(),x.stopPropagation(),y())}),onBlur:w(d.onBlur,x=>{const T=Se(x),te=q(F.current,T),gt=q(B.current,T),ht=!te&&!gt;T&&Q(!ve(T)),m&&e&&ht&&y()}),"aria-labelledby":pe?K:void 0,"aria-describedby":me?W:void 0};return u===I.hover&&(g.role="tooltip",g.onMouseEnter=w(d.onMouseEnter,()=>{D.current=!0}),g.onMouseLeave=w(d.onMouseLeave,x=>{x.nativeEvent.relatedTarget!==null&&(D.current=!1,setTimeout(()=>y(),b))})),g},[he,$,pe,K,me,W,u,o,y,m,e,b,p,l]),dt=c.useCallback((d={},h=null)=>ye({...d,style:{visibility:m?"visible":"hidden",...d.style}},h),[m,ye]),pt=c.useCallback((d,h=null)=>({...d,ref:H(h,X,Y)}),[X,Y]),N=c.useRef(),ee=c.useRef(),Pe=c.useCallback(d=>{X.current==null&&Y(d)},[Y]),mt=c.useCallback((d={},h=null)=>{const g={...d,ref:H(B,h,Pe),id:fe,"aria-haspopup":"dialog","aria-expanded":m,"aria-controls":$};return u===I.click&&(g.onClick=w(d.onClick,z)),u===I.hover&&(g.onFocus=w(d.onFocus,()=>{N.current===void 0&&M()}),g.onBlur=w(d.onBlur,x=>{const T=Se(x),te=!q(F.current,T);m&&e&&te&&y()}),g.onKeyDown=w(d.onKeyDown,x=>{x.key==="Escape"&&y()}),g.onMouseEnter=w(d.onMouseEnter,()=>{D.current=!0,N.current=window.setTimeout(()=>M(),f)}),g.onMouseLeave=w(d.onMouseLeave,()=>{D.current=!1,N.current&&(clearTimeout(N.current),N.current=void 0),ee.current=window.setTimeout(()=>{D.current===!1&&y()},b)})),g},[fe,m,$,u,Pe,z,M,e,y,f,b]);c.useEffect(()=>()=>{N.current&&clearTimeout(N.current),ee.current&&clearTimeout(ee.current)},[]);const ft=c.useCallback((d={},h=null)=>({...d,id:K,ref:H(h,g=>{rt(!!g)})}),[K]),yt=c.useCallback((d={},h=null)=>({...d,id:W,ref:H(h,g=>{nt(!!g)})}),[W]);return{forceUpdate:ct,isOpen:m,onAnimationComplete:ge.onComplete,onClose:y,getAnchorProps:pt,getArrowProps:it,getArrowInnerProps:lt,getPopoverPositionerProps:dt,getPopoverProps:ut,getTriggerProps:mt,getHeaderProps:ft,getBodyProps:yt}}function q(t,e){return t===e||t?.contains(e)}function Se(t){const e=t.currentTarget.ownerDocument.activeElement;return t.relatedTarget??e}function He(t){const e=Dt("Popover",t),{children:o,...r}=Ht(t),n=Jt(),s=vo({...r,direction:n.direction});return a.jsx(bo,{value:s,children:a.jsx(xo,{value:e,children:Vt(o,{isOpen:s.isOpen,onClose:s.onClose,forceUpdate:s.forceUpdate})})})}He.displayName="Popover";const re=(t,e)=>e?`${t}.${e}, ${e}`:void 0;function Je(t){const{bg:e,bgColor:o,backgroundColor:r,shadow:n,boxShadow:s,shadowColor:i,...l}=t,{getArrowProps:p,getArrowInnerProps:u}=G(),f=U(),b=e??o??r,v=n??s;return a.jsx(A.div,{...p(),className:"chakra-popover__arrow-positioner",children:a.jsx(A.div,{className:R("chakra-popover__arrow",t.className),...u(l),__css:{"--popper-arrow-shadow-color":re("colors",i),"--popper-arrow-bg":re("colors",b),"--popper-arrow-shadow":re("shadows",v),...f.arrow}})})}Je.displayName="PopoverArrow";const Ve=V(function(e,o){const{getBodyProps:r}=G(),n=U();return a.jsx(A.div,{...r(e,o),className:R("chakra-popover__body",e.className),__css:n.body})});Ve.displayName="PopoverBody";const Ue=V(function(e,o){const{onClose:r}=G(),n=U();return a.jsx(Ut,{size:"sm",onClick:r,className:R("chakra-popover__close-btn",e.className),__css:n.closeButton,ref:o,...e})});Ue.displayName="PopoverCloseButton";function jo(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}const wo={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},Co=A(Ie.section),ze=V(function(e,o){const{variants:r=wo,...n}=e,{isOpen:s}=G();return a.jsx(Co,{ref:o,variants:jo(r),initial:!1,animate:s?"enter":"exit",...n})});ze.displayName="PopoverTransition";const $e=V(function(e,o){const{rootProps:r,motionProps:n,...s}=e,{getPopoverProps:i,getPopoverPositionerProps:l,onAnimationComplete:p}=G(),u=U(),f=zt({position:"relative",display:"flex",flexDirection:"column",...u.content});return a.jsx(A.div,{...l(r),__css:u.popper,className:"chakra-popover__popper",children:a.jsx(ze,{...n,...i(s,o),onAnimationComplete:$t(p,s.onAnimationComplete),className:R("chakra-popover__content",e.className),__css:f})})});$e.displayName="PopoverContent";const Ke=V(function(e,o){const{getHeaderProps:r}=G(),n=U();return a.jsx(A.header,{...r(e,o),className:R("chakra-popover__header",e.className),__css:n.header})});Ke.displayName="PopoverHeader";function We(t){const e=c.Children.only(t.children),{getTriggerProps:o}=G();return a.jsx(a.Fragment,{children:c.cloneElement(e,o(e.props,e.ref))})}We.displayName="PopoverTrigger";function So(t){return"parentLayer"in t}function vr(t){return"olLayer"in t}class Oo{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Me,this.supportedMediaTypes=null}getReadOptions(e,o){if(o){let r=o.dataProjection?C(o.dataProjection):this.readProjection(e);o.extent&&r&&r.getUnits()==="tile-pixels"&&(r=C(r),r.setWorldExtent(o.extent)),o={dataProjection:r,featureProjection:o.featureProjection}}return this.adaptOptions(o)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return P()}readFeature(e,o){return P()}readFeatures(e,o){return P()}readGeometry(e,o){return P()}readProjection(e){return P()}writeFeature(e,o){return P()}writeFeatures(e,o){return P()}writeGeometry(e,o){return P()}}function le(t,e,o){const r=o?C(o.featureProjection):null,n=o?C(o.dataProjection):null;let s=t;if(r&&n&&!Pt(r,n)){e&&(s=t.clone());const i=e?r:n,l=e?n:r;i.getUnits()==="tile-pixels"?s.transform(i,l):s.applyTransform(bt(i,l))}if(e&&o&&o.decimals!==void 0){const i=Math.pow(10,o.decimals),l=function(p){for(let u=0,f=p.length;u<f;++u)p[u]=Math.round(p[u]*i)/i;return p};s===t&&(s=t.clone()),s.applyTransform(l)}return s}const Mo={Point:xt,LineString:At,Polygon:vt,MultiPoint:Tt,MultiLineString:It,MultiPolygon:kt};function Fo(t,e,o){return Array.isArray(e[0])?(jt(t,0,e,o)||(t=t.slice(),wt(t,0,e,o)),t):(Ct(t,0,e,o)||(t=t.slice(),St(t,0,e,o)),t)}function Ye(t,e){const o=t.geometry;if(!o)return[];if(Array.isArray(o))return o.map(s=>Ye({...t,geometry:s})).flat();const r=o.type==="MultiPolygon"?"Polygon":o.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const n=o.layout.length;return le(new Fe(r,r==="Polygon"?Fo(o.flatCoordinates,o.ends,n):o.flatCoordinates,o.ends?.flat(),n,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function ce(t,e){if(!t)return null;if(Array.isArray(t)){const r=t.map(n=>ce(n,e));return new Gt(r)}const o=Mo[t.type];return le(new o(t.flatCoordinates,t.layout,t.ends),!1,e)}class No extends Oo{constructor(){super()}getType(){return"json"}readFeature(e,o){return this.readFeatureFromObject(Z(e),this.getReadOptions(e,o))}readFeatures(e,o){return this.readFeaturesFromObject(Z(e),this.getReadOptions(e,o))}readFeatureFromObject(e,o){return P()}readFeaturesFromObject(e,o){return P()}readGeometry(e,o){return this.readGeometryFromObject(Z(e),this.getReadOptions(e,o))}readGeometryFromObject(e,o){return P()}readProjection(e){return this.readProjectionFromObject(Z(e))}readProjectionFromObject(e){return P()}writeFeature(e,o){return JSON.stringify(this.writeFeatureObject(e,o))}writeFeatureObject(e,o){return P()}writeFeatures(e,o){return JSON.stringify(this.writeFeaturesObject(e,o))}writeFeaturesObject(e,o){return P()}writeGeometry(e,o){return JSON.stringify(this.writeGeometryObject(e,o))}writeGeometryObject(e,o){return P()}}function Z(t){if(typeof t=="string"){const e=JSON.parse(t);return e||null}return t!==null?t:null}class jr extends No{constructor(e){e=e||{},super(),this.dataProjection=C(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=C(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,o){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const n=ue(r.geometry);if(this.featureClass===Fe)return Ye({geometry:n,id:r.id,properties:r.properties},o);const s=new Me;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(ce(n,o)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,o){const r=e;let n=null;if(r.type==="FeatureCollection"){const s=e;n=[];const i=s.features;for(let l=0,p=i.length;l<p;++l){const u=this.readFeatureFromObject(i[l],o);u&&n.push(u)}}else n=[this.readFeatureFromObject(e,o)];return n.flat()}readGeometryFromObject(e,o){return Lo(e,o)}readProjectionFromObject(e){const o=e.crs;let r;if(o)if(o.type=="name")r=C(o.properties.name);else if(o.type==="EPSG")r=C("EPSG:"+o.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,o){o=this.adaptOptions(o);const r={type:"Feature",geometry:null,properties:null},n=e.getId();if(n!==void 0&&(r.id=n),!e.hasProperties())return r;const s=e.getProperties(),i=e.getGeometry();return i&&(r.geometry=ne(i,o),delete s[e.getGeometryName()]),Ot(s)||(r.properties=s),r}writeFeaturesObject(e,o){o=this.adaptOptions(o);const r=[];for(let n=0,s=e.length;n<s;++n)r.push(this.writeFeatureObject(e[n],o));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,o){return ne(e,this.adaptOptions(o))}}function ue(t,e){if(!t)return null;let o;switch(t.type){case"Point":{o=To(t);break}case"LineString":{o=Io(t);break}case"Polygon":{o=Ro(t);break}case"MultiPoint":{o=Ao(t);break}case"MultiLineString":{o=ko(t);break}case"MultiPolygon":{o=Eo(t);break}case"GeometryCollection":{o=Go(t);break}default:throw new Error("Unsupported GeoJSON type: "+t.type)}return o}function Lo(t,e){const o=ue(t);return ce(o,e)}function Go(t,e){return t.geometries.map(function(r){return ue(r)})}function To(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:E(e.length)}}function Io(t){const e=t.coordinates,o=e.flat();return{type:"LineString",flatCoordinates:o,ends:[o.length],layout:E(e[0]?.length||2)}}function ko(t){const e=t.coordinates,o=e[0]?.[0]?.length||2,r=[],n=Ne(r,0,e,o);return{type:"MultiLineString",flatCoordinates:r,ends:n,layout:E(o)}}function Ao(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:E(e[0]?.length||2)}}function Eo(t){const e=t.coordinates,o=[],r=e[0]?.[0]?.[0].length||2,n=Mt(o,0,e,r);return{type:"MultiPolygon",flatCoordinates:o,ends:n,layout:E(r)}}function Ro(t){const e=t.coordinates,o=[],r=e[0]?.[0]?.length,n=Ne(o,0,e,r);return{type:"Polygon",flatCoordinates:o,ends:n,layout:E(r)}}function ne(t,e){t=le(t,!0,e);const o=t.getType();let r;switch(o){case"Point":{r=Vo(t);break}case"LineString":{r=Bo(t);break}case"Polygon":{r=Uo(t,e);break}case"MultiPoint":{r=Ho(t);break}case"MultiLineString":{r=Do(t);break}case"MultiPolygon":{r=Jo(t,e);break}case"GeometryCollection":{r=_o(t,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+o)}return r}function _o(t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(r){return ne(r,e)})}}function Bo(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function Do(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function Ho(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function Jo(t,e){let o;return e&&(o=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(o)}}function Vo(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function Uo(t,e){let o;return e&&(o=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(o)}}const zo=so({d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z",displayName:"ChevronRightIcon"}),wr=c.forwardRef(function(e,o){const{label:r,icon:n,onClick:s,isLoading:i,isDisabled:l,isActive:p,tooltipProps:u,buttonProps:f}=e,{containerProps:{className:b,...v}}=Le("tool-button",e),j=Ge(b,{"tool-button--active":p,"tool-button--loading":i,"tool-button--disabled":l}),S=typeof p=="boolean"?p?"true":"false":void 0,[O,m]=c.useState(!1),y=M=>{m(!1),s?.(M)};return a.jsx(Ae,{label:r,placement:"auto",openDelay:500,...u,isOpen:O,onOpen:()=>m(!0),onClose:()=>m(!1),children:a.jsx($o,{className:j,ref:o,"aria-label":r,leftIcon:n,iconSpacing:0,padding:0,isDisabled:l,isLoading:i,isActive:p,"aria-pressed":S,...v,...f,onClick:y})})}),$o=c.forwardRef(function(e,o){const{"aria-labelledby":r,"aria-describedby":n,...s}=e;return a.jsx(ae,{ref:o,...s})}),Ko="@open-pioneer/toc",_=Ft.bind(void 0,Ko),qe=c.createContext(void 0),Wo=qe.Provider;function Ze(){const t=c.useContext(qe);if(!t)throw new Error("Internal error: TocModel not found in context.");return t}function Yo(t){return t.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}function qo(t){return L(()=>{const e=t.layers.getOperationalLayers({sortByDisplayOrder:!0})??[];return e.reverse(),e},[t])}function Zo(t){return L(()=>{const e=t.children?.getItems({sortByDisplayOrder:!0});return e?.reverse(),e},[t])}function Qe(t){return L(()=>(So(t)?t.parentLayer:t).loadState,[t])}function Qo(t){const{layer:e,title:o,description:r,intl:n}=t,s=!!r,i=n.formatMessage({id:"descriptionLabel"}),l=Qe(e)!=="error";return s&&a.jsxs(He,{placement:"bottom-start",children:[a.jsx(We,{children:a.jsx(ae,{isDisabled:!l,className:"toc-layer-item-details-button","aria-label":i,borderRadius:"full",iconSpacing:0,padding:0,variant:"ghost",leftIcon:a.jsx(Re,{})})}),a.jsx(Ee,{children:a.jsxs($e,{className:"toc-layer-item-details",overflowY:"auto",maxHeight:"400",children:[a.jsx(Je,{}),a.jsx(Ue,{mt:1}),a.jsx(Ke,{children:o}),a.jsx(Ve,{children:r})]})})]})}const Xo=c.memo(function(e){const{layer:o}=e,r=_(),[n,s,i]=tr(o),l=L(()=>n.isExpanded,[n]),p=i?i.collapsibleGroups:!1,u=c.useId(),f=Zo(o),b=Qe(o)!=="error",v=r.formatMessage({id:"layerNotAvailable"}),{title:j,description:S,isVisible:O}=L(()=>({title:o.title,description:o.description,isVisible:o.visible}),[o]);let m;return f?.length&&(m=a.jsx(et,{layers:f,ml:4,"aria-label":r.formatMessage({id:"childgroupLabel"},{title:j})})),a.jsxs(J,{as:"li",className:Ge("toc-layer-item",`layer-${Yo(o.id)}`),children:[a.jsxs(se,{className:"toc-layer-item-content",width:"100%",flexDirection:"row",align:"center",justifyContent:"space-between",gap:2,minHeight:10,children:[p&&a.jsx(er,{layerTitle:j,layerGroupId:u,expanded:l,onClick:()=>n.setExpanded(!l),hasNestedChildren:!!m}),a.jsx(ao,{"aria-label":j+(b?"":" "+v),isChecked:O,isDisabled:!b,onChange:y=>Xe(o,y.target.checked,i.autoShowParents),children:j}),!b&&a.jsx(Ae,{className:"toc-layer-item-content-tooltip",label:v,placement:"right",openDelay:500,children:a.jsx("span",{children:a.jsx(Wt,{className:"toc-layer-item-content-icon",color:"red","aria-label":v})})}),a.jsx(_e,{}),a.jsx(Qo,{layer:o,title:j,description:S,intl:r})]}),m&&a.jsx(De,{in:l,id:u,className:"toc-collapsible-item",children:m})]})});function er(t){const{layerTitle:e,layerGroupId:o,expanded:r,onClick:n,hasNestedChildren:s}=t,i=_();return a.jsx(to,{variant:"ghost",borderRadius:"full",padding:0,className:"toc-layer-item-collapse-button",onClick:n,icon:r?a.jsx(oo,{}):a.jsx(zo,{}),"aria-label":r?i.formatMessage({id:"group.collapse"},{title:e}):i.formatMessage({id:"group.expand"},{title:e}),"aria-expanded":r,"aria-controls":o,visibility:s?"visible":"hidden"})}function tr(t){const e=Ze(),o=L(()=>e.options,[e]),r=c.useMemo(()=>{const n=Te(!o.initiallyCollapsed);return{layerId:t.id,get isExpanded(){return n.value},setExpanded(s){n.value=s}}},[t,o.initiallyCollapsed]);return c.useEffect(()=>(e.registerItem(r),()=>e.unregisterItem(r)),[e,r]),[r,e,o]}function Xe(t,e,o){t.setVisible(e),e&&o&&t.parent&&Xe(t.parent,!0,!0)}const or=c.memo(function(e){const{map:o,"aria-label":r}=e,n=_(),s=qo(o);return s.length?a.jsx(et,{layers:s,"aria-label":r}):a.jsx(ie,{className:"toc-missing-layers","aria-label":r,children:n.formatMessage({id:"missingLayers"})})}),et=c.memo(function(e){const{layers:o,...r}=e,n=c.useMemo(()=>o.map(s=>a.jsx(Xo,{layer:s},s.id)),[o]);return a.jsx(J,{children:a.jsx(io,{as:"ul",className:"toc-layer-list",listStyleType:"none",role:"group",...r,children:n})})}),rr=c.memo(function(e){const o=_(),r=Ze(),n=L(()=>r.options.collapsibleGroups,[r]),{map:s,showHideAllLayers:i=!0,showCollapseAllGroups:l=n}=e,p=n&&l;return(i||p)&&a.jsx(J,{className:"toc-tools",children:a.jsxs(eo,{placement:"bottom-start",children:[a.jsx(ro,{as:ae,className:"toc-tools-button","aria-label":o.formatMessage({id:"toolsLabel"}),borderRadius:"full",iconSpacing:0,padding:3,variant:"ghost",leftIcon:a.jsx(Re,{})}),a.jsx(Ee,{children:a.jsxs(no,{className:"tools-menu",children:[i&&a.jsx(je,{"aria-label":o.formatMessage({id:"tools.hideAllLayers"}),onClick:()=>{nr(s)},children:o.formatMessage({id:"tools.hideAllLayers"})}),p&&a.jsx(je,{"aria-label":o.formatMessage({id:"tools.collapseAllGroups"}),onClick:()=>{sr(r)},children:o.formatMessage({id:"tools.collapseAllGroups"})})]})})]})})});function nr(t){const e=o=>{o.setVisible(!1);const r=o.children?.getItems();if(r)for(const n of r)e(n)};t?.layers.getOperationalLayers().forEach(o=>{e(o)})}function sr(t){t.getItems().forEach(e=>e.setExpanded(!1))}const tt=2,Cr=t=>{const e=_(),{containerProps:o}=Le("toc",t),r=Nt(t);let n;switch(r.kind){case"loading":n=null;break;case"rejected":n=a.jsx(ie,{className:"toc-error",children:e.formatMessage({id:"error"})});break;case"resolved":{const s=r.map;n=a.jsx(ar,{...t,map:s});break}}return a.jsx(se,{...o,direction:"column",gap:tt,children:n})};function ar(t){const{map:e,showTools:o=!1,toolsConfig:r,showBasemapSwitcher:n=!0,basemapSwitcherProps:s}=t,i=_(),l=ir(t),p=c.useId(),u=n&&a.jsx(J,{className:"toc-basemap-switcher",children:a.jsx(be,{title:a.jsx(xe,{id:p,size:"sm",mb:tt,children:i.formatMessage({id:"basemapsLabel"})}),children:a.jsx(Kt,{map:e,"aria-labelledby":p,...s})})}),f=a.jsx(J,{className:"toc-operational-layers",children:a.jsx(be,{title:a.jsx(xe,{size:"sm",mb:2,children:a.jsxs(se,{children:[a.jsx(ie,{my:3,children:i.formatMessage({id:"operationalLayerLabel"})}),a.jsx(_e,{}),o&&a.jsx(rr,{map:e,...r})]})}),children:a.jsx(or,{map:e,"aria-label":i.formatMessage({id:"operationalLayerLabel"})})})});return a.jsxs(Wo,{value:l,children:[u,f]})}function ir(t){const e=c.useRef(t),{model:o,options:r}=c.useMemo(()=>{const n=Te(Oe(e.current.autoShowParents,e.current.collapsibleGroups,e.current.initiallyCollapsed)),s=Lt();return{model:{get options(){return n.value},getItem(l){return s.get(l)},getItems(){return Array.from(s.values())},registerItem(l){if(s.has(l.layerId))throw new Error(`Item with layerId '${l.layerId}' already registered.`);s.set(l.layerId,l)},unregisterItem(l){if(s.get(l.layerId)!==l)throw new Error(`Item with layerId '${l.layerId}' not registered.`);s.delete(l.layerId)}},options:n}},[]);return c.useEffect(()=>{r.value=Oe(t.autoShowParents,t.collapsibleGroups,t.initiallyCollapsed)},[r,t.autoShowParents,t.collapsibleGroups,t.initiallyCollapsed]),o}function Oe(t,e,o){return{autoShowParents:t??!0,collapsibleGroups:e??!1,initiallyCollapsed:o??!1}}export{Oo as F,jr as G,He as P,wr as T,We as a,$e as b,Je as c,Ve as d,Cr as e,vr as i,le as t,G as u};
