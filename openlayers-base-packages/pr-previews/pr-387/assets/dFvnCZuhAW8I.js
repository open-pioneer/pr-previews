import{h as B,u as re,o as oe,l as ae,j as m,g as G,_ as Fe,$ as ve,r as v,a0 as T,a1 as q,a2 as Ce,a3 as Ee,a4 as be,B as O}from"./DD6TXFhYmIbq.js";import{a as ce}from"./B6uSQOdSx7sA.js";import{s as Pe}from"./B5R-7_jGTK1h.js";import{bl as Me,bA as Te,bB as Ae,bC as le,bD as we,bo as Ie,a as he,b as De,aL as V,br as W,bq as E,a9 as K,G as S,bE as N,a_ as D,an as z,bF as w,p,bG as F,bH as Y,bs as x,by as L,bI as Le,bt as Ge,z as Ne,bu as k,bJ as je,bw as Re,bK as ue,ao as de,bL as Ve,bM as ke,bN as X,bO as Be,bm as Z,bP as Oe,bQ as J,f as Ue,u as ge,aZ as U,i as H,j as He,b4 as $e}from"./D64B_wOlIMvh.js";import{u as Q}from"./bIz4U9_8ivsz.js";import{c as qe}from"./BrWY8IS0Ass7.js";import{u as fe}from"./B7MksfDgavrS.js";import{T as me}from"./CrBTf7Q75dEd.js";import{S as We}from"./Biuiblx7-ntI.js";const _e=B(function(e,t){const{htmlSize:n,...i}=e,s=re("Input",i),c=oe(i),r=ce(c),o=ae("chakra-input",e.className);return m.jsx(G.input,{size:n,...r,__css:s.field,ref:t,className:o})});_e.displayName="Input";_e.id="Input";const ye=B(function(e,t){const{children:n,placeholder:i,className:s,...c}=e;return m.jsxs(G.select,{...c,ref:t,className:ae("chakra-select",s),children:[i&&m.jsx("option",{value:"",children:i}),n]})});ye.displayName="SelectField";const Ke=B((l,e)=>{const t=re("Select",l),{rootProps:n,placeholder:i,icon:s,color:c,height:r,h:o,minH:h,minHeight:a,iconColor:d,iconSize:u,...g}=oe(l),[f,_]=Pe(g,Fe),y=ce(_),P={width:"100%",height:"fit-content",position:"relative",color:c},C={paddingEnd:"2rem",...t.field,_focus:{zIndex:"unset",...t.field?._focus}};return m.jsxs(G.div,{className:"chakra-select__wrapper",__css:P,...f,...n,children:[m.jsx(ye,{ref:e,height:o??r,minH:h??a,placeholder:i,...y,__css:C,children:l.children}),m.jsx(pe,{"data-disabled":ve(y.disabled),...(d||c)&&{color:d||c},__css:t.icon,...u&&{fontSize:u},children:s})]})});Ke.displayName="Select";const ze=l=>m.jsx("svg",{viewBox:"0 0 24 24",...l,children:m.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),Ye=G("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),pe=l=>{const{children:e=m.jsx(ze,{}),...t}=l,n=v.cloneElement(e,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return m.jsx(Ye,{...t,className:"chakra-select__icon-wrapper",children:v.isValidElement(e)?n:null})};pe.displayName="SelectIcon";function Xe(l,e){const t=l??"bottom";return{"top-start":{ltr:"top-left",rtl:"top-right"},"top-end":{ltr:"top-right",rtl:"top-left"},"bottom-start":{ltr:"bottom-left",rtl:"bottom-right"},"bottom-end":{ltr:"bottom-right",rtl:"bottom-left"}}[t]?.[e]??t}function Ze(l,e){const t=i=>({...e,...i,position:Xe(i?.position??e?.position,l)}),n=i=>{const s=t(i),c=Ce(s);return T.notify(c,s)};return n.update=(i,s)=>{T.update(i,t(s))},n.promise=(i,s)=>{const c=n({...s.loading,status:"loading",duration:null});i.then(r=>n.update(c,{status:"success",duration:5e3,...q(s.success,r)})).catch(r=>n.update(c,{status:"error",duration:5e3,...q(s.error,r)}))},n.closeAll=T.closeAll,n.close=T.close,n.isActive=T.isActive,n}function Je(l){const{theme:e}=Ee(),t=be();return v.useMemo(()=>Ze(e.direction,{...t,...l}),[l,e.direction,t])}const ee=0,A=1,te=[0,0,0,0],b=[],j={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class R extends de{constructor(e,t,n){super(e),this.features=t,this.mapBrowserEvent=n}}class Mt extends Me{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:Te,this.defaultDeleteCondition_=function(n){return Ae(n)&&le(n)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:we,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new Ie,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new he({source:new De({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:et(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let t;if(e.features?t=e.features:e.source&&(this.source_=e.source,t=new V(this.source_.getFeatures()),this.source_.addEventListener(W.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(W.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!t)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=t,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(E.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(E.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}addFeature_(e){const t=e.getGeometry();if(t){const i=this.SEGMENT_WRITERS_[t.getType()];i&&i(e,t)}const n=this.getMap();n&&n.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(n.getCoordinateFromPixel(this.lastPixel_)),e.addEventListener(K.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,t){if(!this.featuresBeingModified_){this.featuresBeingModified_=new V;const n=this.featuresBeingModified_.getArray();for(let i=0,s=t.length;i<s;++i){const c=t[i].feature;c&&!n.includes(c)&&this.featuresBeingModified_.push(c)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new R(j.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(K.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const t=this.rBush_,n=[];t.forEach(function(i){e===i.feature&&n.push(i)});for(let i=n.length-1;i>=0;--i){const s=n[i];for(let c=this.dragSegments_.length-1;c>=0;--c)this.dragSegments_[c][0]===s&&this.dragSegments_.splice(c,1);t.remove(s)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const t=e.target;this.removeFeature_(t),this.addFeature_(t)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,t){const n=t.getCoordinates(),i={feature:e,geometry:t,segment:[n,n]};this.rBush_.insert(t.getExtent(),i)}writeMultiPointGeometry_(e,t){const n=t.getCoordinates();for(let i=0,s=n.length;i<s;++i){const c=n[i],r={feature:e,geometry:t,depth:[i],index:i,segment:[c,c]};this.rBush_.insert(t.getExtent(),r)}}writeLineStringGeometry_(e,t){const n=t.getCoordinates();for(let i=0,s=n.length-1;i<s;++i){const c=n.slice(i,i+2),r={feature:e,geometry:t,index:i,segment:c};this.rBush_.insert(S(c),r)}}writeMultiLineStringGeometry_(e,t){const n=t.getCoordinates();for(let i=0,s=n.length;i<s;++i){const c=n[i];for(let r=0,o=c.length-1;r<o;++r){const h=c.slice(r,r+2),a={feature:e,geometry:t,depth:[i],index:r,segment:h};this.rBush_.insert(S(h),a)}}}writePolygonGeometry_(e,t){const n=t.getCoordinates();for(let i=0,s=n.length;i<s;++i){const c=n[i];for(let r=0,o=c.length-1;r<o;++r){const h=c.slice(r,r+2),a={feature:e,geometry:t,depth:[i],index:r,segment:h};this.rBush_.insert(S(h),a)}}}writeMultiPolygonGeometry_(e,t){const n=t.getCoordinates();for(let i=0,s=n.length;i<s;++i){const c=n[i];for(let r=0,o=c.length;r<o;++r){const h=c[r];for(let a=0,d=h.length-1;a<d;++a){const u=h.slice(a,a+2),g={feature:e,geometry:t,depth:[r,i],index:a,segment:u};this.rBush_.insert(S(u),g)}}}}writeCircleGeometry_(e,t){const n=t.getCenter(),i={feature:e,geometry:t,index:ee,segment:[n,n]},s={feature:e,geometry:t,index:A,segment:[n,n]},c=[i,s];i.featureSegments=c,s.featureSegments=c,this.rBush_.insert(N(n),i);let r=t;this.rBush_.insert(r.getExtent(),s)}writeGeometryCollectionGeometry_(e,t){const n=t.getGeometriesArray();for(let i=0;i<n.length;++i){const s=n[i],c=this.SEGMENT_WRITERS_[s.getType()];c(e,s)}}createOrUpdateVertexFeature_(e,t,n,i){let s=this.vertexFeature_;return s?s.getGeometry().setCoordinates(e):(s=new D(new z(e)),this.vertexFeature_=s,this.overlay_.getSource().addFeature(s)),s.set("features",t),s.set("geometries",n),s.set("existing",i),s}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let t;return!e.map.getView().getInteracting()&&e.type==w.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=w.SINGLECLICK||!this.ignoreNextSingleClick_?t=this.removePoint():t=!0),e.type==w.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!t}findInsertVerticesAndUpdateDragSegments_(e){this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null;const t=this.vertexFeature_;if(!t)return;this.getMap().getView().getProjection();const n=[],i=t.getGeometry().getCoordinates(),s=S([i]),c=this.rBush_.getInExtent(s),r={};c.sort(Qe);for(let o=0,h=c.length;o<h;++o){const a=c[o],d=a.segment;let u=p(a.geometry);const g=a.depth;if(g&&(u+="-"+g.join("-")),r[u]||(r[u]=new Array(2)),a.geometry.getType()==="Circle"&&a.index===A){const f=ne(e,a);F(f,i)&&!r[u][0]&&(this.dragSegments_.push([a,0]),r[u][0]=a);continue}if(F(d[0],i)&&!r[u][0]){this.dragSegments_.push([a,0]),r[u][0]=a;continue}if(F(d[1],i)&&!r[u][1]){if(r[u][0]&&r[u][0].index===0){let f=a.geometry.getCoordinates();switch(a.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":f=f[g[1]];case"Polygon":if(a.index!==f[g[0]].length-2)continue;break}}this.dragSegments_.push([a,1]),r[u][1]=a;continue}p(d)in this.vertexSegments_&&!r[u][0]&&!r[u][1]&&n.push(a)}return n}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([s])=>s));const t=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],n=[],i=[];for(let s=0,c=this.dragSegments_.length;s<c;++s){const r=this.dragSegments_[s],o=r[0],h=o.feature;n.includes(h)||n.push(h);const a=o.geometry;i.includes(a)||i.push(a);const d=o.depth;let u;const g=o.segment,f=r[1];for(;t.length<a.getStride();)t.push(g[f][t.length]);switch(a.getType()){case"Point":u=t,g[0]=t,g[1]=t;break;case"MultiPoint":u=a.getCoordinates(),u[o.index]=t,g[0]=t,g[1]=t;break;case"LineString":u=a.getCoordinates(),u[o.index+f]=t,g[f]=t;break;case"MultiLineString":u=a.getCoordinates(),u[d[0]][o.index+f]=t,g[f]=t;break;case"Polygon":u=a.getCoordinates(),u[d[0]][o.index+f]=t,g[f]=t;break;case"MultiPolygon":u=a.getCoordinates(),u[d[1]][d[0]][o.index+f]=t,g[f]=t;break;case"Circle":const _=a;if(g[0]=t,g[1]=t,o.index===ee)this.changingFeature_=!0,_.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0,e.map.getView().getProjection();let y=Y(x(_.getCenter()),x(t));_.setRadius(y),this.changingFeature_=!1}break}u&&this.setGeometryCoordinates_(a,u)}this.createOrUpdateVertexFeature_(t,n,i,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const t=e.coordinate,n=this.findInsertVerticesAndUpdateDragSegments_(t);if(n?.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,n),this.vertexFeature_)){const i=this.vertexFeature_.getGeometry().getCoordinates();for(let s=n.length-1;s>=0;--s)this.insertVertex_(n[s],i);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let t=this.dragSegments_.length-1;t>=0;--t){const n=this.dragSegments_[t][0],i=n.geometry;if(i.getType()==="Circle"){const s=i,c=s.getCenter(),r=n.featureSegments[0],o=n.featureSegments[1];r.segment[0]=c,r.segment[1]=c,o.segment[0]=c,o.segment[1]=c,this.rBush_.update(N(c),r);let h=s;this.rBush_.update(h.getExtent(),o)}else this.rBush_.update(S(n.segment),n)}return this.featuresBeingModified_&&(this.dispatchEvent(new R(j.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.coordinate)}handlePointerAtPixel_(e){const t=this.getMap(),n=t.getPixelFromCoordinate(e);t.getView().getProjection();const i=function(r,o){return ie(e,r)-ie(e,o)};let s,c;if(this.hitDetection_){const r=typeof this.hitDetection_=="object"?o=>o===this.hitDetection_:void 0;t.forEachFeatureAtPixel(n,(o,h,a)=>{a&&a.getType()==="Point"&&(a=new z(L(a.getCoordinates())));const d=a||o.getGeometry();if(d&&d.getType()==="Point"&&o instanceof D&&this.features_.getArray().includes(o)){c=d;const u=o.getGeometry().getFlatCoordinates().slice(0,2);s=[{feature:o,geometry:c,segment:[u,u]}]}return!0},{layerFilter:r})}if(!s){const r=Le(N(e,te)),o=t.getView().getResolution()*this.pixelTolerance_,h=Ge(Ne(r,o,te));s=this.rBush_.getInExtent(h)}if(s&&s.length>0){const r=s.sort(i)[0],o=r.segment;let h=ne(e,r);const a=t.getPixelFromCoordinate(h);let d=Y(n,a);if(c||d<=this.pixelTolerance_){const u={};if(u[p(o)]=!0,this.snapToPointer_||(this.delta_[0]=h[0]-e[0],this.delta_[1]=h[1]-e[1]),r.geometry.getType()==="Circle"&&r.index===A)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(h,[r.feature],[r.geometry],this.snappedToVertex_);else{const g=t.getPixelFromCoordinate(o[0]),f=t.getPixelFromCoordinate(o[1]),_=k(a,g),y=k(a,f);d=Math.sqrt(Math.min(_,y)),this.snappedToVertex_=d<=this.pixelTolerance_,this.snappedToVertex_&&(h=_>y?o[1]:o[0]),this.createOrUpdateVertexFeature_(h,[r.feature],[r.geometry],this.snappedToVertex_);const P={};P[p(r.geometry)]=!0;for(let C=1,Se=s.length;C<Se;++C){const M=s[C].segment;if(F(o[0],M[0])&&F(o[1],M[1])||F(o[0],M[1])&&F(o[1],M[0])){const $=p(s[C].geometry);$ in P||(P[$]=!0,u[p(M)]=!0)}else break}}this.vertexSegments_=u;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,t){const n=e.segment,i=e.feature,s=e.geometry,c=e.depth,r=e.index;let o;for(;t.length<s.getStride();)t.push(0);switch(s.getType()){case"MultiLineString":o=s.getCoordinates(),o[c[0]].splice(r+1,0,t);break;case"Polygon":o=s.getCoordinates(),o[c[0]].splice(r+1,0,t);break;case"MultiPolygon":o=s.getCoordinates(),o[c[1]][c[0]].splice(r+1,0,t);break;case"LineString":o=s.getCoordinates(),o.splice(r+1,0,t);break;default:return!1}this.setGeometryCoordinates_(s,o);const h=this.rBush_;h.remove(e),this.updateSegmentIndices_(s,r,c,1);const a={segment:[n[0],t],feature:i,geometry:s,depth:c,index:r};h.insert(S(a.segment),a),this.dragSegments_.push([a,1]);const d={segment:[t,n[1]],feature:i,geometry:s,depth:c,index:r+1};return h.insert(S(d.segment),d),this.dragSegments_.push([d,0]),!0}updatePointer_(e){return e&&this.findInsertVerticesAndUpdateDragSegments_(e),this.vertexFeature_?.getGeometry().getCoordinates()}getPoint(){const e=this.vertexFeature_?.getGeometry().getCoordinates();return e?L(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(n=>n.getType()==="Circle"||n.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(S([e])).some(({segment:n})=>F(n[0],e)||F(n[1],e))}removePoint(e){if(e&&(e=x(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=w.POINTERDRAG){const t=this.lastPointerEvent_;this.willModifyFeatures_(t,this.dragSegments_.map(([i])=>i));const n=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new R(j.MODIFYEND,this.featuresBeingModified_,t)),this.featuresBeingModified_=null,n}return!1}removeVertex_(){const e=this.dragSegments_,t={};let n=!1,i,s,c,r,o,h,a,d,u,g,f;for(o=e.length-1;o>=0;--o)c=e[o],g=c[0],f=p(g.feature),g.depth&&(f+="-"+g.depth.join("-")),f in t||(t[f]={}),c[1]===0?(t[f].right=g,t[f].index=g.index):c[1]==1&&(t[f].left=g,t[f].index=g.index+1);for(f in t){switch(u=t[f].right,a=t[f].left,h=t[f].index,d=h-1,a!==void 0?g=a:g=u,d<0&&(d=0),r=g.geometry,s=r.getCoordinates(),i=s,n=!1,r.getType()){case"MultiLineString":s[g.depth[0]].length>2&&(s[g.depth[0]].splice(h,1),n=!0);break;case"LineString":s.length>2&&(s.splice(h,1),n=!0);break;case"MultiPolygon":i=i[g.depth[1]];case"Polygon":i=i[g.depth[0]],i.length>4&&(h==i.length-1&&(h=0),i.splice(h,1),n=!0,h===0&&(i.pop(),i.push(i[0]),d=i.length-1));break}if(n){this.setGeometryCoordinates_(r,s);const _=[];if(a!==void 0&&(this.rBush_.remove(a),_.push(a.segment[0])),u!==void 0&&(this.rBush_.remove(u),_.push(u.segment[1])),a!==void 0&&u!==void 0){const y={depth:g.depth,feature:g.feature,geometry:g.geometry,index:d,segment:_};this.rBush_.insert(S(y.segment),y)}this.updateSegmentIndices_(r,h,g.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return n}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(n=>n.getType()==="Circle"||n.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(S([e])).some(({segment:n})=>!(F(n[0],e)||F(n[1],e)))}insertPoint(e){const t=e?x(e,this.getMap().getView().getProjection()):this.vertexFeature_?.getGeometry().getCoordinates();return t?this.findInsertVerticesAndUpdateDragSegments_(t).reduce((i,s)=>i||this.insertVertex_(s,t),!1):!1}setGeometryCoordinates_(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1}updateSegmentIndices_(e,t,n,i){this.rBush_.forEachInExtent(e.getExtent(),function(s){s.geometry===e&&(n===void 0||s.depth===void 0||je(s.depth,n))&&s.index>t&&(s.index+=i)})}}function Qe(l,e){return l.index-e.index}function ie(l,e,t){const n=e.geometry;if(n.getType()==="Circle"){let s=n;if(e.index===A){const c=k(s.getCenter(),x(l)),r=Math.sqrt(c)-s.getRadius();return r*r}}const i=x(l);return b[0]=x(e.segment[0]),b[1]=x(e.segment[1]),Ve(i,b)}function ne(l,e,t){const n=e.geometry;if(n.getType()==="Circle"&&e.index===A)return L(n.getClosestPoint(x(l)));const i=x(l);return b[0]=x(e.segment[0]),b[1]=x(e.segment[1]),L(Re(i,b))}function et(){const l=ue();return function(e,t){return l.Point}}const tt={SELECT:"select"};class it extends de{constructor(e,t,n,i){super(e),this.selected=t,this.deselected=n,this.mapBrowserEvent=i}}const I={};class xe extends ke{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:le,this.addCondition_=e.addCondition?e.addCondition:X,this.removeCondition_=e.removeCondition?e.removeCondition:X,this.toggleCondition_=e.toggleCondition?e.toggleCondition:Be,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:Z,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:nt(),this.features_=e.features||new V;let t;if(e.layers)if(typeof e.layers=="function")t=e.layers;else{const n=e.layers;t=function(i){return n.includes(i)}}else t=Z;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[p(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[p(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(E.ADD,this.boundAddFeature_),this.features_.addEventListener(E.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(E.ADD,this.boundAddFeature_),this.features_.removeEventListener(E.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const n=this.getMap().getAllLayers().find(function(i){if(i instanceof he&&i.getSource()&&i.getSource().hasFeature(t))return i});n&&this.addFeatureLayerAssociation_(t,n)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const t=p(e);t in I||(I[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let i=t.length-1;i>=0;--i){const s=t[i];if(s!==this&&s instanceof xe&&s.getStyle()&&s.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(s.getStyle());return}}const n=p(e);e.setStyle(I[n]),delete I[n]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[p(e)]}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),n=this.removeCondition_(e),i=this.toggleCondition_(e),s=!t&&!n&&!i,c=e.map,r=this.getFeatures(),o=[],h=[];if(s){Oe(this.featureLayerAssociation_),c.forEachFeatureAtPixel(e.pixel,(a,d)=>{if(!(!(a instanceof D)||!this.filter_(a,d)))return this.addFeatureLayerAssociation_(a,d),h.push(a),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let a=r.getLength()-1;a>=0;--a){const d=r.item(a),u=h.indexOf(d);u>-1?h.splice(u,1):(r.remove(d),o.push(d))}h.length!==0&&r.extend(h)}else{c.forEachFeatureAtPixel(e.pixel,(a,d)=>{if(!(!(a instanceof D)||!this.filter_(a,d)))return(t||i)&&!r.getArray().includes(a)?(this.addFeatureLayerAssociation_(a,d),h.push(a)):(n||i)&&r.getArray().includes(a)&&(o.push(a),this.removeFeatureLayerAssociation_(a)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let a=o.length-1;a>=0;--a)r.remove(o[a]);r.extend(h)}return(h.length>0||o.length>0)&&this.dispatchEvent(new it(tt.SELECT,h,o,e)),!0}}function nt(){const l=ue();return J(l.Polygon,l.LineString),J(l.GeometryCollection,l.LineString),function(e){return e.getGeometry()?l[e.getGeometry().getType()]:null}}const st="@open-pioneer/notifier",rt=Ue.bind(void 0,st),ot=qe({displayName:"WarningTwoIcon",d:"M23.119,20,13.772,2.15h0a2,2,0,0,0-3.543,0L.881,20a2,2,0,0,0,1.772,2.928H21.347A2,2,0,0,0,23.119,20ZM11,8.423a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Zm1.05,11.51h-.028a1.528,1.528,0,0,1-1.522-1.47,1.476,1.476,0,0,1,1.448-1.53h.028A1.527,1.527,0,0,1,13.5,18.4,1.475,1.475,0,0,1,12.05,19.933Z"}),at=!1;function Tt(l){const{position:e="top-right"}=l,t=Je(),n=rt("notifier.NotificationService"),[i,s]=v.useState(!at),c=Q(o=>{const h=o.level==="error"?m.jsx(ot,{h:"100%",w:"100%"}):void 0;t({position:e,title:o.title,description:o.message||null,status:o.level,isClosable:!0,duration:o.displayDuration??null,icon:h})}),r=Q(()=>{t.closeAll()});return v.useEffect(()=>{const o=n.registerHandler({showNotification:c,closeAll:r});return()=>o.destroy()},[i,n,c,r]),m.jsx(m.Fragment,{})}const ct="@open-pioneer/coordinate-viewer",lt=ge.bind(void 0,ct),ht=4,ut="decimal",At=l=>{const{precision:e,displayProjectionCode:t,format:n}=l,{containerProps:i}=U("coordinate-viewer",l),{map:s}=H(l),c=s?.olMap,r=fe(()=>s?.projection.getCode()??"",[s]);let{coordinates:o}=gt(c);o=o&&t?mt(o,r,t):o;const h=dt(o,e,n),a=t||r,d=h?h+" "+a:"";return m.jsx(O,{...i,children:m.jsx(me,{className:"coordinate-viewer-text",children:d})})};function dt(l,e,t){const n=lt();return l?ft(l,e,n,t):""}function gt(l){const[e,t]=v.useState();return v.useEffect(()=>{if(!l)return;const n=l.on("pointermove",i=>{t(i.coordinate)});return()=>He(n)},[l]),{coordinates:e}}function ft(l,e,t,n){if(l[0]==null||l[1]==null)return"";const i=e??ht,s=n??ut,[c,r]=l;let o;if(s==="degree"&&isFinite(c)&&isFinite(r)){const[h,a,d]=se(c,t,i),[u,g,f]=se(r,t,i),_=`${Math.abs(h)}°${a}'${d}"${0<=h?"(E)":"(W)"}`,y=`${Math.abs(u)}°${g}'${f}"${0<=u?"(N)":"(S)"}`;o=_+" "+y}else{const h=t.formatNumber(c,{maximumFractionDigits:i,minimumFractionDigits:i}),a=t.formatNumber(r,{maximumFractionDigits:i,minimumFractionDigits:i});o=h+" "+a}return o}function se(l,e,t){const n=Math.floor(l),i=l-n,s=Math.floor(60*i),r=60*(60*i-s),o=e.formatNumber(r,{maximumFractionDigits:t,minimumFractionDigits:t});return[n,s,o]}function mt(l,e,t){return $e(l,e,t)}const wt=l=>{const{displayMode:e="line"}=l,{containerProps:t}=U("scale-bar",l),{map:n}=H(l),i=v.useRef(null);return v.useEffect(()=>{if(i.current&&n){const s=n.olMap,c=new We({units:"metric",target:i.current,bar:e==="bar"});return s.addControl(c),()=>{s.removeControl(c)}}},[e,n]),m.jsx(O,{...t,ref:i})},_t="@open-pioneer/scale-viewer",yt=ge.bind(void 0,_t),It=l=>{const{containerProps:e}=U("scale-viewer",l),{map:t}=H(l),n=yt(),i=fe(()=>t?.scale??1,[t]),s=i?n.formatNumber(i):void 0;return m.jsx(O,{...e,children:s&&m.jsxs(me,{children:["1:",s]})})};export{At as C,_e as I,Mt as M,Tt as N,xe as S,ot as W,wt as a,It as b,Ke as c};
